function ProChart_Initindicators(E){var x,r,g,C,F,G,y,z,J,Y,Z,aa,ba;function D(a){F=1;G=A(a,"panels-container");y=A(a,"panels-tr-container");z=A(a,"indicator-container");J=A(a,"indicator-style");Y=A(a,"indicator-level");Z=A(a,"indicator-source");aa=A(a,"indicator-style-default");ba=A(a,"indicator-style-columns")}function ua(){ka();var a=$.Deferred();K="Indicators form";va("gannfan",K);var d=!1==f.guiinit.cache?"?"+f.version.gui.name+(new Date).getTime():"?"+f.version.gui.name;url=f.guiinit.rootpath+
"/ChartUI/gui/indicators/indicators.htm"+d;if("Microsoft Internet Explorer"==navigator.appName&&"XMLHttpRequest"in window&&null!==window.XMLHttpRequest){var b=new XMLHttpRequest;b.open("get",url);b.onload=function(){var c=b.responseText;la($(c).find("#dlg-indicators"));a.resolve(c)};b.send()}else $.ajax({type:"GET",async:!0,dataType:"html",url:url}).done(function(b){la($(b).find("#dlg-indicators"));a.resolve(b)});return a.promise()}function la(a){$("#chart-dialog").html(a);a=f.chart.Studies;for(var d=
0;d<a.length;d++){var b='<li id="indicator-%id%" class="li-indicator"><button class="favorite star-button stardisabled-icon" type="button"  ></button><a href="javascript:void(0)" class="openindicator" idx="indicator-%id%" title="%caption%" ><span>%caption%</span></a><button class="favorite property-favorite" type="button"></button><button class="favorite add-favorite" type="button"></button></li>'.replace(/%id%/g,a[d].id).replace(/%caption%/g,a[d].caption),c=a[d].category;wa(a[d].id)&&(b=b.replace("stardisabled-icon",
"startenabled-icon"));$("#indicatorsgroup-"+c+" > ul.indicators-list").append(b)}$(".indicators-list .openindicator").on("click",function(){var a=$(this).attr("idx"),b=$(this).find("span").html();L(a,b)});$(".indicators-list .li-indicator .property-favorite").on("click",function(){var a=$(this).parent().attr("id"),b=$(this).parent().find("span").html();L(a,b)});$(".indicators-list .li-indicator .star-button").on("click",function(){var a=$(this).parent().attr("id"),b=$(this).parent().find("span").html(),
c=$(this).parent().find("a").attr("title");$(this).hasClass("stardisabled-icon")?($(this).addClass("startenabled-icon").removeClass("stardisabled-icon"),a=a.replace("indicator-",""),"undefined"!=typeof f.init.indicators&&(f.init.gui.indicatorsAdd(a,b,c),ca())):($(this).removeClass("startenabled-icon").addClass("stardisabled-icon"),ma(a.replace("indicator-","")))});$(".indicators-list .li-indicator .add-favorite").on("click",function(){var a=$(this).parent().attr("id").replace("indicator-","");f.chart.AddStudy(a)});
M();ca();xa();$("#button-add-indicator").button();$("#button-add-indicator-to").button();ya();f.chart.IsVolumeEnabled()?$(".properties-tabs").find(".volume-category-tab").css("display",""):$(".properties-tabs").find(".volume-category-tab").css("display","none");$("#chart-dialog").dialog("open");"undefined"!=typeof f.localizationobj&&f.localizationobj.gui.updateFromDataLang($("#chart-dialog"))}function L(a,d){var b=$.Deferred();(function(a){$(a).find(".spectrum-color").each(function(){$(this).spectrum("destroy")});
$("#dialog-indicator-page #indicator-inner").empty()})($("#dialog-indicator-page #indicator-inner"));if(2==F)return da(z,d,a),b.promise();var c=!1==f.guiinit.cache?"?"+f.version.gui.name+(new Date).getTime():"?"+f.version.gui.name,c=f.guiinit.rootpath+"/ChartUI/gui/indicators/indicators.patterns.htm"+c;if("Microsoft Internet Explorer"==navigator.appName&&"XMLHttpRequest"in window&&null!==window.XMLHttpRequest){var e=new XMLHttpRequest;e.open("get",c);e.title=d;e.id=a;e.onload=function(){var a=e.responseText;
D(a);da(z,e.title,e.id);b.resolve(a)};e.send()}else return $.ajax({type:"GET",async:!0,dataType:"html",title:d,id:a,url:c}).done(function(a){D(a);da(z,this.title,this.id);b.resolve(a)}),b.promise()}function da(a,d,b){a=a.replace(/%panels%/g,"<tr><td>set panel data here</td></td>").replace(/%style-link-panels%/g,"display:none;");$("#dialog-indicator-page #indicator-inner").html(a);$("#indicators-page > .dialog_level").css("display","none");$("#dialog-indicator-page").css("display","block");M();ea(1,
d);x="";g=r=null;C=!1;a=b.replace("indicator-","");switch(a){case "rsi1":g=d=H(a);N();O();P();fa();na(d.lines);Q();break;case "macd1":g=d=H(a);N();O();P();b=null;b=d.param1;R("#in-fastema",b.min,b.max,1,b.values[0]);S("#in-fastema","param1",0);b=d.param2;R("#in-slowema",b.min,b.max,1,b.values[0]);S("#in-slowema","param2",0);b=d.param3;R("#in-macdsma",b.min,b.max,1,b.values[0]);S("#in-macdsma","param3",0);T("#histogram-line","renderitem3");T("#macd-line","renderitem1");T("#signal-line","renderitem2");
Q();break;case "gator1":g=H(a);N();O();P();oa();fa();Q();break;default:pa(H(a))}za(a);$("#li-browser-indicators").trigger("click");"undefined"!=typeof f.localizationobj&&f.localizationobj.gui.updateFromDataLang($("#dialog-indicator-page #indicator-inner"))}function za(a){x=a;$("#button-add-indicator").off();$("#button-add-indicator").button({disabled:!1});$("#button-add-indicator").on("click",function(){r=f.chart.AddStudyWithParams(x,g);null!=r&&(g=r,C=!0,$(this).button({disabled:!0}))});$("#button-add-indicator-to").off();
$("#button-add-indicator-to").button({disabled:!1});$("#button-add-indicator-to").on("click",function(){U.debug("Add to button click");Aa(a)})}function qa(a,d,b){ka();var c=$.Deferred();K=d.caption;x=d.id;g=r=d;C=!0;1==F&&ga(z,d,b);a=!1==f.guiinit.cache?"?"+f.version.gui.name+(new Date).getTime():"?"+f.version.gui.name;a=f.guiinit.rootpath+"/ChartUI/gui/indicators/indicators.patterns.htm"+a;Ba("",K);if(f.navigator.XMLHttpRequest()){var e=new XMLHttpRequest;e.indicatoId=b;e.open("get",a);e.onload=
function(){var a=e.responseText;D(a);ga(z,d,e.indicatoId);c.resolve(a)};e.send()}else return $.ajax({type:"GET",async:!0,dataType:"html",indicatoId:b,url:a}).done(function(a){D(a);ga(z,d,this.indicatoId);c.resolve(a)});return c.promise()}function ra(a,d){for(var b=[],c=0;c<d.length;c++){var e=d[c];if(a==e.id){for(c=0;c<e.fields.length;c++)"study"==e.fields[c].type&&b.push(e.fields[c].name);break}}return b}function ga(a,d,b){a=a.replace(/%style-link-panels%/g,"");var c=ha(a,d,b);a=a.replace(/%panels%/g,
c);$("#chart-dlgindicator #indicator-inner").html(a);M();V(b);pa(d);"undefined"!=typeof f.localizationobj&&f.localizationobj.gui.updateFromDataLang($("#chart-dlgindicator #indicator-inner"));$("#chart-dlgindicator").dialog("open")}function ha(a,d,b){a="";if("undefined"!=typeof f.panels){var c=f.panels.core.returnPanels(),e="",p=f.chart.GetLegendInfo();a+=y.replace(/%panel-type-title%/g,"New panel").replace(/%panel-type%/g,"new").replace(/%tid%/g,d.id).replace(/%tguiid%/g,d.UID).replace(/%legends%/g,
"").replace(/%button-title%/g,"Move here").replace(/%tpanelid%/g,"").replace(/%panel-action-style%/g,"").replace(/%button%/g,"move-button").replace(/%position%/g,"panel-top").replace(/%css%/g,"paneltype-new");for(var h=0;h<c.length;h++){switch(c[h].type){case "price":e="Price panel";break;case "study":e="Study panel"}for(var g="",l="",k=ra(c[h].id,p),n=0;n<k.length;n++)g+="<span>%legend-title%</span>; ".replace(/%legend-title%/g,k[n]);a:{for(n=0;n<p.length;n++)if(k=p[n],c[h].id==k.id){for(n=0;n<k.fields.length;n++)if(k.fields[n].uid==
b){k=!0;break a}k=!1;break a}k=!1}k&&(l="display:none;");a+=y.replace(/%panel-type-title%/g,e).replace(/%panel-type%/g,c[h].type).replace(/%legends%/g,g).replace(/%button-title%/g,"Move here").replace(/%button%/g,"move-button").replace(/%tid%/g,d.id).replace(/%tguiid%/g,d.UID).replace(/%position%/g,"").replace(/%tpanelid%/g,c[h].id).replace(/%panel-action-style%/g,l).replace(/%css%/g,"paneltype-"+c[h].type)}a+=y.replace(/%panel-type-title%/g,"New panel").replace(/%panel-type%/g,"new").replace(/%legends%/g,
"").replace(/%tid%/g,d.id).replace(/%tguiid%/g,d.UID).replace(/%button-title%/g,"Move here").replace(/%tpanelid%/g,"").replace(/%panel-action-style%/g,"").replace(/%button%/g,"move-button").replace(/%position%/g,"panel-bottom").replace(/%css%/g,"paneltype-new")}return a}function Aa(a,d){var b=$.Deferred();"undefined"==typeof d&&(d="Panels");1==F&&ia(G,d);var c=!1==f.guiinit.cache?"?"+f.version.gui.name+(new Date).getTime():"?"+f.version.gui.name,c=f.guiinit.rootpath+"/ChartUI/gui/indicators/indicators.patterns.htm"+
c;if("Microsoft Internet Explorer"==navigator.appName&&"XMLHttpRequest"in window&&null!==window.XMLHttpRequest){var e=new XMLHttpRequest;e.open("get",c);e.title=d;e.id=a;e.onload=function(){var a=e.responseText;D(a);ia(G,e.title,e.id);b.resolve(a)};e.send()}else return $.ajax({type:"GET",async:!0,dataType:"html",id:a,title:d,url:c}).done(function(a){D(a);ia(G,this.title,this.id);b.resolve(a)}),b.promise()}function ia(a,d,b){a=a.replace(/%style-link-panels%/g,"");var c="";if("undefined"!=typeof f.panels){for(var e=
f.panels.core.returnPanels(),p="",h=f.chart.GetLegendInfo(),c=c+y.replace(/%panel-type-title%/g,"New panel").replace(/%panel-type%/g,"new").replace(/%legends%/g,"").replace(/%button-title%/g,"Add here").replace(/%button%/g,"add-button").replace(/%panel-action-style%/g,"").replace(/%tid%/g,b).replace(/%tguiid%/g,"").replace(/%position%/g,"panel-top").replace(/%tpanelid%/g,"").replace(/%css%/g,"paneltype-new"),g=0;g<e.length;g++){switch(e[g].type){case "price":p="Price panel";break;case "study":p="Study panel"}for(var l=
"",k=ra(e[g].id,h),n=0;n<k.length;n++)l+="<span>%legend-title%</span>; ".replace(/%legend-title%/g,k[n]);c+=y.replace(/%panel-type-title%/g,p).replace(/%panel-type%/g,e[g].type).replace(/%legends%/g,l).replace(/%button-title%/g,"Add here").replace(/%button%/g,"add-button").replace(/%tid%/g,b).replace(/%tguiid%/g,"").replace(/%panel-action-style%/g,"").replace(/%position%/g,"").replace(/%tpanelid%/g,e[g].id).replace(/%css%/g,"paneltype-"+e[g].type)}c+=y.replace(/%panel-type-title%/g,"New panel").replace(/%panel-type%/g,
"new").replace(/%legends%/g,"").replace(/%button-title%/g,"Add here").replace(/%button%/g,"add-button").replace(/%panel-action-style%/g,"").replace(/%tid%/g,b).replace(/%tguiid%/g,"").replace(/%tpanelid%/g,"").replace(/%position%/g,"panel-bottom").replace(/%css%/g,"paneltype-new");a=a.replace(/%panels%/g,c)}$("#dialog-panels-page #panels-inner").html(a);$("#indicators-page > .dialog_level").css("display","none");$("#dialog-panels-page").css("display","block");M();V();ea(1,d,2);$("#li-browser-indicators").trigger("click");
"undefined"!=typeof f.localizationobj&&f.localizationobj.gui.updateFromDataLang($("#dialog-indicator-page #indicator-inner"))}function H(a){for(var d=f.chart.Studies,b=0;b<d.length;b++)if(d[b].id==a)return jQuery.extend(!0,{},d[b]);return null}function P(){if(null!=g)for(var a=g.renderitems,d=g.id,b=0;b<a;b++){var c=g["renderitem"+(b+1)],e={};"undefined"==typeof c.style?(c.style=[],c.style.push(e)):e=c.style[0];if("undefined"!=typeof f.chart.StyleObject[d+"_item"+(b+1)]){var p=f.chart.StyleObject[d+
"_item"+(b+1)];switch(c.drawtype){case "columns":sa(p,e);for(var c={visible:!0},h=Object.keys(c),q=0;q<h.length;q++){var l=h[q];"undefined"==typeof e[l]&&(e[l]="undefined"!==typeof p[l]?p[l]:c[l])}break;default:for(c={stroke:"rgb(0,0,0)",strokeWidth:"1",strokeOpacity:"1",fill:"rgb(0,0,0)",fillOpacity:"1",visible:!0},h=Object.keys(c),q=0;q<h.length;q++)l=h[q],"undefined"==typeof e[l]&&(e[l]="undefined"!==typeof p[l]?p[l]:c[l])}}}}function oa(){if(null!=g&&"undefined"!=typeof g.levels&&null!=g.levels)for(var a=
g.levels,d=a.length,b=g.id,c=0;c<d;c++){var e=a[c];try{if("undefined"==typeof f.chart.StyleObject.indicators[b].levels[c])continue}catch(p){continue}var h=f.chart.StyleObject.indicators[b].levels[c];"undefined"!=typeof h.stroke&&(e.stroke=h.stroke);"undefined"!=typeof h.strokeOpacity&&(e.strokeOpacity=h.strokeOpacity);"undefined"!=typeof h.strokeWidth&&(e.strokeWidth=h.strokeWidth);"undefined"!=typeof h.strokeDasharray&&(e.strokeDasharray=h.strokeDasharray);"undefined"==typeof e.visible&&(e.visible=
!0)}}function pa(a){g=a;N();O();P();oa();fa();na();a=$("#indicator-inner .properties-tabs a");for(var d=$("#indicator-inner .main-properties"),b=0;b<a.length;b++)if("none"!=$(a[b]).css("display")){$(a[b]).addClass("active");$(d[b]).css("display","block");break}Q()}function N(){var a=$("#tbody-parameters"),d=[];d.push('<td data-localize="dialogs.indicator.parameters.%capid%">%caption%</td><td><input id="%inputid%" class="param-spinner onlynumeric"/></td>');d.push('<td data-localize="dialogs.indicator.parameters.%capid%">%caption2%</td><td><input id="%inputid2%" class="param-spinner onlynumeric"/></td>');
for(var b=/%caption%/g,c=/%inputid%/g,e=/%caption2%/g,p=/%inputid2%/g,h=/%capid%/g,f=g.parameters,l=[],k=0;k<f;k++){for(var n=g["param"+(k+1)],s="param"+(k+1),m=$("<tr></tr>"),t=n.values.length,u=0;u<t;u++){var B="param"+(k+1)+"_"+u,w="";switch(u){case 0:w=n.caption.toLowerCase().replace(/\s+/g,"");w=d[u].replace(b,n.caption).replace(c,B).replace(h,w);$(m).append(w);break;case 1:w=n.caption2.toLowerCase().replace(/\s+/g,""),w=d[u].replace(e,n.caption2).replace(p,B).replace(h,w),$(m).append(w)}}l.push(!1!=
n.editable);if(!1!=n.editable)for($(a).append(m),m=0;m<t;m++){var u="param"+(k+1)+"_"+m,B=1,w=0,ja=99999,r=0;try{r=n.values[m]}catch(v){r=0}try{B=n.steps[m]}catch(x){B=1}try{w=n.min[m]}catch(y){w=0}try{ja=n.max[m]}catch(z){ja=99999}R("#"+u,w,ja,B,r);S("#"+u,s,m)}}a=!1;for(k=0;k<l.length;k++)a=a||l[k];!1==a&&$("#tab-param").css("display","none")}function O(){var a=g.sourceEditable;if("undefined"!=typeof a&&!1!=a){a=$("#tbody-sources");$(a).append(Z);for(var a=g.parameters,d=0;d<a;d++)for(var b=g["param"+
(d+1)],c=b.source.length,e=0;e<c;e++)if("value"!=b.source[e]){$("#select-source").val(b.source[e]);break}$("#select-source").on("change",function(){for(var a=$(this).val(),b=g.parameters,c=0;c<b;c++)for(var d=g["param"+(c+1)],e=d.source.length,f=0;f<e;f++)"value"!=d.source[f]&&(d.source[f]=a);t(s.Value)})}}function fa(){for(var a=$("#tbody-styles"),d=g.renderitems,b=0;b<d;b++){var c=g["renderitem"+(b+1)],e="renderitem"+(b+1),f="";switch(c.drawtype){case "columns":f=J.replace(/%indicator_style_adv%/g,
ba);break;default:f=J.replace(/%indicator_style_adv%/g,aa)}c=f.replace(/%caption%/g,c.caption).replace(/%renderitem%/g,e);$(a).append(c);T("#"+e,e)}}function wa(a){if("undefined"!=typeof f.init.indicators)for(var d=f.init.indicators,b=0;b<d.length;b++)if(d[b].id==a)return!0;return!1}function ma(a){"undefined"!=typeof f.init.indicators&&(f.init.gui.indicatorsRemove(a),ca())}function Ca(){$("ul.favorite-indicators-list .openindicator").on("click",function(){var a=$(this).attr("idx"),d=$(this).find("span").html();
L(a,d)});$("ul.favorite-indicators-list .li-indicator .property-favorite").on("click",function(){var a=$(this).parent().attr("idx"),d=$(this).parent().find("span").html();L(a,d)});$("ul.favorite-indicators-list .li-indicator .star-button").on("click",function(){var a=$(this).parent().attr("idx");ma(a.replace("indicator-",""));a=$('ul.indicators-list .li-indicator[id="'+a+'"] .star-button');$(a).removeClass("startenabled-icon").addClass("stardisabled-icon")});$("ul.favorite-indicators-list .li-indicator .add-favorite").on("click",
function(){var a=$(this).parent().attr("idx").replace("indicator-","");f.chart.AddStudy(a)})}function ca(){var a=$("ul.favorite-indicators-list");$(a).html("");if("undefined"!=typeof f.init.indicators)for(var d=f.init.indicators,b=0;b<d.length;b++){var c='<li idx="indicator-%id%" class="li-indicator"><button class="favorite star-button startenabled-icon" type="button"  ></button><a href="javascript:void(0)" class="openindicator" idx="indicator-%id%" title="%title%" ><span>%caption%</span></a><button class="favorite property-favorite" type="button"></button><button class="favorite add-favorite" type="button"></button></li>'.replace(/%id%/g,
d[b].id).replace(/%caption%/g,d[b].n).replace(/%title%/g,d[b].d);$(a).append(c)}Ca();"undefined"!=typeof f.menuobj&&f.menuobj.gui.updateIndicatorFavorites()}function na(){var a=g.levels;if("undefined"==typeof a||null==a)$("#tab-level").css("display","none");else for(var d=a.length,b=$("#tbody-indicatorlevels"),c=0;c<d;c++){var e="level"+c,f=Y.replace(/%id%/g,c).replace(/%levelvalue%/g,a[c].value).replace(/%levelitem%/g,e).replace(/%capid%/g,"level"+(c+1)).replace(/%caption%/g,"Level "+(c+1));$(b).append(f);
Da("#"+e,c)}}function t(a){if(null!=r&&null!=g&&""!=x&&!0==C)switch(a){case s.All:f.chart.UpdateStudyAll(g);break;case s.Draw:f.chart.UpdateStudyDrawType(g);break;case s.Value:f.chart.UpdateStudyValues(g);break;case s.Style:f.chart.UpdateStudyStyle(g);break;default:f.chart.UpdateStudyAll(g)}}function T(a,d){var b="undefined"!=typeof g.base,c=g[d],e=c.style[0],p=$(a).find(".line-color"),h=e.stroke;W($(p),h);var q=$(a).find(".line-color-alt"),l=e.stroke;"undefined"!=typeof c.style[1]&&(l=c.style[1].stroke);
W($(q),l);var k=$(a).find(".line-width"),l=e.strokeWidth;$(k).slider({min:1,max:6});$(k).slider("option","value",l);var n=$(a).find(".line-opacity");$(n).slider({min:0,max:100});l=100*e.fillOpacity;$(n).slider("option","value",l);$(n).find("div.gradient").css("background-image","linear-gradient(to left, "+h+" 0%, transparent 100% )");c=c.drawtype;h="Line Histogram Ch-Histogram C-Histogram Area Dots".split(" ");l="line histogram changehistogram centeredhistogram area dots".split(" ");switch(c){case "channel":h=
["Channel"];l=["channel"];break;case "columns":h=["Columns"];l=["columns"];break;default:h="Line Histogram Ch-Histogram C-Histogram Area Dots".split(" "),l="line histogram changehistogram centeredhistogram area dots".split(" ")}for(var r=$(a).find(".linedesign-type"),x=/%val%/g,y=/%Val%/g,u=0;u<h.length;u++)if(!1!=b||"changehistogram"!=l[u]&&"centeredhistogram"!=l[u]){var B='<option data-localize="dialogs.indicator.linetype.%val%" value="%val%">%Val%</option>'.replace(x,l[u]).replace(y,h[u]);$(r).append(B)}"undefined"!=
typeof c&&($(r).val(c),$(n).css("display","area"==c||"channel"==c?"block":"none"),$(k).css("display","area"!=c&&"channel"!=c?"block":"none"),$(a).find(".color-alt").css("display","changehistogram"==c||"centeredhistogram"==c?"block":"none"));if("columns"==c){b=e.opacity;m=[];v=[];c=e.visible;b*=100;h=$("#color-opacity-columns");h.slider({min:0,max:100});h.slider("option","value",b);h.find("div.gradient").css("background-image","linear-gradient(to left, #000000 0%, transparent 100% )");h.slider(c?"enable":
"disable");h="true"==e.borderVisible||!0==e.borderVisible;m.push({ctr:"color-columns-up-column",json:"up.fill",opacity:b,status:c?"enable":"disable",borderprop:0},{ctr:"color-columns-down-column",json:"down.fill",opacity:b,status:c?"enable":"disable",borderprop:0},{ctr:"color-columns-up-border",json:"up.stroke",opacity:b,status:c&&h?"enable":"disable",borderprop:1},{ctr:"color-columns-down-border",json:"down.stroke",opacity:b,status:c&&h?"enable":"disable",borderprop:1},{ctr:"color-columns-flat-column",
json:"flat.fill",opacity:b,status:c?"enable":"disable",borderprop:0},{ctr:"color-columns-flat-border",json:"flat.stroke",opacity:b,status:c&&h?"enable":"disable",borderprop:1});v.push({ctr:"control-columns-border",json:"borderVisible",status:c?!0:!1});for(b=0;b<m.length;b++)c=f.commonutils.func.parseColorString(X(e,m[b].json)),c="rgb(%r%, %g%, %b%)".replace("%r%",c[0]).replace("%g%",c[1]).replace("%b%",c[2]),W($("#"+m[b].ctr),c),$("#"+m[b].ctr).spectrum(m[b].status);for(b=0;b<v.length;b++){c=X(e,
v[b].json);if(null==c)break;$("#"+v[b].ctr).attr("disabled",!v[b].status);"true"==c.toLowerCase()?$("#"+v[b].ctr).attr("checked","true"==c.toLowerCase()):$("#"+v[b].ctr).removeAttr("checked")}Ea()}b=$(a).find(".line-visible");$(b).prop("checked",e.visible);$(n).slider(e.visible?"enable":"disable");$(p).spectrum(e.visible?"enable":"disable");$(k).slider(e.visible?"enable":"disable");$(r).prop("disabled",e.visible?!1:!0);$(q).spectrum(e.visible?"enable":"disable");$(p).attr("ritem",d);$(r).attr("ritem",
d);$(k).attr("ritem",d);$(n).attr("ritem",d);$(b).attr("ritem",d);$(q).attr("ritem",d);$(r).on("change",function(){var b=$(this).val();$(a).find(".linedesign-type").val(b);$(a).find(".line-opacity").css("display","area"==b?"block":"none");$(a).find(".line-width").css("display","area"!=b?"block":"none");$(a).find(".color-alt").css("display","changehistogram"==b||"centeredhistogram"==b?"block":"none");var c=$(this).attr("ritem");g[c].drawtype=b;t(s.Draw)});$(b).on("change",function(a){a=$(this).is(":checked");
$(n).slider(a?"enable":"disable");$(p).spectrum(a?"enable":"disable");$(k).slider(a?"enable":"disable");$(r).prop("disabled",a?!1:!0);$(q).spectrum(a?"enable":"disable");for(var b=$(this).attr("ritem"),c=0;c<g[b].style.length;c++)g[b].style[c].visible=a;try{var d="true"==g[b].style[0].borderVisible||!0==g[b].style[0].borderVisible;if("columns"==g[b].drawtype){for(b=0;b<v.length;b++)$("#"+v[b].ctr).attr("disabled",!a);for(b=0;b<m.length;b++)m[b].status=0==m[b].borderprop?a?"enable":"disable":a&&d?
"enable":"disable",$("#"+m[b].ctr).spectrum(m[b].status);$("#color-opacity-columns").slider(a?"enable":"disable")}}catch(e){}t(s.Style)});$(p).on("change",function(){var a=$(this).spectrum("get").toHexString();$(n).find("div.gradient").css("background-image","linear-gradient(to left, "+a+" 0%, transparent 100% )");var b=$(this).attr("ritem");g[b].style[0].stroke=a;g[b].style[0].fill=a;t(s.Style)});$(q).on("change",function(){var a=$(this).spectrum("get").toHexString(),b=$(this).attr("ritem");g[b].style[1].stroke=
a;t(s.Style)});$(k).on("slidechange",function(){for(var a=$(this).slider("option","value"),b=$(this).attr("ritem"),c=0;c<g[b].style.length;c++)g[b].style[c].strokeWidth=a;t(s.Style)});$(n).on("slidechange",function(){var a=$(this).slider("option","value")/100,b=$(this).attr("ritem");g[b].style[0].fillOpacity=a;t(s.Style)})}function Ea(){Fa("#control-columns-border","#color-columns-up-border","#color-columns-down-border","#color-columns-flat-border",null,null);$(".class-columns-study-color").on("change",
function(){var a=$(this).spectrum("get").toRgbString();$(this).spectrum("get").toHexString();for(var d=$(this).attr("id"),b=$(this).attr("ritem"),c=0;c<m.length;c++)if(m[c].ctr==d){var e=m[c].opacity,p=f.commonutils.func.parseColorString(a),e="rgba(%r%, %g%, %b%, %a%)".replace("%r%",p[0]).replace("%g%",p[1]).replace("%b%",p[2]).replace("%a%",e);I(g[b].style[0],m[c].json,e);t(s.Style);U.debug("style",g[b].style)}});$("#color-opacity-columns").on("slidechange",function(){var a=$(this).slider("option",
"value"),d=$(this).attr("ritem");I(g[d].style[0],"opacity",a/100);for(var b=0;b<m.length;b++){m[b].opacity=a/100;var c=f.commonutils.func.parseColorString(X(g[d].style[0],m[b].json)),c="rgba(%r%, %g%, %b%, %a% )".replace("%r%",c[0]).replace("%g%",c[1]).replace("%b%",c[2]).replace("%a%",a/100);I(g[d].style[0],m[b].json,c)}t(s.Style)})}function Fa(a,d,b,c,e,f){$(a).on("click",function(a){var q=$(this);a=$(this).attr("id");q.is(":checked")?(null!=f&&$(f).slider("enable"),null!=e&&$(e).slider("enable"),
null!=d&&$(d).spectrum("enable"),null!=b&&$(b).spectrum("enable"),null!=c&&$(c).spectrum("enable")):(null!=f&&$(f).slider("disable"),null!=e&&$(e).slider("disable"),null!=d&&$(d).spectrum("disable"),null!=b&&$(b).spectrum("disable"),null!=c&&$(c).spectrum("disable"));for(var q=q.is(":checked"),l=$(this).attr("ritem"),k=0;k<v.length;k++)v[k].ctr==a&&(I(g[l].style[0],v[k].json,q?"true":"false"),t(s.Style))})}function Da(a,d){var b=g.levels[d],c=$(a).find(".line-color"),e=b.stroke;W($(c),e);var f=$(a).find(".line-width"),
h=b.strokeWidth;$(f).slider({min:1,max:6});$(f).slider("option","value",h);var q=$(a).find(".line-opacity");$(q).slider({min:0,max:100});h=100*b.fillOpacity;$(q).slider("option","value",h);$(q).find("div.gradient").css("background-image","linear-gradient(to left, "+e+" 0%, transparent 100% )");for(var e=b.strokeDasharray,h=["Solid","Doted","Dashed"],l=["solid","doted","dashed"],k=$(a).find(".linedesign-type"),n=/%val%/g,m=/%Val%/g,r=0;r<h.length;r++){var v='<option <option data-localize="dialogs.common.linetype.%val%" value="%val%">%Val%</option>'.replace(n,
l[r]).replace(m,h[r]);$(k).append(v)}"undefined"!=typeof e&&$(k).val(e);e=$(a).find(".levelinput");h=$(a).find(".line-visible");$(h).prop("checked",b.visible);$(q).slider(b.visible?"enable":"disable");$(c).spectrum(b.visible?"enable":"disable");$(f).slider(b.visible?"enable":"disable");$(k).prop("disabled",b.visible?!1:!0);$(e).prop("disabled",b.visible?!1:!0);$(c).attr("rlevel",d);$(k).attr("rlevel",d);$(f).attr("rlevel",d);$(q).attr("rlevel",d);$(h).attr("rlevel",d);$(e).attr("rlevel",d);$(k).on("change",
function(){var b=$(this).val();$(a).find(".linedesign-type").val(b);$(a).find(".line-opacity").css("display","area"==b?"block":"none");$(a).find(".line-width").css("display","area"!=b?"block":"none");var c=$(this).attr("rlevel");g.levels[c].strokeDasharray=b;t(s.Draw)});$(h).on("change",function(a){a=$(this).is(":checked");$(q).slider(a?"enable":"disable");$(c).spectrum(a?"enable":"disable");$(f).slider(a?"enable":"disable");$(k).prop("disabled",a?!1:!0);var b=$(this).attr("rlevel");g.levels[b].visible=
a;t(s.Style)});$(c).on("change",function(){var a=$(this).spectrum("get").toHexString();$(q).find("div.gradient").css("background-image","linear-gradient(to left, "+a+" 0%, transparent 100% )");var b=$(this).attr("rlevel");g.levels[b].stroke=a;t(s.Style)});$(f).on("slidechange",function(){var a=$(this).slider("option","value"),b=$(this).attr("rlevel");g.levels[b].strokeWidth=a;t(s.Style)});$(q).on("slidechange",function(){var a=$(this).slider("option","value")/100,b=$(this).attr("rlevel");g.levels[b].fillOpacity=
a;t(s.Style)});$(e).on("change",function(){if(""!=$(this).val()&&$.isNumeric($(this).val())){$(this).attr("prevvalue",$(this).val());var a=$(this).attr("rlevel");g.levels[a].value=$(this).val();t(s.Style)}else $(this).val($(this).attr("prevvalue"))});$(e).on("keydown",function(a){13==a.keyCode&&(""!=$(this).val()&&$.isNumeric($(this).val())?(a=$(this).attr("rlevel"),g.levels[a].value=$(this).val(),t(s.Style)):$(this).val($(this).attr("prevvalue")))})}function R(a,d,b,c,e){$(a).spinner({min:d,max:b,
step:c});$(a).spinner("value",e)}function S(a,d,b){$(a).spinner({stop:function(a,e){var f=$(this).spinner("value");g[d].values[b]=f;t(s.Value)}})}function va(a,d){function b(a){$(a).find(".spectrum-color").each(function(){$(this).spectrum("destroy")})}function c(a){$(a).find(".ui-dialog-buttonset").prepend('<button class="chart-button adv-buttons eye-orange " type="button" title="" ></button>').on("click",function(){var a=$(".chart-ui-dialog.indicators-dialog").css("opacity"),a=1==a?.5:1,b=1==a?"":
2;$(".chart-ui-dialog.indicators-dialog").css("opacity",a);$(this).css("opacity",b)})}var e="Close",g=d,h="";"undefined"!=typeof f.localizationobj&&(e=f.localizationobj.gui.returnLocalizationString("dialogs.common.button-close","Close"),g=f.localizationobj.gui.returnLocalizationString("dialogs.indicators.title",d));"undefined"!=typeof f.init.TemplateName&&(h=f.init.TemplateName);var q="";"rtl"==f.localizationobj.gui.returnCurrentLanguage().direction&&(q="dir-rtl");$('<div id="chart-dialog" title="'+
g+'"></div>').insertAfter("body");$("#chart-dialog").dialog({dialogClass:"chart-ui-dialog indicators-dialog "+h+" "+q,draggable:!0,autoOpen:!1,resizable:!1,closeOnEscape:!0,width:"auto",modal:!0,open:function(a,b){c($(this).parent());$(".ui-widget-overlay").bind("click",function(){$("#chart-dialog").dialog("close")});ta()},close:function(a,c){b($(this).parent());$("#chart-dialog").remove();$("div.chart-ui-dialog.indicators-dialog  adv-buttons.eye-orange").off().remove();$("div.chart-ui-dialog.indicators-dialog").off().remove();
$(this).off().empty().remove()},buttons:[{id:"btn-dialogs-close",text:e,click:function(){$(this).dialog("close")}}]})}function Ba(a,d,b){function c(a){$(a).find(".spectrum-color").each(function(){$(this).spectrum("destroy")})}function e(a){$(a).find(".ui-dialog-buttonset").prepend('<button class="chart-button adv-buttons eye-orange " type="button" title=""  onclick=""></button>').on("click",function(){var a=$(".chart-ui-dialog.indicator-dialog").css("opacity"),a=1==a?.5:1,b=1==a?"":1;$(".chart-ui-dialog.indicator-dialog").css("opacity",
a);$(this).css("opacity",b)})}a="Close";b="";"undefined"!=typeof f.localizationobj&&(a=f.localizationobj.gui.returnLocalizationString("dialogs.common.button-close","Close"),f.localizationobj.gui.returnLocalizationString("dialogs.common.button-cancel","Cancel"));"undefined"!=typeof f.init.TemplateName&&(b=f.init.TemplateName);var g="";"rtl"==f.localizationobj.gui.returnCurrentLanguage().direction&&(g="dir-rtl");$('<div id="chart-dlgindicator" title="'+d+'"><div id="indicator-inner" class="dialog_level"></div></div>').insertAfter("body");
$("#chart-dlgindicator").dialog({dialogClass:"chart-ui-dialog indicator-dialog "+b+" "+g,draggable:!0,autoOpen:!1,resizable:!1,closeOnEscape:!0,width:"auto",modal:!0,open:function(a,b){e($(this).parent());$(".ui-widget-overlay").bind("click",function(){$("#chart-dlgindicator").dialog("close")});ta()},close:function(a,b){c($(this).parent());$("div.chart-ui-dialog.indicator-dialog  adv-buttons.eye-orange").off().remove();$("#chart-dlgindicator").remove();$(this).off().empty().remove()},buttons:[{id:"btn-order-ok",
text:a,click:function(){$(this).dialog("close")}}]})}function W(a,d,b){$(a).spectrum({color:d,showPalette:!0,showPaletteOnly:!1,clickoutFiresChange:!1,showButtons:!1,palette:["rgb(0, 0, 0);{rgb(66, 66, 66);{rgb(101, 101, 101);{rgb(152, 152, 152);{rgb(182, 182, 182);{rgb(203, 203, 203);{rgb(216, 216, 216);{rgb(238, 238, 238);{rgb(242, 242, 242);{rgb(255, 255, 255);".split("{"),"rgb(151, 0, 0);{rgb(255, 0, 0);{rgb(255, 152, 0);{rgb(255, 255, 0);{rgb(0, 255, 0);{rgb(0, 255, 255);{rgb(73, 133, 231);{rgb(0, 0, 255);{rgb(152, 0, 255);{rgb(255, 0, 255);".split("{"),
"rgb(230, 184, 175);{rgb(244, 204, 204);{rgb(252, 229, 205);{rgb(255, 242, 204);{rgb(217, 234, 211);{rgb(208, 224, 227);{rgb(201, 218, 248);{rgb(207, 226, 243);{rgb(217, 210, 233);{rgb(234, 209, 220);".split("{"),"rgb(221, 126, 107);{rgb(234, 153, 153);{rgb(249, 203, 156);{rgb(255, 229, 153);{rgb(182, 215, 168);{rgb(162, 196, 201);{rgb(164, 194, 244);{rgb(159, 197, 232);{rgb(180, 167, 214);{rgb(213, 166, 189);".split("{"),"rgb(204, 65, 37);{rgb(224, 102, 102);{rgb(246, 178, 107);{rgb(255, 217, 102);{rgb(147, 196, 125);{rgb(118, 165, 175);{rgb(109, 158, 235);{rgb(111, 168, 220);{rgb(142, 124, 195);{rgb(194, 123, 160);".split("{"),
"rgb(166, 28, 0);{rgb(204, 0, 0);{rgb(230, 145, 56);{rgb(241, 194, 50);{rgb(106, 168, 79);{rgb(69, 129, 142);{rgb(60, 120, 216);{rgb(61, 133, 198);{rgb(103, 78, 167);{rgb(166, 77, 121);".split("{"),"rgb(133, 32, 12);{rgb(153, 0, 0);{rgb(180, 95, 6);{rgb(191, 144, 0);{rgb(56, 118, 29);{rgb(19, 79, 92);{rgb(17, 85, 204);{rgb(11, 83, 148);{rgb(53, 28, 117);{rgb(116, 27, 71);".split("{"),"rgb(91, 15, 0);{rgb(102, 0, 0);{rgb(120, 63, 4);{rgb(127, 96, 0);{rgb(39, 78, 19);{rgb(12, 52, 61);{rgb(28, 69, 135);{rgb(7, 55, 99);{rgb(32, 18, 77);{rgb(76, 17, 48);".split("{")]})}
function M(){$(".properties-tabs").delegate("a","click",function(){var a=$(this).parents(".dialog_level"),d=$(a).find(".properties-tabs a").index(this);$(a).find(".main-properties").each(function(){$(this).css("display","none")});$(a).find(".properties-tabs-label").each(function(){$(this).removeClass("active")});$(a).find(".main-properties").eq(d).css("display","block");$(this).addClass("active")})}function V(a){$(".action-move-button-indicator").off();$(".action-move-button-indicator").on("click",
function(){var d=$(this),b=d.attr("tid"),c=d.attr("tpanelid"),e="";""==c&&(c=null,d.hasClass("panel-top")?e="top":d.hasClass("panel-bottom")&&(e="bottom"));d=d.attr("tguiid");U.debug("Move indicator",b,c,d);a:{for(var b=f.chart.GetLegendInfo(),g=0;g<b.length;g++)for(var h=b[g],m=0;m<h.fields.length;m++)if(h.fields[m].uid==a){b=h.id;break a}b=null}null==b&&(b=f.chart.GetPanelIDByDefID(a));f.chart.MoveStudyToOtherPanel(d,b,c,e);c=ha(null,r,a);$("#tbody-indicatorpanels").html(c);V(a)});$(".action-add-button-indicator").off();
$(".action-add-button-indicator").on("click",function(){var a=$(this),b=a.attr("tid"),c=a.attr("tpanelid"),e=a.attr("tguiid");U.debug("Add indicator",b,c,e);$("#button-add-indicator").button({disabled:!0});$("#button-add-indicator-to").button({disabled:!0});$("#dialog-panels-page").css("display","none");$("#dialog-indicator-page").css("display","block");$("#tab-panels").css("display","");e=1;"undefined"==typeof e&&(e=1);for(var p=$("#dlg-indicators .main-page").eq(1).find(".title_level"),h=0;h<p.length;h++)$(p[h]).removeClass("active"),
h>e&&$(p[h]).css("display","none");$(p[e]).css("display","block").addClass("active");e="";""==c&&(c=null,a.hasClass("panel-top")?e="top":a.hasClass("panel-bottom")&&(e="bottom"));x=b;r=f.chart.AddStudyWithParams(x,g,c,e);null!=r&&(g=r,C=!0);a=objChartMain1.chart.GetLegendIDByDefID(r.UID);b=ha(null,r,a);$("#tbody-indicatorpanels").html(b);V(a)})}function ea(a,d,b){"undefined"==typeof b&&(b=a);a=$("#dlg-indicators .main-page").eq(a).find(".title_level");for(var c=0;c<a.length;c++)$(a[c]).removeClass("active"),
c>b&&$(a[c]).css("display","none");$(a[b]).find("a").html(d);$(a[b]).css("display","block").addClass("active")}function xa(){$(" .title_level").delegate("a","click",function(){for(var a=$(this).parents(".main-page"),d=$(a).find(".title_level a").index(this),b=$(a).find(".dialog_level"),c=0;c<b.length;c++){var e=c==d?"block":"none";$(b[c]).css("display",e)}a=$(a).find(".title_level");for(c=d+1;c<a.length;c++)$(a[c]).css("display","none").removeClass("active");$(a[d]).addClass("active")})}function ya(){$("#main-indicator-browser > li").on("click",
function(){for(var a=$("#main-indicator-browser > li").index(this),d=$("#chart-dialog .main-page"),b=0;b<d.length;b++){var c=b==a?"block":"none";$(d[b]).css("display",c)}a=$(this).html();ea(0,a)})}function X(a,d){var b=d.split(".");return 1==b.length?a[b[0]]:"undefined"!=typeof a[b[0]]?X(a[b[0]],b.slice(1).join(".")):null}function I(a,d,b){d=d.split(".");1==d.length&&(a[d[0]]=b);"undefined"!=typeof a[d[0]]&&I(a[d[0]],d.slice(1).join("."),b)}function sa(a,d){for(var b=Object.keys(a),c=0;c<b.length;c++){var e=
b[c];"undefined"==typeof d[e]&&(typeof a[e]==Object?(d[e]={},sa(a[e],d[e])):d[e]=a[e])}}function Q(){$(".chart-ui-dialog .onlynumeric").prochart_numeric()}function ka(){"undefined"!=typeof f.preloadobj&&f.preloadobj.startPreload()}function ta(){"undefined"!=typeof f.preloadobj&&f.preloadobj.endPreload()}function A(a,d){var b="",c=a.indexOf("<"+d+">"),e=("<"+d+">").length,f=a.indexOf("</"+d+">");-1!=c&&-1!=f&&f>c+e&&(b=a.substring(c+e,f));return b}var f=E;E={};f.indicators=E;var U=f.api.debug.getLogger("prochart.gui.indicators"),
K="",s={All:0,Style:1,Draw:2,Value:3};F=0;z=Z=Y=ba=aa=J=y=G=null;var m=[],v=[];x="";g=r=null;C=!1;E.gui={viewIndicators:function(){ua()},viewIndicator:function(a,d){qa(d)},getIndicatorObjectParam:function(a){for(var d=H(a),b=d.renderitems,c=0;c<b;c++){var e=d["renderitem"+(c+1)],g={};"undefined"==typeof e.style&&(e.style=[],e.style.push(g));if("undefined"!=typeof f.chart.StyleObject[a+"_item"+(c+1)]){var h=f.chart.StyleObject[a+"_item"+(c+1)];"undefined"==typeof g.stroke&&(g.stroke="undefined"!==
typeof h.stroke?h.stroke:"rgb(0,0,0)");"undefined"==typeof g.strokeWidth&&(g.strokeWidth="undefined"!=typeof h.strokeWidth?h.strokeWidth:"1");"undefined"==typeof g.strokeOpacity&&(g.strokeOpacity="undefined"!=typeof h.strokeOpacity?h.strokeOpacity:"1");"undefined"==typeof g.fill&&"undefined"!=typeof h.fill&&(g.fill=h.fill);"undefined"==typeof g.fillOpacity&&(g.fillOpacity="undefined"!=typeof h.fillOpacity?h.fillOpacity:"1");"undefined"==typeof g.visible&&(g.visible=!0);"undefined"!=typeof d.base&&
(h={},h.stroke=g.stroke,h.strokeWidth=g.strokeWidth,h.strokeOpacity=g.strokeOpacity,h.visible=g.visible,h.fill=g.fill,h.fillOpacity=g.fillOpacity,e.style.push(h))}}if(null!=d&&"undefined"!=typeof d.levels&&null!=d.levels)for(b=d.levels,c=b.length,e=0;e<c;e++){g=b[e];try{if("undefined"==typeof f.chart.StyleObject.indicators[a].levels[e])continue}catch(m){continue}h=f.chart.StyleObject.indicators[a].levels[e];"undefined"!=typeof h.stroke&&(g.stroke=h.stroke);"undefined"!=typeof h.strokeOpacity&&(g.strokeOpacity=
h.strokeOpacity);"undefined"!=typeof h.strokeWidth&&(g.strokeWidth=h.strokeWidth);"undefined"!=typeof h.strokeDasharray&&(g.strokeDasharray=h.strokeDasharray)}return d}};f.chart.UI.funcOnStudyEdit=qa;return E};
