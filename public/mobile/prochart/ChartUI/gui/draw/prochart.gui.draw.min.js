function ProChart_InitDraw(Ea){var M,N,O,P,Q,R,S,T,U,V,W,X,v;function Z(a){M=x(a,"fan-pattern");N=x(a,"square-trendline-pattern");O=x(a,"square-levels-pattern");P=x(a,"fiboarc-trendline-pattern");Q=x(a,"fiboarc-levels-pattern");R=x(a,"fibo-trendline-pattern");S=x(a,"fibo-levels-pattern");T=x(a,"fork-trendline-pattern");U=x(a,"fork-levels-pattern");V=x(a,"linereg-trendline-pattern");W=x(a,"linereg-levels-pattern");X=x(a,"coordinates_pattern");v=x(a,"border-style-pattern")}function aa(a,b){u=Fa(b.ShapeType);
"undefined"!=typeof d.preloadobj&&d.preloadobj.startPreload();try{switch(b.ShapeType){case "polygon":case "rect":case "ellipse":case "triangle":case "shape":case "circle":case "sketch":case "arc":ba(b);break;case "fibfan":case "ganfan":Ga(b);break;case "fibtimezones":case "fibtimeextension":ca(b);break;case "cycleline":da(b);break;case "gansquare":ea(b);break;case "fibretrace":case "fibextension":fa(b);break;case "fibarc":ga(b);break;case "fork":ha(b);break;case "linearreg":ia(b);break;case "arrow":case "line":ja(b);
break;case "parallel":ka(b);break;case "text":la(b);break;case "hline":case "measure":case "vline":ma(b);break;default:w()}}catch(c){w()}}function Fa(a){function b(a,b){return"undefined"!=typeof d.localizationobj?d.localizationobj.gui.returnLocalizationString(a,b):b}var c="";switch(a){case "polygon":c=b("dialogs.titles."+a,"Polygon");break;case "rect":c=b("dialogs.titles."+a,"Rectangle");break;case "ellipse":c=b("dialogs.titles."+a,"Ellipse");break;case "triangle":c=b("dialogs.titles."+a,"Triangle");
break;case "circle":c=b("dialogs.titles."+a,"Circle");break;case "sketch":c=b("dialogs.titles."+a,"Sketch");break;case "arc":c=b("dialogs.titles."+a,"Acr");break;case "fibfan":c=b("dialogs.titles."+a,"Fan");break;case "ganfan":c=b("dialogs.titles."+a,"Gann Fan");break;case "fibtimeextension":c=b("dialogs.titles."+a,"Fibo Time Zone Extension ");break;case "fibtimezones":c=b("dialogs.titles."+a,"Fibo Time Zone");break;case "cycleline":c=b("dialogs.titles."+a,"Circle Line");break;case "gansquare":c=
b("dialogs.titles."+a,"Gan Square");break;case "fibretrace":c=b("dialogs.titles."+a,"Fib Retracement");break;case "fibextension":c=b("dialogs.titles."+a,"Fib Extension");break;case "fibarc":c=b("dialogs.titles."+a,"Fib Arcs");break;case "fork":c=b("dialogs.titles."+a,"Pitchfork");break;case "linearreg":c=b("dialogs.titles."+a,"Regression Trend");break;case "arrow":c=b("dialogs.titles."+a,"Arrow");break;case "line":c=b("dialogs.titles."+a,"Line");break;case "parallel":c=b("dialogs.titles."+a,"Parallel Channel");
break;case "text":c=b("dialogs.titles."+a,"Text Label");break;case "hline":c=b("dialogs.titles."+a,"Horizontal Line");break;case "measure":c=b("dialogs.titles."+a,"Measure Line");break;case "vline":c=b("dialogs.titles."+a,"Vertical Line")}return c}function ia(a){c=a;a=!1==d.guiinit.cache?"?"+d.version.gui.name+(new Date).getTime():"?"+d.version.gui.name;y("shape",u);a=d.guiinit.rootpath+"/ChartUI/gui/draw/linearreg.htm"+a;if(d.navigator.XMLHttpRequest()){var b=new XMLHttpRequest,e=$.Deferred();b.open("get",
a);b.onload=function(){var a=b.responseText;na($(a).find("#dlg-linearreg"));e.resolve(a)};b.send();return e}return $.ajax({type:"GET",async:!0,dataType:"html",url:a,success:function(a){na($(a).find("#dlg-linearreg"))}})}function na(a){var b=c;$("#chart-dialog").html(a);try{var e=$("#tbody-levels"),k=V.replace(/%border_style_pattern%/g,v);$(e).append(k);0==c.Levels.length&&(c.Levels.push(0),c.Levels.push(0),c.Levels.push(0));var g=b.MainLineStyle;B(g,"#trendline-width","#color-trendline","#line-select-trendline");
C(g,"#trendline-width","#color-trendline","#line-select-trendline");a=W;k=[];k.push({name:"topline",caption:"Top Line"});k.push({name:"middleline",caption:"Middle Line"});k.push({name:"bottomline",caption:"Bottom Line"});for(g=0;3>g;g++){var d=a.replace(/%order%/g,g).replace(/%levelindex%/g,g).replace(/%linename%/g,k[g].name).replace(/%border_style_pattern%/g,v).replace(/%linecaption%/g,k[g].caption);$(e).append(d);var l=b.LevelsStyle["level"+g],m=b.LevelFillsStyle["level"+g];E(l,"#slider-5-level-"+
g);F(l,m,"#color-background-level-"+g);G(l,"#line-select-level-"+g);!1==b.LevelsView[g]&&($("#control-background-level-"+g).prop("checked",!1),$("#slider-5-level-"+g).slider("disable"),$("#color-background-level-"+g).spectrum("disable"),$("#input-level-"+g).prop("disabled",!0),$("#line-select-level-"+g).prop("disabled",!0))}H(b.MainLineStyle,"#slider-100",b.LevelFillsStyle);I("#control-background","#slider-100");!0!=b.MainLineStyle.viewFill&&($("#control-background").prop("checked",!1),$("#slider-100").slider("disable"));
z(b.Coordinations,b.TimeScale,b);A();$("#chart-dialog").dialog("open")}catch(p){w()}}function ba(a){c=a;a=!1==d.guiinit.cache?"?"+d.version.gui.name+(new Date).getTime():"?"+d.version.gui.name;y("shape",u);a=d.guiinit.rootpath+"/ChartUI/gui/draw/shape.htm"+a;if(d.navigator.XMLHttpRequest()){var b=new XMLHttpRequest,e=$.Deferred();b.open("get",a);b.onload=function(){var a=b.responseText;oa($(a).find("#dlg-shape"));e.resolve(a)};b.send();return e}return $.ajax({type:"GET",async:!0,dataType:"html",url:a,
success:function(a){oa($(a).find("#dlg-shape"))}})}function oa(a){$("#chart-dialog").html(a);try{var b=c.MainLineStyle;B(b,"#border-width","#color-border","#linedesign-select");pa(b,"#control-background","#color-background","#slider-100");C(b,"#border-width","#color-border","#linedesign-select");qa(b,"#control-background","#color-background","#slider-100");z(c.Coordinations,c.TimeScale,c);A();$("#chart-dialog").dialog("open")}catch(e){w()}}function ja(a){c=a;a=!1==d.guiinit.cache?"?"+d.version.gui.name+
(new Date).getTime():"?"+d.version.gui.name;y("line",u);a=d.guiinit.rootpath+"/ChartUI/gui/draw/line.htm"+a;if(d.navigator.XMLHttpRequest()){var b=new XMLHttpRequest,e=$.Deferred();b.open("get",a);b.onload=function(){var a=b.responseText;ra($(a).find("#dlg-line"));e.resolve(a)};b.send();return e}return $.ajax({type:"GET",async:!0,dataType:"html",url:a,success:function(a){ra($(a).find("#dlg-line"))}})}function ra(a){$("#chart-dialog").html(a);try{var b=c.MainLineStyle;B(b,"#line-width","#line-color",
"#linedesign-select");C(b,"#line-width","#line-color","#linedesign-select");sa(c,"#line-extendleft","#line-extendright");z(c.Coordinations,c.TimeScale,c);A();$("#chart-dialog").dialog("open")}catch(e){w()}}function da(a){c=a;a=!1==d.guiinit.cache?"?"+d.version.gui.name+(new Date).getTime():"?"+d.version.gui.name;y("line",u);a=d.guiinit.rootpath+"/ChartUI/gui/draw/circleline.htm"+a;if(d.navigator.XMLHttpRequest()){var b=new XMLHttpRequest,e=$.Deferred();b.open("get",a);b.onload=function(){var a=b.responseText;
ta($(a).find("#dlg-circleline"));e.resolve(a)};b.send();return e}return $.ajax({type:"GET",async:!0,dataType:"html",url:a,success:function(a){ta($(a).find("#dlg-circleline"))}})}function ta(a){$("#chart-dialog").html(a);try{var b=c.MainLineStyle;B(b,"#line-width","#line-color","#linedesign-select");C(b,"#line-width","#line-color","#linedesign-select");z(c.Coordinations,c.TimeScale,c);A();$("#chart-dialog").dialog("open")}catch(e){w()}}function ca(a){c=a;a=!1==d.guiinit.cache?"?"+d.version.gui.name+
(new Date).getTime():"?"+d.version.gui.name;y("line",u);a=d.guiinit.rootpath+"/ChartUI/gui/draw/timezone.htm"+a;if(d.navigator.XMLHttpRequest()){var b=new XMLHttpRequest,e=$.Deferred();b.open("get",a);b.onload=function(){var a=b.responseText;ua($(a).find("#dlg-timezone"));e.resolve(a)};b.send();return e}return $.ajax({type:"GET",async:!0,dataType:"html",url:a,success:function(a){ua($(a).find("#dlg-timezone"))}})}function ua(a){$("#chart-dialog").html(a);try{var b=c.MainLineStyle;B(b,"#line-width",
"#line-color","#linedesign-select");C(b,"#line-width","#line-color","#linedesign-select");z(c.Coordinations,c.TimeScale,c);D(c);A();$("#chart-dialog").dialog("open")}catch(e){w()}}function ka(a){c=a;a=!1==d.guiinit.cache?"?"+d.version.gui.name+(new Date).getTime():"?"+d.version.gui.name;y("line",u);a=d.guiinit.rootpath+"/ChartUI/gui/draw/parallel.htm"+a;if(d.navigator.XMLHttpRequest()){var b=new XMLHttpRequest,e=$.Deferred();b.open("get",a);b.onload=function(){var a=b.responseText;va($(a).find("#dlg-parallel"));
e.resolve(a)};b.send();return e}return $.ajax({type:"GET",async:!0,dataType:"html",url:a,success:function(a){va($(a).find("#dlg-parallel"))}})}function va(a){$("#chart-dialog").html(a);try{var b=c.MainLineStyle,e=c.MainLineStyle;B(b,"#line-width","#line-color","#linedesign-select");pa(e,"#control-background","#color-background","#slider-100");C(b,"#line-width","#line-color","#linedesign-select");qa(e,"#control-background","#color-background","#slider-100");sa(c,"#line-extendleft","#line-extendright");
z(c.Coordinations,c.TimeScale,c);A();$("#chart-dialog").dialog("open")}catch(k){w()}}function ma(a){c=a;a=!1==d.guiinit.cache?"?"+d.version.gui.name+(new Date).getTime():"?"+d.version.gui.name;y("line",u);a=d.guiinit.rootpath+"/ChartUI/gui/draw/vhline.htm"+a;if(d.navigator.XMLHttpRequest()){var b=new XMLHttpRequest,e=$.Deferred();b.open("get",a);b.onload=function(){var a=b.responseText;wa($(a).find("#dlg-line"));e.resolve(a)};b.send();return e}return $.ajax({type:"GET",async:!0,dataType:"html",url:a,
success:function(a){wa($(a).find("#dlg-line"))}})}function wa(a){$("#chart-dialog").html(a);try{var b=c.MainLineStyle;B(b,"#line-width","#line-color","#linedesign-select");C(b,"#line-width","#line-color","#linedesign-select");z(c.Coordinations,c.TimeScale,c);switch(c.ShapeType){case "hline":var e=$("#tbody-coordinates td");$(e[2]).css("display","none");$(e[3]).css("display","none");$(e[4]).css("display","none");break;case "vline":var k=$("#tbody-coordinates td");$(k[0]).css("display","none");$(k[1]).css("display",
"none")}D(c);A();$("#chart-dialog").dialog("open")}catch(g){w()}}function la(a){c=a;a=!1==d.guiinit.cache?"?"+d.version.gui.name+(new Date).getTime():"?"+d.version.gui.name;y("text",u);a=d.guiinit.rootpath+"/ChartUI/gui/draw/text.htm"+a;if(d.navigator.XMLHttpRequest()){var b=new XMLHttpRequest,e=$.Deferred();b.open("get",a);b.onload=function(){var a=b.responseText;xa($(a).find("#dlg-text"));e.resolve(a)};b.send();return e}return $.ajax({type:"GET",async:!0,dataType:"html",url:a,success:function(a){xa($(a).find("#dlg-text"))}})}
function xa(a){$("#chart-dialog").html(a);try{$("#input-text").val(c.Label),$("#input-text").on("change",function(){c.Label=$(this).val();c.Refresh()}),D(c),z(c.Coordinations,c.TimeScale,c),A(),$("#chart-dialog").dialog("open")}catch(b){w()}}function Ga(a){c=a;a=!1==d.guiinit.cache?"?"+d.version.gui.name+(new Date).getTime():"?"+d.version.gui.name;y("gannfan",u);a=d.guiinit.rootpath+"/ChartUI/gui/draw/fibo.htm"+a;if(d.navigator.XMLHttpRequest()){var b=new XMLHttpRequest,e=$.Deferred();b.open("get",
a);b.onload=function(){var a=b.responseText;ya($(a).find("#dlg-fibo"));e.resolve(a)};b.send();return e}return $.ajax({type:"GET",async:!0,dataType:"html",url:a,success:function(a){ya($(a).find("#dlg-fibo"))}})}function ya(a){$("#chart-dialog").html(a);try{var b=M.replace(/%border_style_pattern%/g,v),e=c.Levels,k=$("#tbody-levels");if(null!=e)for(a=0;a<e.length;a++){var g=b.replace(/%order%/g,a).replace(/%levelindex%/g,a).replace(/%input-value%/g,e[a]).replace(/%border_style_pattern%/g,v);$(k).append(g);
var d=c.LevelsStyle["level"+a],l=c.LevelFillsStyle["level"+a];E(d,"#slider-5-level-"+a);F(d,l,"#color-background-level-"+a);G(d,"#line-select-level-"+a);!1==c.LevelsView[a]&&($("#control-background-level-"+a).prop("checked",!1),$("#slider-5-level-"+a).slider("disable"),$("#color-background-level-"+a).spectrum("disable"),$("#input-level-"+a).prop("disabled",!0),$("#line-select-level-"+a).prop("disabled",!0))}H(c.MainLineStyle,"#slider-100",c.LevelFillsStyle);!0!=c.MainLineStyle.viewFill&&($("#control-background").prop("checked",
!1),$("#slider-100").slider("disable"));!0!=c.LabelsStyle.view&&$("#control-labels").prop("checked",!1);J();$(".control-background-level").on("click",function(a){a=$(".control-background-level").index(this);$(this).is(":checked")?($("#slider-5-level-"+a).slider("enable"),$("#color-background-level-"+a).spectrum("enable"),$("#input-level-"+a).prop("disabled",!1),$("#line-select-level-"+a).prop("disabled",!1),c.LevelsView[a]=!0):($("#slider-5-level-"+a).slider("disable"),$("#color-background-level-"+
a).spectrum("disable"),$("#input-level-"+a).prop("disabled",!0),$("#line-select-level-"+a).prop("disabled",!0),c.LevelsView[a]=!1);c.Refresh()});I("#control-background","#slider-100");$(".class-input-level").on("change",function(){var a=$(".class-input-level").index(this);""!=$(this).val()&&$.isNumeric($(this).val())&&($(this).attr("prevvalue",$(this).val()),e[a]=$(this).val(),c.Refresh())});$(".class-input-level").on("keydown",function(a){13==a.keyCode&&(a=$(".class-input-level").index(this),""!=
$(this).val()&&$.isNumeric($(this).val())&&(e[a]=$(this).val(),c.Refresh()))});z(c.Coordinations,c.TimeScale,c);D(c);A();$("#chart-dialog").dialog("open")}catch(m){w()}}function ea(a){c=a;a=!1==d.guiinit.cache?"?"+d.version.gui.name+(new Date).getTime():"?"+d.version.gui.name;y("square",u);a=d.guiinit.rootpath+"/ChartUI/gui/draw/square.htm"+a;if(d.navigator.XMLHttpRequest()){var b=new XMLHttpRequest,e=$.Deferred();b.open("get",a);b.onload=function(){var a=b.responseText;za($(a).find("#dlg-square"));
e.resolve(a)};b.send();return e}return $.ajax({type:"GET",async:!0,dataType:"html",url:a,success:function(a){za($(a).find("#dlg-square"))}})}function za(a){$("#chart-dialog").html(a);try{var b=$("#tbody-levels"),e=N.replace(/%border_style_pattern%/g,v);$(b).append(e);var k=c.MainLineStyle;B(k,"#trendline-width","#color-trendline","#line-select-trendline");C(k,"#trendline-width","#color-trendline","#line-select-trendline");a=O;var d=c.Levels;if(null!=d)for(e=0;e<d.length;e++){var h=a.replace(/%order%/g,
e).replace(/%levelindex%/g,e).replace(/%border_style_pattern%/g,v).replace(/%input-value%/g,d[e]);$(b).append(h);var l=c.LevelsStyle["level"+e],m=c.LevelsStyle["level"+e];E(l,"#slider-5-level-"+e);F(l,m,"#color-background-level-"+e);G(l,"#line-select-level-"+e)}z(c.Coordinations,c.TimeScale,c);D(c);A();$("#chart-dialog").dialog("open")}catch(p){w()}}function ga(a){c=a;a=!1==d.guiinit.cache?"?"+d.version.gui.name+(new Date).getTime():"?"+d.version.gui.name;y("fiboarc",u);a=d.guiinit.rootpath+"/ChartUI/gui/draw/fibo.htm"+
a;if(d.navigator.XMLHttpRequest()){var b=new XMLHttpRequest,e=$.Deferred();b.open("get",a);b.onload=function(){var a=b.responseText;Aa($(a).find("#dlg-fibo"));e.resolve(a)};b.send();return e}return $.ajax({type:"GET",async:!0,dataType:"html",url:a,success:function(a){Aa($(a).find("#dlg-fibo"))}})}function Aa(a){$("#chart-dialog").html(a);try{var b=$("#tbody-levels"),e=P.replace(/%border_style_pattern%/g,v);$(b).append(e);var k=c.MainLineStyle;B(k,"#trendline-width","#color-trendline","#line-select-trendline");
C(k,"#trendline-width","#color-trendline","#line-select-trendline");var d=Q.replace(/%border_style_pattern%/g,v),h=c.Levels;if(null!=h)for(a=0;a<h.length;a++){var l=d.replace(/%order%/g,a).replace(/%levelindex%/g,a).replace(/%border_style_pattern%/g,v).replace(/%input-value%/g,h[a]);$(b).append(l);var m=c.LevelsStyle["level"+a],p=c.LevelFillsStyle["level"+a];E(m,"#slider-5-level-"+a);F(m,p,"#color-background-level-"+a);G(m,"#line-select-level-"+a);!1==c.LevelsView[a]&&($("#control-background-level-"+
a).prop("checked",!1),$("#slider-5-level-"+a).slider("disable"),$("#color-background-level-"+a).spectrum("disable"),$("#input-level-"+a).prop("disabled",!0),$("#line-select-level-"+a).prop("disabled",!0))}H(c.MainLineStyle,"#slider-100",c.LevelFillsStyle);!0!=c.MainLineStyle.viewFill&&($("#control-background").prop("checked",!1),$("#slider-100").slider("disable"));!0!=c.LabelsStyle.view&&$("#control-labels").prop("checked",!1);J();$(".control-background-level").on("click",function(a){a=$(".control-background-level").index(this);
$(this).is(":checked")?($("#slider-5-level-"+a).slider("enable"),$("#color-background-level-"+a).spectrum("enable"),$("#input-level-"+a).prop("disabled",!1),$("#line-select-level-"+a).prop("disabled",!1),c.LevelsView[a]=!0):($("#slider-5-level-"+a).slider("disable"),$("#color-background-level-"+a).spectrum("disable"),$("#input-level-"+a).prop("disabled",!0),$("#line-select-level-"+a).prop("disabled",!0),c.LevelsView[a]=!1);c.Refresh()});I("#control-background","#slider-100");$(".class-input-level").on("change",
function(){var a=$(".class-input-level").index(this);""!=$(this).val()&&$.isNumeric($(this).val())&&($(this).attr("prevvalue",$(this).val()),h[a]=$(this).val(),c.Refresh())});$(".class-input-level").on("keydown",function(a){13==a.keyCode&&(a=$(".class-input-level").index(this),""!=$(this).val()&&$.isNumeric($(this).val())&&(h[a]=$(this).val(),c.Refresh()))});z(c.Coordinations,c.TimeScale,c);D(c);A();$("#chart-dialog").dialog("open")}catch(u){w()}}function fa(a){c=a;a=!1==d.guiinit.cache?"?"+d.version.gui.name+
(new Date).getTime():"?"+d.version.gui.name;y("gannfan",u);a=d.guiinit.rootpath+"/ChartUI/gui/draw/fibo.htm"+a;if(d.navigator.XMLHttpRequest()){var b=new XMLHttpRequest,e=$.Deferred();b.open("get",a);b.onload=function(){var a=b.responseText;Ba($(a).find("#dlg-fibo"));e.resolve(a)};b.send();return e}return $.ajax({type:"GET",async:!0,dataType:"html",url:a,success:function(a){Ba($(a).find("#dlg-fibo"))}})}function Ba(a){$("#chart-dialog").html(a);try{var b=$("#tbody-levels"),e=R.replace(/%border_style_pattern%/g,
v);$(b).append(e);var k=c.MainLineStyle;B(k,"#trendline-width","#color-trendline","#line-select-trendline");C(k,"#trendline-width","#color-trendline","#line-select-trendline");var d=S.replace(/%border_style_pattern%/g,v),h=c.Levels;if(null!=h)for(a=0;a<h.length;a++){var l=d.replace(/%order%/g,a).replace(/%levelindex%/g,a).replace(/%border_style_pattern%/g,v).replace(/%input-value%/g,h[a]);$(b).append(l);var m=c.LevelsStyle["level"+a],p=c.LevelFillsStyle["level"+a];E(m,"#slider-5-level-"+a);F(m,p,
"#color-background-level-"+a);G(m,"#line-select-level-"+a);!1==c.LevelsView[a]&&($("#control-background-level-"+a).prop("checked",!1),$("#slider-5-level-"+a).slider("disable"),$("#color-background-level-"+a).spectrum("disable"),$("#input-level-"+a).prop("disabled",!0),$("#line-select-level-"+a).prop("disabled",!0))}H(c.MainLineStyle,"#slider-100",c.LevelFillsStyle);!0!=c.MainLineStyle.viewFill&&($("#control-background").prop("checked",!1),$("#slider-100").slider("disable"));!0!=c.LabelsStyle.view&&
$("#control-labels").prop("checked",!1);J();$(".control-background-level").on("click",function(a){a=$(".control-background-level").index(this);$(this).is(":checked")?($("#slider-5-level-"+a).slider("enable"),$("#color-background-level-"+a).spectrum("enable"),$("#input-level-"+a).prop("disabled",!1),$("#line-select-level-"+a).prop("disabled",!1),c.LevelsView[a]=!0):($("#slider-5-level-"+a).slider("disable"),$("#color-background-level-"+a).spectrum("disable"),$("#input-level-"+a).prop("disabled",!0),
$("#line-select-level-"+a).prop("disabled",!0),c.LevelsView[a]=!1);c.Refresh()});I("#control-background","#slider-100");$(".class-input-level").on("change",function(){var a=$(".class-input-level").index(this);""!=$(this).val()&&$.isNumeric($(this).val())&&($(this).attr("prevvalue",$(this).val()),h[a]=$(this).val(),c.Refresh())});$(".class-input-level").on("keydown",function(a){13==a.keyCode&&(a=$(".class-input-level").index(this),""!=$(this).val()&&$.isNumeric($(this).val())&&(h[a]=$(this).val(),
objshapeinfo.Refresh()))});z(c.Coordinations,c.TimeScale,c);D(c);A();$("#chart-dialog").dialog("open")}catch(u){w()}}function ha(a){c=a;a=!1==d.guiinit.cache?"?"+d.version.gui.name+(new Date).getTime():"?"+d.version.gui.name;y("gannfan",u);a=d.guiinit.rootpath+"/ChartUI/gui/draw/fork.htm"+a;if(d.navigator.XMLHttpRequest()){var b=new XMLHttpRequest,e=$.Deferred();b.open("get",a);b.onload=function(){var a=b.responseText;Ca($(a).find("#dlg-fork"));e.resolve(a)};b.send();return e}return $.ajax({type:"GET",
async:!0,dataType:"html",url:a,success:function(a){Ca($(a).find("#dlg-fork"))}})}function Ca(a){var b=c;$("#chart-dialog").html(a);try{var e=$("#tbody-levels"),d=T.replace(/%border_style_pattern%/g,v);$(e).append(d);var g=b.MainLineStyle;B(g,"#median-width","#color-median","#line-select-median");C(g,"#median-width","#color-median","#line-select-median");a=U;var h=b.Levels;if(null!=h)for(d=0;d<h.length;d++){var l=a.replace(/%order%/g,d).replace(/%levelindex%/g,d).replace(/%border_style_pattern%/g,
v).replace(/%input-value%/g,h[d]);$(e).append(l);var m=b.LevelsStyle["level"+d],p=b.LevelFillsStyle["level"+d];E(m,"#slider-5-level-"+d);F(m,p,"#color-background-level-"+d);G(m,"#line-select-level-"+d);!1==b.LevelsView[d]&&($("#control-background-level-"+d).prop("checked",!1),$("#slider-5-level-"+d).slider("disable"),$("#color-background-level-"+d).spectrum("disable"),$("#input-level-"+d).prop("disabled",!0),$("#line-select-level-"+d).prop("disabled",!0))}H(b.MainLineStyle,"#slider-100",b.LevelFillsStyle);
!0!=b.MainLineStyle.viewFill&&($("#control-background").prop("checked",!1),$("#slider-100").slider("disable"));J();$(".control-background-level").on("click",function(a){a=$(this).is(":checked");var b=$(".control-background-level").index(this);a?($("#slider-5-level-"+b).slider("enable"),$("#color-background-level-"+b).spectrum("enable"),$("#input-level-"+b).prop("disabled",!1),$("#line-select-level-"+b).prop("disabled",!1),c.LevelsView[b]=!0):($("#slider-5-level-"+b).slider("disable"),$("#color-background-level-"+
b).spectrum("disable"),$("#input-level-"+b).prop("disabled",!0),$("#line-select-level-"+b).prop("disabled",!0),c.LevelsView[b]=!1);c.Refresh()});I("#control-background","#slider-100");$(".class-input-level").on("change",function(){var a=$(".class-input-level").index(this);""!=$(this).val()&&$.isNumeric($(this).val())&&($(this).attr("prevvalue",$(this).val()),h[a]=$(this).val(),b.Refresh())});$(".class-input-level").on("keydown",function(a){13==a.keyCode&&(a=$(".class-input-level").index(this),""!=
$(this).val()&&$.isNumeric($(this).val())&&(h[a]=$(this).val(),b.Refresh()))});z(b.Coordinations,b.TimeScale,b);A();$("#chart-dialog").dialog("open")}catch(u){w()}}function D(a){a=a.LabelsStyle;var b=d.commonutils.func.parseColorString(a.backgroundColor),e="rgb(%r%, %g%, %b%)".replace("%r%",b[0]).replace("%g%",b[1]).replace("%b%",b[2]),b=b[3];K($("#background-labelcolor"),e);K($("#color-font"),a.fill);$("#label-bk-coloropacity").slider({min:0,max:100});$("#label-bk-coloropacity .gradient").css("background-image",
"linear-gradient(to left, #000 0%, transparent 100% )");b*=100;$("#label-bk-coloropacity").slider("option","value",b);!0!=a.viewBackground&&($("#label-background").prop("checked",!1),$("#label-bk-coloropacity").slider("disable"),$("#background-labelcolor").spectrum("disable"));switch("bold"==a.fontWeight){case !0:$("#button_fontbold").removeClass("active").addClass("active");break;case !1:$("#button_fontbold").removeClass("active")}switch("italic"==a.fontStyle){case !0:$("#button_fontitalic").removeClass("active").addClass("active");
break;case !1:$("#button_fontitalic").removeClass("active")}$("#dialog-fontsize-select").val(a.fontSize);$("#dialog-fontname-select").val(a.fontName);$("#button_fontbold").on("click",function(){$(this).toggleClass("active");$(this).hasClass("active")?c.LabelsStyle.fontWeight="bold":c.LabelsStyle.fontWeight="normal";c.Refresh()});$("#button_fontitalic").on("click",function(){$(this).toggleClass("active");$(this).hasClass("active")?c.LabelsStyle.fontStyle="italic":c.LabelsStyle.fontStyle="normal";c.Refresh()});
$("#dialog-fontsize-select").on("change",function(){c.LabelsStyle.fontSize=$(this).val();c.Refresh()});$("#dialog-fontname-select").on("change",function(){c.LabelsStyle.fontName=$(this).val();c.Refresh()});$("#label-background").on("click",function(a){$(this).is(":checked")?($("#label-bk-coloropacity").slider("enable"),$("#background-labelcolor").spectrum("enable"),c.LabelsStyle.viewBackground=!0):($("#label-bk-coloropacity").slider("disable"),$("#background-labelcolor").spectrum("disable"),c.LabelsStyle.viewBackground=
!1);c.Refresh()});$("#label-bk-coloropacity").on("slide slidechange",function(){var a=$(this).slider("option","value")/100,b=d.commonutils.func.parseColorString(c.LabelsStyle.backgroundColor),a="rgba(%r%, %g%, %b%, %o%)".replace("%r%",b[0]).replace("%g%",b[1]).replace("%b%",b[2]).replace("%o%",a);c.LabelsStyle.backgroundColor=a;c.Refresh()});$("#control-labels").on("click",function(a){$(this).is(":checked")?c.LabelsStyle.view=!0:c.LabelsStyle.view=!1;c.Refresh()});$("#color-font").on("change",function(){var a=
$(this).spectrum("get").toHexString(),a=d.commonutils.func.parseColorString(a),a="rgba(%r%, %g%, %b%, %o%)".replace("%r%",a[0]).replace("%g%",a[1]).replace("%b%",a[2]).replace("%o%","1");c.LabelsStyle.fill=a;c.Refresh()});$("#background-labelcolor").on("change",function(){var a=$(this).spectrum("get").toHexString(),b=d.commonutils.func.parseColorString(c.LabelsStyle.backgroundColor)[3],a=d.commonutils.func.parseColorString(a),b="rgba(%r%, %g%, %b%, %o%)".replace("%r%",a[0]).replace("%g%",a[1]).replace("%b%",
a[2]).replace("%o%",b);c.LabelsStyle.backgroundColor=b;c.Refresh()})}function z(a,b,c){var k=$("#tbody-coordinates"),g='<tr><td> <span data-localize="dialogs.draw.lb-price">Price</span> %id% </td><td><input type="text"  id="input-price-%id%"  prevvalue="%pricevalue%"  idx="%id%" class="dialog-text-input onlynumeric inputprice" autocomplete="off" autofocus=""  value ="%pricevalue%"  /></td><td><span data-localize="dialogs.draw.lb-date">Date</span> #</td><td><input class="dialog-text-input datespinner-input" idx="%id%" id="date-%id%" readonly value="%datevalue%"/><input class="dialog-text-input dialog-spinner datespinner " idx="%id%" id="date-spinner-%id%" value="0"/></td><tr/>',
g=X,h=/%id%/g,l=/%pricevalue%/g,m=/%datevalue%/g;L=[];if(null!=a)for(var p=0;p<a.length;p++){var u=g.replace(h,p).replace(l,a[p].yData).replace(m,d.chart.formatDate(a[p].xData));L.push(a[p].xData);$(k).append(u);$("#date-spinner-"+p).spinner({spin:function(g,k){var h=$(this).attr("id").toString().replace("-spinner",""),h=$("#"+h),l=$(this).attr("idx"),h=$("#date-"+l),n=L[l];$(this).spinner("value");var f=0;if($(this).val()>k.value)f=-1;else if($(this).val()<k.value)f=1;else return;var n=n.replace(/-/g,
"-").replace(/:/g,"-").replace(/ /g,"-").split("-"),m=parseInt(n[0]),p=parseInt(n[1])-1,q=parseInt(n[2]),r=parseInt(n[3]),s=parseInt(n[4]),t=parseInt(n[5]),n=new Date(m,p,q,r,s,t);switch(b){case "tick":case "Tick":case "TICK":case "1T":case "1t":f*=1;case "1m":case "1M":n=new Date(m,p,q,r,s+1*f,t);break;case "5m":case "5M":f*=5;n=new Date(m,p,q,r,s+f,t);break;case "10M":case "10m":f*=10;n=new Date(m,p,q,r,s+f,t);break;case "15M":case "15m":f*=15;n=new Date(m,p,q,r,s+f,t);break;case "30M":case "30m":f*=
30;n=new Date(m,p,q,r,s+f,t);break;case "60M":case "60m":f*=1;n=new Date(m,p,q,r+f,s,t);break;case "2H":case "2h":f*=2;n=new Date(m,p,q,r+f,s,t);break;case "4H":case "4h":f*=4;n=new Date(m,p,q,r+f,s,t);break;case "6H":case "6h":f*=6;n=new Date(m,p,q,r+f,s,t);break;case "8H":case "8h":f*=8;n=new Date(m,p,q,r+f,s,t);break;case "10H":case "10h":f*=10;n=new Date(m,p,q,r+f,s,t);break;case "12H":case "12h":f*=12;n=new Date(m,p,q,r+f,s,t);break;case "14H":case "14h":f*=14;n=new Date(m,p,q,r+f,s,t);break;
case "1D":case "1d":f*=1;n=new Date(m,p,q+f,r,s,t);break;case "1W":case "1w":f*=7;n=new Date(m,p,q+f,r,s,t);break;case "1MON":case "1mon":case "1N":case "1n":f*=1;n=new Date(m,p+f,q,r,s,t);break;case "1Q":case "1q":case "3N":case "3n":f*=3;n=new Date(m,p+f,q,r,s,t);break;case "6MON":case "6mon":case "6N":case "6n":f*=6;n=new Date(m,p+f,q,r,s,t);break;case "1Y":case "1y":f*=1,n=new Date(m+f,p,q,r,s,t)}f=n.getFullYear().toString();m=("0"+(n.getMonth()+1).toString()).slice(-2);p=("0"+n.getDate().toString()).slice(-2);
q=("0"+n.getHours().toString()).slice(-2);r=("0"+n.getMinutes().toString()).slice(-2);n=("0"+n.getSeconds().toString()).slice(-2);n=f+"-"+m+"-"+p+" "+q+":"+r+":"+n;h.val(d.chart.formatDate(n));L[l]=n;a[l].xData=n;c.Refresh()}})}$(".inputprice").on("change",function(){var b=$(".inputprice").index(this);""!=$(this).val()&&$.isNumeric($(this).val())&&($(this).attr("prevvalue",$(this).val()),a[b].yData=$(this).val(),c.Refresh())});$(".inputprice").on("keydown",function(b){13==b.keyCode&&(b=$(".inputprice").index(this),
""!=$(this).val()&&$.isNumeric($(this).val())&&(a[b].yData=$(this).val(),c.Refresh()))});J()}function y(a,b){function c(a){$(a).find(".spectrum-color").each(function(){$(this).spectrum("destroy")})}function k(a){$(a).find(".ui-dialog-buttonset").prepend('<button class="chart-button adv-buttons eye-orange " type="button" title="" ></button>').on("click",function(){var a=$(".chart-ui-dialog.draw-dialog").css("opacity"),a=1==a?.5:1,b=1==a?"":2;$(".chart-ui-dialog.draw-dialog").css("opacity",a);$(this).css("opacity",
b)})}$('<div id="chart-dialog" title="'+b+'"></div>').insertAfter("body");var g="Close",h="";"undefined"!=typeof d.localizationobj&&(g=d.localizationobj.gui.returnLocalizationString("dialogs.common.button-close","Close"));"undefined"!=typeof d.init.TemplateName&&(h=d.init.TemplateName);var l="";"rtl"==d.localizationobj.gui.returnCurrentLanguage().direction&&(l="dir-rtl");$("#chart-dialog").dialog({dialogClass:"chart-ui-dialog draw-dialog "+h+" "+l,draggable:!0,autoOpen:!1,resizable:!1,closeOnEscape:!0,
width:"auto",modal:!0,open:function(a,b){k($(this).parent());"undefined"!=typeof d.localizationobj&&d.localizationobj.gui.updateFromDataLang($(this).parent());$(".ui-widget-overlay").bind("click",function(){$("#chart-dialog").dialog("close")});w()},close:function(a,b){c($(this).parent());$("#chart-dialog").remove();$("div.chart-ui-dialog.draw-dialog  adv-buttons.eye-orange").off().remove();$("div.chart-ui-dialog.draw-dialog").off().remove();$(this).off().empty().remove();return!1},buttons:[{id:"btn-dialogs-close",
text:g,click:function(){$(this).dialog("close")}}]})}function K(a,b,c){$(a).spectrum({color:b,showPalette:!0,showPaletteOnly:!1,clickoutFiresChange:!1,showButtons:!1,palette:["rgb(0, 0, 0);{rgb(66, 66, 66);{rgb(101, 101, 101);{rgb(152, 152, 152);{rgb(182, 182, 182);{rgb(203, 203, 203);{rgb(216, 216, 216);{rgb(238, 238, 238);{rgb(242, 242, 242);{rgb(255, 255, 255);".split("{"),"rgb(151, 0, 0);{rgb(255, 0, 0);{rgb(255, 152, 0);{rgb(255, 255, 0);{rgb(0, 255, 0);{rgb(0, 255, 255);{rgb(73, 133, 231);{rgb(0, 0, 255);{rgb(152, 0, 255);{rgb(255, 0, 255);".split("{"),
"rgb(230, 184, 175);{rgb(244, 204, 204);{rgb(252, 229, 205);{rgb(255, 242, 204);{rgb(217, 234, 211);{rgb(208, 224, 227);{rgb(201, 218, 248);{rgb(207, 226, 243);{rgb(217, 210, 233);{rgb(234, 209, 220);".split("{"),"rgb(221, 126, 107);{rgb(234, 153, 153);{rgb(249, 203, 156);{rgb(255, 229, 153);{rgb(182, 215, 168);{rgb(162, 196, 201);{rgb(164, 194, 244);{rgb(159, 197, 232);{rgb(180, 167, 214);{rgb(213, 166, 189);".split("{"),"rgb(204, 65, 37);{rgb(224, 102, 102);{rgb(246, 178, 107);{rgb(255, 217, 102);{rgb(147, 196, 125);{rgb(118, 165, 175);{rgb(109, 158, 235);{rgb(111, 168, 220);{rgb(142, 124, 195);{rgb(194, 123, 160);".split("{"),
"rgb(166, 28, 0);{rgb(204, 0, 0);{rgb(230, 145, 56);{rgb(241, 194, 50);{rgb(106, 168, 79);{rgb(69, 129, 142);{rgb(60, 120, 216);{rgb(61, 133, 198);{rgb(103, 78, 167);{rgb(166, 77, 121);".split("{"),"rgb(133, 32, 12);{rgb(153, 0, 0);{rgb(180, 95, 6);{rgb(191, 144, 0);{rgb(56, 118, 29);{rgb(19, 79, 92);{rgb(17, 85, 204);{rgb(11, 83, 148);{rgb(53, 28, 117);{rgb(116, 27, 71);".split("{"),"rgb(91, 15, 0);{rgb(102, 0, 0);{rgb(120, 63, 4);{rgb(127, 96, 0);{rgb(39, 78, 19);{rgb(12, 52, 61);{rgb(28, 69, 135);{rgb(7, 55, 99);{rgb(32, 18, 77);{rgb(76, 17, 48);".split("{")]})}
function A(){$(".properties-tabs").delegate("a","click",function(){var a=$(this).index();$(".main-properties").each(function(){$(this).css("display","none")});$(".properties-tabs-label").each(function(){$(this).removeClass("active")});$(".main-properties").eq(a).css("display","block");$(this).addClass("active")})}function J(){$(".chart-ui-dialog .onlynumeric").prochart_numeric()}function B(a,b,c,k,g,h){"undefined"==typeof g&&(g=1);"undefined"==typeof h&&(h=6);var l=d.commonutils.func.parseColorString(a.stroke),
l="rgb(%r%, %g%, %b%)".replace("%r%",l[0]).replace("%g%",l[1]).replace("%b%",l[2]);K($(c),l);c=a.strokeWidth;$(b).slider({min:g,max:h});$(b).slider("option","value",c);a=a.dashArray;repx=/px/g;"undefined"!=typeof a&&$(k).val(a)}function pa(a,b,c,k){var g=d.commonutils.func.parseColorString(a.fill),g="rgb(%r%, %g%, %b%)".replace("%r%",g[0]).replace("%g%",g[1]).replace("%b%",g[2]);K($(c),g,k+" div.gradient");$(k+" div.gradient").css("background-image","linear-gradient(to left, "+g+" 0%, transparent 100% )");
$(k).slider({min:0,max:100});g=a.fillOpacity;g*=100;$(k).slider("option","value",g);!0!=a.viewFill?($(b).prop("checked",!1),$(c).spectrum("disable"),$(k).slider("disable")):($(b).prop("checked",!0),$(c).spectrum("enable"),$(k).slider("enable"))}function C(a,b,d,k){$(d).on("change",function(){$(this).spectrum("get").toHexString();var a=$(this).spectrum("get").toRgb(),a="rgba(%r%, %g%, %b%, %a%)".replace("%r%",a.r).replace("%g%",a.g).replace("%b%",a.b).replace("%a%",1);c.MainLineStyle.stroke=a;c.MainLineStyle.strokeOpacity=
0;c.Refresh()});$(b).on("slidechange",function(){var b=$(this).slider("option","value");a.strokeWidth=b;c.Refresh()});$(k).on("change",function(){var a=$(this).val();c.MainLineStyle.dashArray=a;c.Refresh()})}function qa(a,b,e,k){$(e).on("change",function(){var b=$(this).spectrum("get").toHexString(),d=$(this).spectrum("get").toRgb();$(k+" div.gradient").css("background-image","linear-gradient(to left, "+b+" 0%, transparent 100% )");b="rgba(%r%, %g%, %b%, %a%)".replace("%r%",d.r).replace("%g%",d.g).replace("%b%",
d.b).replace("%a%",a.fillOpacity);a.fill=b;c.Refresh()});$(k).on("slide slidechange",function(){var b=$(this).slider("option","value")/100;c.MainLineStyle.fillOpacity=b;b=d.commonutils.func.parseColorString(c.MainLineStyle.fill);b="rgba(%r%, %g%, %b%, %a%)".replace("%r%",b[0]).replace("%g%",b[1]).replace("%b%",b[2]).replace("%a%",a.fillOpacity);c.MainLineStyle.fill=b;c.Refresh()});$(b).on("click",function(a){$(this).is(":checked")?($(k).slider("enable"),$(e).spectrum("enable"),$(e).trigger("change"),
c.MainLineStyle.viewFill=!0):($(k).slider("disable"),$(e).spectrum("disable"),c.MainLineStyle.viewFill=!1);c.Refresh()})}function sa(a,b,d){null!=a.Settings&&(!0!=a.Settings.ExtendLeft&&$(b).prop("checked",!1),!0!=a.Settings.ExtendRight&&$(d).prop("checked",!1));$(d).on("click",function(b){b=$(this).is(":checked");null==a.Settings&&(a.Settings={});c.Settings.ExtendRight=b;c.Refresh()});$(b).on("click",function(a){a=$(this).is(":checked");c.Settings.ExtendLeft=a;c.Refresh()})}function E(a,b){var d=
a.strokeWidth;$(b).slider({min:1,max:6});$(b).slider("option","value",d);$(b).on("slidechange",function(){var b=$(this).slider("option","value");a.strokeWidth=b;c.Refresh()})}function F(a,b,e){b=a.stroke;a=d.commonutils.func.parseColorString(a.stroke);"rgb(%r%, %g%, %b%)".replace("%r%",a[0]).replace("%g%",a[1]).replace("%b%",a[2]);K($(e),b);$(e).on("change",function(){var a=$(e).attr("levelindex"),b=$(this).spectrum("get").toHexString(),h=1;null!=c.LevelFillsStyle&&(h=d.commonutils.func.parseColorString(c.LevelFillsStyle["level"+
a].fill)[3]);var b=d.commonutils.func.parseColorString(b),l="rgba(%r%, %g%, %b% ,%o%)".replace("%r%",b[0]).replace("%g%",b[1]).replace("%b%",b[2]).replace("%o%",1);c.LevelsStyle["level"+a].stroke=l;h="rgba(%r%, %g%, %b%, %o%)".replace("%r%",b[0]).replace("%g%",b[1]).replace("%b%",b[2]).replace("%o%",h);null!=c.LevelFillsStyle&&(c.LevelFillsStyle["level"+a].fill=h);c.Refresh()})}function G(a,b){var d=a.dashArray;"undefined"!=typeof d&&$(b).val(d);$(b).on("change",function(){var a=$(b).attr("levelindex");
d=$(this).val();c.LevelsStyle["level"+a].dashArray=d;c.Refresh()})}function H(a,b,e){$(b).slider({min:0,max:100});$(b+" div.gradient").css("background-image","linear-gradient(to left, #000 0%, transparent 100% )");a=a.fillOpacity;"undefined"!=typeof a&&(a*=100,$(b).slider("option","value",a));$(b).on("slide slidechange",function(){var a=$(this).slider("option","value")/100;$(e).css("fill-opacity",a);for(var b=c.Levels.length,h=0;h<b;h++){var l=c.LevelFillsStyle["level"+h];"undefined"!=typeof l&&(l=
d.commonutils.func.parseColorString(l.fill),l="rgba(%r%, %g%, %b%, %o%)".replace("%r%",l[0]).replace("%g%",l[1]).replace("%b%",l[2]).replace("%o%",a),c.LevelFillsStyle["level"+h].fill=l)}c.MainLineStyle.fillOpacity=a;c.Refresh()})}function I(a,b){$(a).on("click",function(a){a=0;$(this).is(":checked")?($(b).slider("enable"),a=$(b).slider("option","value")/100,c.MainLineStyle.viewFill=!0):($(b).slider("disable"),a=0,c.MainLineStyle.viewFill=!1);for(var k=c.Levels.length,g=0;g<k;g++){var h=c.LevelFillsStyle["level"+
g];"undefined"!=typeof h&&(h=d.commonutils.func.parseColorString(h.fill),h="rgba(%r%, %g%, %b%, %o%)".replace("%r%",h[0]).replace("%g%",h[1]).replace("%b%",h[2]).replace("%o%",a),c.LevelFillsStyle["level"+g].fill=h)}c.Refresh()})}function w(){"undefined"!=typeof d.preloadobj&&d.preloadobj.endPreload()}function x(a,b){var c="",d=a.indexOf("<"+b+">"),g=("<"+b+">").length,h=a.indexOf("</"+b+">");-1!=d&&-1!=h&&h>d+g&&(c=a.substring(d+g,h));return c}var Y={},d=Ea,c=null,u="",L=[],Da=d.api.debug.getLogger("prochart.gui.draw");
d.drawobj=Y;Y.gui={initPattern:function(){var a=$.Deferred(),b=!1==d.guiinit.cache?"?"+d.version.gui.name+(new Date).getTime():"?"+d.version.gui.name,b=d.guiinit.rootpath+"/ChartUI/gui/draw/draw.patterns.htm"+b;if(d.navigator.XMLHttpRequest()){var c=new XMLHttpRequest;c.open("get",b);c.onload=function(){var b=c.responseText;Z(b);Da.debug("readDraw Pattern");a.resolve(b)};c.send()}else $.ajax({type:"GET",async:!0,dataType:"html",url:b}).done(function(b){Z(b);Da.debug("readDraw Pattern");a.resolve(b)});
return a.promise()},openDialog:aa,drawShape:ba,drawTimezone:ca,drawCircleLine:da,drawSquare:ea,drawFibo:fa,drawFiboArc:ga,drawFork:ha,drawLinereg:ia,drawLine:ja,drawParallel:ka,drawText:la,drawVHLine:ma};v=W=V=X=U=T=S=R=Q=P=O=N=M=null;d.chart.UI.funcOnShapeDblClicked=aa;return Y};
