function ProChart_InitToolbarAdv(ka){var G,H,I,J,K,L,M,N,O,x,P,Q,D,R,S;function W(a){r(a,"toolbar_container");G=r(a,"toolbar_toolbar");H=r(a,"toolbar-button-timeframe");I=r(a,"toolbar-button-timeframe-text");J=r(a,"toolbar-space");K=r(a,"toolbar-button-charttype");L=r(a,"toolbar-caption");M=r(a,"toolbar-button");N=r(a,"toolbar-button-custom");O=r(a,"toolbar-more");x=r(a,"toolbar-more-item");P=r(a,"toolbar-button-group");Q=r(a,"toolbar-item");D=r(a,"toolbar-item-noicon");R=r(a,"toolbar-more-item-timeframe-text");
r(a,"toolbar-button-group-timeframe-text");S=r(a,"toolbar-button-group-text")}function la(){"undefined"!=typeof m.chart.TimeFrame&&(m.chart.TimeFrame.toUpperCase(),m.chart.TimeFrame.toLowerCase());for(var a=m.currenlayout.toolbars,b=0;b<a.length;b++){var c=a[b],d=m.commonutils.func.returnShortUniqID(),h="",k="";c.guiid=d;"undefined"!=typeof c.location&&(h=h+" loc-"+c.location);k=d;"undefined"!=typeof c.id&&(k=c.id);var l="";"undefined"!=typeof c.style&&(l=c.style);var d=G.replace(B,"").replace(/%style%/g,
l).replace(/%css%/g,h).replace(/%tid%/g,k).replace(/%id%/g,d),h=O,e="",k="";"undefined"!=typeof c.more.closebyclick&&!0==c.more.closebyclick&&(k=" tlb-more-a-closebyclick");l="a-bottom";"undefined"!=typeof c.more.possition&&(l="a-"+c.more.possition);h=h.replace(/%css-more-items%/g," "+l);for(l=0;l<c.items.length;l++)switch(e=c.items[l],T.debug(e.type),e.type){case "button-group-charttype":e=X(void 0,k,e);d=d.replace(/%html%/g,e.toolbar+"%html%");h=h.replace(/%html%/g,e.toolbarmore+"%html%");break;
case "button-group-indicator":e=Y(void 0,k,e);d=d.replace(/%html%/g,e.toolbar+"%html%");h=h.replace(/%html%/g,e.toolbarmore+"%html%");break;case "button-group-timeframe":e=Z(void 0,k,e);d=d.replace(/%html%/g,e.toolbar+"%html%");h=h.replace(/%html%/g,e.toolbarmore+"%html%");break;case "caption":e=aa(e);d=d.replace(/%html%/g,e+"%html%");break;case "space":e=ba(e);d=d.replace(/%html%/g,e+"%html%");break;case "button":e=ca(e,void 0,k);d=d.replace(/%html%/g,e.button+"%html%");h=h.replace(/%html%/g,e.buttonmore+
"%html%");break;case "button-custom":e=ma(e,void 0,k);d=d.replace(/%html%/g,e.button+"%html%");h=h.replace(/%html%/g,e.buttonmore+"%html%");break;case "item":e=da(e,void 0,k);d=d.replace(/%html%/g,e.button+"%html%");h=h.replace(/%html%/g,e.buttonmore+"%html%");break;case "button-group":e=ea(e),d=d.replace(/%html%/g,e.toolbargroup+"%html%"),h=h.replace(/%html%/g,e.toolbarmore+"%html%")}var h=h.replace(/%html%/g,""),d=d.replace(/\n|\r/g,"").replace(/%html%/g,h),f=$(p.parent).find("#"+c.parent);f.append(d)}null==
g("$parent")&&u("$parent",$(p.parent));f=g("$parent");f.find("button.change-typechart").on("click",function(){var a=$(this).attr("tid");null==g("$parent .change-typechart")&&u("$parent .change-typechart",g("$parent").find(".change-typechart"));g("$parent .change-typechart").removeClass("button-selected");"undefined"!=typeof m.chart.ChangePriceType&&(m.chart.ChangePriceType(a),!0==m.bi.status&&m.bi.addt2BI("change price type: "+a));$(this).hasClass("tlb-a-closebyclick")&&E($(this));$(this).hasClass("tlb-more-a-closebyclick")&&
C($(this));$(this).hasClass("tlb-a-changeicongroup")&&F($(this));$(this).addClass("button-selected");return!1});f.find("button.change-timeframe").on("click",function(){var a=$(this).attr("tid");null==g("$parent .change-timeframe")&&u("$parent .change-timeframe",g("$parent").find(".change-timeframe"));g("$parent .change-timeframe").removeClass("button-selected");"undefined"!=typeof m.chart.ChangeTimeScale&&(m.chart.ChangeTimeScale(a),!0==m.bi.status&&m.bi.addt2BI("change timescale: "+a));$(this).hasClass("tlb-a-closebyclick")&&
E($(this));$(this).hasClass("tlb-more-a-closebyclick")&&C($(this));$(this).hasClass("tlb-a-changeicongroup")&&F($(this));$(this).addClass("button-selected");return!1});f.find("button.button-action").on("click",function(){var a=$(this).attr("tid");if("undefined"!=typeof a&&"undefined"!=typeof m.actions){var b=$(this).attr("action");"undefined"!=typeof b&&""!=b?m.actions.action(b,a):m.actions.action(a);$(this).hasClass("tlb-a-closebyclick")&&E($(this));$(this).hasClass("tlb-more-a-closebyclick")&&C($(this));
$(this).hasClass("tlb-a-changeicongroup")&&F($(this))}return!1});f.find("button.button-action-custom").on("click",function(){var a=$(this).attr("tid");if("undefined"!=typeof a&&"undefined"!=typeof m.actions){if(typeof m.events.toolbar.onCustomButtonClick==typeof Function)m.events.toolbar.onCustomButtonClick(a);$(this).hasClass("tlb-a-closebyclick")&&E($(this));$(this).hasClass("tlb-more-a-closebyclick")&&C($(this));$(this).hasClass("tlb-a-changeicongroup")&&F($(this))}return!1});f.find("button.button-more").on("click",
function(){"none"==$(this).parent().find(".tlb-more-items").css("display")?(f.find(".tlb-button-groups").css("display","none"),f.find(".tlb-more-items").css("display","none"),fa($(this)),"undefined"!=typeof m.menuobj&&m.menuobj.gui.hidemenus()):C($(this))});f.find("button.button-group").on("click",function(){"none"==$(this).parent().find(">.tlb-button-groups").css("display")?($(this).parent().find(">.tlb-button-groups").css("visibility","hidden").css("display","block"),f.find(">.tlb-button-groups").css("display",
"none"),f.find(".tlb-more-items").css("display","none"),1>=$(this).parents(".tlb-item-group").length&&f.find(".tlb-button-groups").css("display","none"),$(this).closest("ul").find("li >.tlb-button-groups").css("display","none"),$(m.toolbaradvobj.parent).find(".highlightedIconGroup").removeClass("highlightedIconGroup"),$(this).parents(".tlb-item-group").each(function(){$(this).find(">.button-group").addClass("highlightedIconGroup")}),ga($(this).parent()),"undefined"!=typeof m.menuobj&&m.menuobj.gui.hidemenus()):
ha($(this).parent());"undefined"!=typeof m.menuobj&&m.menuobj.gui.hidemenus()});z()}function Y(a,b,c){var d=c="",h="";"undefined"!=typeof a&&(h=a);a="";"undefined"!=typeof b&&(a=b);b=m.init.indicators;for(var k=0;k<b.length;k++){var l=b[k],e=D.replace(/%id%/g,l.id).replace(/%localization%/g,l.localize).replace(/%css%/g,"undefined"!=typeof l.css?l.css+h:h).replace(/%icon%/g,"undefined"!=typeof l.icon?l.icon:"").replace(/%action%/g,"undefined"!=typeof l.action?l.action:"add-indicator").replace(/%caption%/g,
l.d);c+=e;l=x.replace(/%id%/g,l.id).replace(/%localization%/g,l.localize).replace(/%css%/g,"undefined"!=typeof l.css?l.css+" button-action "+a:" button-action "+a).replace(/%icon%/g,"undefined"!=typeof l.icon&&""!=l.icon?l.icon:"no-icon").replace(/%caption%/g,l.caption);d+=l}return{toolbar:c,toolbarmore:d}}function X(a,b,c){var d=c="",h="";"undefined"!=typeof m.chart.PriceChartType&&(h=m.chart.PriceChartType);var k="";"undefined"!=typeof a&&(k=a);a="";"undefined"!=typeof b&&(a=b);b=m.init.charttype;
for(var l=0;l<b.length;l++){var e=b[l],f=K.replace(B,"").replace(/%id%/g,e.id).replace(/%css%/g,"undefined"!=typeof e.css?e.css+k:k).replace(/%icon%/g,e.id).replace(/%caption%/g,e.n).replace(/%hide%/g,1==e.f?"":"hideobj").replace(/%selected%/g,null==h||e.id!=h?"":"button-selected");c+=f;f=x.replace(B,"").replace(/%id%/g,e.id).replace(/%css%/g,("undefined"!=typeof e.css?e.css+a:a)+"  change-typechart "+(1==e.f?"":"hideobj")).replace(/%icon%/g,e.id).replace(/%caption%/g,e.n).replace(/%localization%/g,
"menu.charttype."+e.id).replace(/%selected%/g,null==h||e.id!=h?"":"button-selected");d+=f}return{toolbar:c,toolbarmore:d}}function Z(a,b,c){var d="",h="",k="",l="",e="";"undefined"!=typeof a&&(e=a);a="";"undefined"!=typeof b&&(a=b);"undefined"!=typeof m.chart.TimeFrame&&(k=m.chart.TimeFrame.toUpperCase(),l=m.chart.TimeFrame.toLowerCase());b=!1;"undefined"!=typeof c&&"undefined"!=typeof c.captionview&&(b=c.captionview,e+=" onlycaption-view onlycaption-timeframe");var f=!1;"undefined"!=typeof c&&"undefined"!=
typeof c.viewall&&(f=c.viewall);c=m.init.timeframe;for(var U=0;U<c.length;U++){var n=c[U],g="",s=m.api.timeframes.getTimeframeView();switch(s){case "icon":g=H.replace(/%id%/g,n.id).replace(/%caption%/g,n.n).replace(/%icon%/g,ia(n.id)).replace(/%hide%/g,1==n.f||!0==f?"":"hideobj").replace(/%css%/g,"undefined"==typeof n.css?e:n.css+e).replace(/%selected%/g,n.id==k||n.id==l?"button-selected":"");break;case "text":g=I.replace(/%id%/g,n.id).replace(/%caption%/g,n.n).replace(/%caption2%/g,!0==b?n.n:"").replace(/%title1%/g,
!0==b?"":n.t1).replace(/%title2%/g,!0==b?"":n.t2).replace(/%hide%/g,1==n.f||!0==f?"":"hideobj").replace(/%css%/g,"undefined"==typeof n.css?e:n.css+e).replace(/%selected%/g,n.id==k||n.id==l?"button-selected":"")}d+=g;switch(s){case "icon":g=x.replace(/%id%/g,n.id).replace(/%caption%/g,n.n).replace(/%localization%/g,"menu.timescale."+n.id).replace(/%css%/g," change-timeframe "+(1==n.f?"":"hideobj")).replace(/%css%/g,"undefined"==typeof n.css?a:n.css+a).replace(/%icon%/g,ia(n.id)).replace(/%selected%/g,
n.id==k||n.id==l?"button-selected":"");break;case "text":g=R.replace(/%id%/g,n.id).replace(/%caption%/g,n.n).replace(/%localization%/g,"menu.timescale."+n.id).replace(/%title1%/g,n.t1).replace(/%title2%/g,n.t2).replace(/%css%/g," change-timeframe "+(1==n.f?"":"hideobj")).replace(/%css%/g,"undefined"==typeof n.css?a:n.css+a).replace(/%selected%/g,n.id==k||n.id==l?"button-selected":"")}h+=g}return{toolbar:d,toolbarmore:h}}function ca(a,b,c){var d="";"undefined"!=typeof b&&(d=b);b="";"undefined"!=typeof c&&
(b=c);c=M.replace(/%id%/g,a.id).replace(/%localization%/g,a.localize).replace(/%css%/g,"undefined"!=typeof a.css?a.css+d:d).replace(/%icon%/g,"undefined"!=typeof a.icon?a.icon:"").replace(/%caption%/g,a.caption);a=x.replace(/%id%/g,a.id).replace(/%localization%/g,a.localize).replace(/%css%/g,"undefined"!=typeof a.css?a.css+" button-action "+b:" button-action"+b).replace(/%icon%/g,"undefined"!=typeof a.icon?a.icon:"").replace(/%caption%/g,a.caption);return{button:c,buttonmore:a}}function ma(a,b,c){var d=
"";"undefined"!=typeof b&&(d=b);b="";"undefined"!=typeof c&&(b=c);c=N.replace(/%id%/g,a.id).replace(/%localization%/g,a.localize).replace(/%css%/g,"undefined"!=typeof a.css?a.css+d:d).replace(/%icon%/g,"undefined"!=typeof a.icon?a.icon:"").replace(/%caption%/g,a.caption);a=x.replace(/%id%/g,a.id).replace(/%localization%/g,a.localize).replace(/%css%/g,"undefined"!=typeof a.css?a.css+" button-action-custom "+b:" button-action-custom"+b).replace(/%icon%/g,"undefined"!=typeof a.icon?a.icon:"").replace(/%caption%/g,
a.caption);return{button:c,buttonmore:a}}function da(a,b,c){var d="";"undefined"!=typeof b&&(d=b);b="";"undefined"!=typeof c&&(b=c);c=Q;"undefined"!=typeof a.icon&&""==a.icon&&(c=D);d=c.replace(/%id%/g,a.id).replace(/%localization%/g,a.localize).replace(/%css%/g,"undefined"!=typeof a.css?a.css+d:d).replace(/%icon%/g,"undefined"!=typeof a.icon?a.icon:"").replace(/%action%/g,"undefined"!=typeof a.action?a.action:"").replace(/%caption%/g,a.caption);a=x.replace(/%id%/g,a.id).replace(/%localization%/g,
a.localize).replace(/%css%/g,"undefined"!=typeof a.css?a.css+" button-action "+b:" button-action "+b).replace(/%icon%/g,"undefined"!=typeof a.icon&&""!=a.icon?a.icon:"no-icon").replace(/%caption%/g,a.caption);return{button:d,buttonmore:a}}function ba(a){var b="";"undefined"!=typeof a.location&&(b=b+" loc-"+a.location);return J.replace(/%id%/g,"undefined"!=typeof a.id?a.id:"").replace(/%csstlb%/g,b).replace(/%css%/g,"undefined"!=typeof a.css?a.css:"").replace(/%caption%/g,"undefined"!=typeof a.caption?
a.caption:"")}function aa(a){return L.replace(/%id%/g,a.id).replace(/%localization%/g,a.localize).replace(/%css%/g,"undefined"!=typeof a.css?a.css:"").replace(/%icon%/g,"undefined"!=typeof a.icon?a.icon:"").replace(/%caption%/g,a.caption)}function ea(a){var b="",b="%html%",c="a-top";switch(a.group.possition){case "top":c="a-top";break;case "bottom":c="a-bottom";break;case "left":c="a-left";break;case "right":c="a-right"}var d="a-menu";switch(a.group.type){case "menu":d="a-menu";break;case "tooltip":d=
"a-tooltip"}var h="";"undefined"!=typeof a.group.closebyclick&&!0==a.group.closebyclick&&(h+=" tlb-a-closebyclick");"undefined"!=typeof a.group.changegroupicon&&!0==a.group.changegroupicon&&(h+=" tlb-a-changeicongroup");var k="";"undefined"!=typeof a.css&&(k=a.css);"undefined"!=typeof a.group.grouptype&&(k=k+" group-button-"+a.group.grouptype);A.push({id:a.id,group:a.group});var l="icon";"undefined"!=typeof a.group.viewtype&&(l=a.group.viewtype);var e="";"undefined"!=typeof a.style&&(e=a.style);"undefined"!=
typeof a&&"undefined"!=typeof a.captionview&&(k+=" onlycaption-view");m.api.timeframes.getTimeframeView();var f="";switch(l){case "icon":f=P.replace(B,"").replace(/%localization%/g,a.localize).replace(/%css%/g,k).replace(/%style%/g,e).replace(/%icon%/g,"undefined"!=typeof a.icon?a.icon:"").replace(/%cssgroup%/g,a.group.css+""+c+" "+d).replace(/%caption%/g,a.caption).replace(/%id%/g,a.id);break;case "text":f=S.replace(B,"").replace(/%localization%/g,a.localize).replace(/%css%/g,k).replace(/%style%/g,
e).replace(/%title1%/g,"undefined"!=typeof a.title1?a.title1:"").replace(/%title2%/g,"undefined"!=typeof a.title2?a.title2:"").replace(/%cssgroup%/g,a.group.css+""+c+" "+d).replace(/%caption%/g,a.caption).replace(/%id%/g,a.id)}for(c=0;c<a.items.length;c++)switch(d=a.items[c],k="",d.type){case "button-group-charttype":k=X(h,void 0,d);f=f.replace(/%html%/g,k.toolbar+"%html%");b=b.replace(/%html%/g,k.toolbarmore+"%html%");break;case "button-group-indicator":k=Y(h,void 0,d);f=f.replace(/%html%/g,k.toolbar+
"%html%");b=b.replace(/%html%/g,k.toolbarmore+"%html%");break;case "item":k=da(d,h,void 0);f=f.replace(/%html%/g,k.button+"%html%");b=b.replace(/%html%/g,k.buttonmore+"%html%");break;case "button-group-timeframe":k=Z(h,void 0,d);f=f.replace(/%html%/g,k.toolbar+"%html%");b=b.replace(/%html%/g,k.toolbarmore+"%html%");break;case "caption":d=aa(d);f=f.replace(/%html%/g,d+"%html%");break;case "space":d=ba(d);f=f.replace(/%html%/g,d+"%html%");break;case "button":k=ca(d,h);f=f.replace(/%html%/g,k.button+
"%html%");b=b.replace(/%html%/g,k.buttonmore+"%html%");break;case "button-group":k=ea(d),f=f.replace(/%html%/g,k.toolbargroup+"%html%"),b=b.replace(/%html%/g,k.toolbarmore+"%html%")}f=f.replace(/%html%/g,"");b=b.replace(/%html%/g,"");return{toolbargroup:f,toolbarmore:b}}function na(){$(p.parent).find(".toolbar-adv .tlb-item-group").each(function(){var a=$(this);"block"==a.find(".tlb-button-groups").css("display")&&ga(a)})}function oa(){$(p.parent).find(".toolbar-adv .tlb-more").each(function(){var a=
$(this),b=$(this).find("button.button-more");"block"==a.find(".tlb-more-items").css("display")&&fa(b)})}function ga(a){var b=a.find(">.button-group"),c=$(b).attr("tid");!0!=$(b).hasClass("highlightedIconGroup")&&$(b).addClass("highlightedIconGroup");for(var b=null,d=0;d<A.length;d++)if(A[d].id==c){b=A[d].group;break}if(null!=b)switch(b.type){case "menu":pa(a,b);break;case "tooltip":qa(a,b)}}function ha(a){var b=a.find(">.button-group"),c=$(b).attr("tid");$(b).removeClass("highlightedIconGroup");a.find(".highlightedIconGroup").removeClass("highlightedIconGroup");
for(var b=null,d=0;d<A.length;d++)if(A[d].id==c){b=A[d].group;break}if(null!=b)switch(b.type){case "menu":ra(a,b);break;case "tooltip":sa(a,b)}}function E(a){a=a.closest(".tlb-item-group");ha(a)}function F(a){var b=a.closest(".tlb-item-group").find("> .button-group"),c=a.attr("data-localize"),d=a.attr("title");a.find(">span").attr("class");b.attr("data-localize",c).attr("title",d);b.html(a.html())}function qa(a,b){var c=a.find(">.tlb-button-groups"),d=c.find(" > ul"),h=c.find(">.tlb-array"),k=a.find(">.button-group");
c.css("visibility","hidden").css("display","block");var l=a.closest(".htmlchart"),e=0,f=0,g=2,n=0,m=0,s=0,f=1,y="",p;"undefined"!=typeof b.spacey&&(g=b.spacey);"undefined"!=typeof b.columns&&(f=b.columns);m=k.outerWidth(!0);n=k.outerHeight(!0);s=parseInt(h.css("border-bottom-width"),10);y=k.offset().left-l.offset().left;p=l.outerWidth()-y;var k=k.offset().top-l.offset().top,l=l.outerHeight()-k,w=0;c.find(">ul").children().each(function(){w<$(this).outerWidth(!0)&&(w=$(this).outerWidth(!0));e+=$(this).outerWidth(!0)});
c.find(">ul").children();0!=f&&(e=w*f);var f=c.outerHeight(),t={};t.width=e+"px";switch(b.possition){case "bottom":t.top=n+g+"px";t.bottom="auto";break;case "top":t.top="auto";t.bottom=n+g+"px";break;case "right":t.right="auto";t.left=m+g+"px";t.top="0px";t.bottom="auto";break;case "left":t.right=m+g+"px",t.left="auto",t.top="0px",t.bottom="auto"}c.css(t);d.css({width:t.width});"undefined"==typeof b.alignh&&(b.alignh="auto");"undefined"==typeof b.alignv&&(b.alignv="auto");d={};g={};if("top"==b.possition||
"bottom"==b.possition)switch(y="auto"==b.alignh?y>e/2&&p>e/2?"center":y>e?"left":p>e?"right":"left":b.alignh,y){case "left":d.right="0px";d.left="auto";g.right="5px";g.left="auto";c.css(d);h.css(g);break;case "right":d.left="0px";d.right="auto";g.left="5px";g.right="auto";c.css(d);h.css(g);break;case "center":d.right=-(e/2-m/2)+"px",d.left="auto",g.left=e/2-s+"px",g.right="auto",c.css(d),h.css(g)}if("left"==b.possition||"right"==b.possition)switch(f=c.outerHeight(),y="auto"==b.alignv?k>f/2&&l>f/2?
"center":k>f?"top":l>f?"bottom":"top":b.alignv,y){case "top":d.bottom="auto";d.top="0px";g.top="5px";g.bottom="auto";c.css(d);h.css(g);break;case "bottom":d.top="auto";d.bottom="0px";g.bottom="5px";g.top="auto";c.css(d);h.css(g);break;case "center":d.top=-(f/2-n/2)+"px",d.bottom="auto",g.top=f/2-s+"px",g.bottom="auto",c.css(d),h.css(g)}h={opacity:1};c.css("display","none").css("opacity",0).css("visibility","");switch(b.possition){case "top":c.css({bottom:"15px",top:"auto"});h.bottom=t.bottom;break;
case "bottom":c.css({top:"15px",bottom:"auto"});h.top=t.top;break;case "right":c.css({left:"15px",right:"auto"});h.left=t.left;break;case "left":c.css({right:"15px",left:"auto"}),h.right=t.right}c.show().animate(h,200)}function sa(a,b){var c=a.find(">.tlb-button-groups"),d={opacity:0};switch(b.possition){case "top":d.bottom="15";break;case "bottom":d.top="15";break;case "right":d.left=15;break;case "left":d.right=15}c.animate(d,200,function(){c.css("display","none")})}function ra(a,b){var c=a.find(">.tlb-button-groups"),
d={opacity:0};switch(b.possition){case "top":d.bottom="15";break;case "bottom":d.top="15";break;case "right":d.left=15;break;case "left":d.right=15}c.animate(d,200,function(){c.css("display","none")})}function pa(a,b){var c=a.find(">.tlb-button-groups"),d=c.find(">.tlb-array"),h=a.find(">.button-group");c.css("visibility","hidden").css("display","block");var k=a.closest(".htmlchart"),l=0,e=0,f=2,g=0,n=e=0,m=0,l=1,s="",p;"undefined"!=typeof b.spacey&&(f=b.spacey);"undefined"!=typeof b.columns&&(l=
b.columns);e=h.outerWidth();g=h.outerHeight();n=parseInt(d.css("border-bottom-width"),10);s=h.offset().left-k.offset().left;p=k.outerWidth()-s;var h=h.offset().top-k.offset().top,k=k.outerHeight()-h,r=0,w=0,t=0,u=0;c.find("ul button ").each(function(){$(this).css({width:"auto","min-width":0});w=$(this).outerWidth();t=$(this).outerWidth(!0);w>r&&(r=w,u=t)});m=r;l*=u;c.css("width",l);var q={};switch(b.possition){case "bottom":q.top=g+f+"px";q.bottom="auto";break;case "top":q.top="auto";q.bottom=g+f+
"px";break;case "right":q.right="auto";q.left=e+f+"px";q.top="0px";q.bottom="auto";break;case "left":q.right=e+f+"px",q.left="auto",q.top="0px",q.bottom="auto"}c.css(q);"undefined"==typeof b.alignh&&(b.alignh="auto");"undefined"==typeof b.alignv&&(b.alignv="auto");var f={},v={};if("top"==b.possition||"bottom"==b.possition)switch(s="auto"==b.alignh?s+e/2>l/2&&p+e/2>l/2?"center":s+e/2>l?"left":p+e/2>l?"right":"center":b.alignh,s){case "left":f.right="0px";f.left="auto";v.right="5px";v.left="auto";c.css(f);
d.css(v);break;case "right":f.left="0px";f.right="auto";v.left="5px";v.right="auto";c.css(f);d.css(v);break;case "center":f.right=-(l/2-e/2)+"px",f.left="auto",v.left=l/2-n+"px",v.right="auto",c.css(f),d.css(v)}if("left"==b.possition||"right"==b.possition)switch(e=c.outerHeight(),s="auto"==b.alignv?h>e/2&&k>e/2?"center":h>e?"top":k>e?"bottom":"top":b.alignv,s){case "top":f.bottom="auto";f.top="0px";v.top="5px";v.bottom="auto";c.css(f);d.css(v);break;case "bottom":f.top="auto";f.bottom="0px";v.bottom=
"5px";v.top="auto";c.css(f);d.css(v);break;case "center":f.top=-(e/2-g/2)+"px",f.bottom="auto",v.top=e/2-n+"px",v.bottom="auto",c.css(f),d.css(v)}c.find("button").css("width",m);d={opacity:1};c.css("display","none").css("opacity",0).css("visibility","");switch(b.possition){case "top":c.css({bottom:"15px",top:"auto"});d.bottom=q.bottom;break;case "bottom":c.css({top:"15px",bottom:"auto"});d.top=q.top;break;case "right":c.css({left:"15px",right:"auto"});d.left=q.left;break;case "left":c.css({right:"15px",
left:"auto"}),d.right=q.right}c.show().animate(d,200)}function fa(a){var b=a.closest(".toolbar-adv"),c=b.attr("tid"),c=V(c).more,d=b.find(".tlb-more-items");d.css("visibility","hidden").css("display","block");var h=b.closest(".htmlchart"),b=d.find(".tlb-array"),k=0,l=0,e=2,f=2,g=0,n=l=0,m=0,k=1,s="",p;"undefined"!=typeof c.spacey&&(e=c.spacey);"undefined"!=typeof c.spacex&&(f=c.spacex);"undefined"!=typeof c.columns&&(k=c.columns);l=a.outerWidth();g=a.outerHeight();n=parseInt(b.css("border-bottom-width"),
10);s=a.offset().left-h.offset().left;p=h.outerWidth()-s;a=a.offset().top-h.offset().top;var h=h.outerHeight()-a,r=0,w=0,t=0,u=0;d.find("ul button ").each(function(){$(this).css({width:"auto","min-width":0});w=$(this).outerWidth();t=$(this).outerWidth(!0);w>r&&(r=w,u=t)});m=r;k*=u;d.css("width",k);var q={};"undefined"==typeof c.possition&&(c.possition="bottom");switch(c.possition){case "bottom":q.top=g+e+"px";q.bottom="auto";break;case "top":q.top="auto";q.bottom=g+e+"px";break;case "right":q.right=
"auto";q.left=l+f+"px";q.top="0px";q.bottom="auto";break;case "left":q.right=l+f+"px",q.left="auto",q.top="0px",q.bottom="auto"}d.css(q);"undefined"==typeof c.alignh&&(c.alignh="auto");"undefined"==typeof c.alignv&&(c.alignv="auto");e={};f={};if("top"==c.possition||"bottom"==c.possition)switch(s="auto"==c.alignh?s>k/2&&p>k/2?"center":s>k?"left":p>k?"right":"left":c.alignh,s){case "left":e.right="0px";e.left="auto";f.right="5px";f.left="auto";d.css(e);b.css(f);break;case "right":e.left="0px";e.right=
"auto";f.left="5px";f.right="auto";d.css(e);b.css(f);break;case "center":e.right=-(k/2-l/2)+"px",e.left="auto",f.left=k/2-n+"px",f.right="auto",d.css(e),b.css(f)}if("left"==c.possition||"right"==c.possition)switch(l=d.outerHeight(),s="auto"==c.alignv?a>l/2&&h>l/2?"center":a>l?"top":h>l?"bottom":"top":c.alignv,s){case "top":e.bottom="auto";e.top="0px";f.top="5px";f.bottom="auto";d.css(e);b.css(f);break;case "bottom":e.top="auto";e.bottom="0px";f.bottom="5px";f.top="auto";d.css(e);b.css(f);break;case "center":e.top=
-(l/2-g/2)+"px",e.bottom="auto",f.top=l/2-n+"px",f.bottom="auto",d.css(e),b.css(f)}d.find(" >ul").css({width:k});d.find(" >ul >li").css({width:m,overflow:"hidden"});d.find("button").css({width:m});b={opacity:1};d.css("display","none").css("opacity",0).css("visibility","");switch(c.possition){case "top":d.css({bottom:"15px",top:"auto"});b.bottom=q.bottom;break;case "bottom":d.css({top:"15px",bottom:"auto"});b.top=q.top;break;case "right":d.css({left:"15px",right:"auto"});b.left=q.left;break;case "left":d.css({right:"15px",
left:"auto"}),b.right=q.right}d.show().animate(b,200)}function C(a){a=a.closest(".toolbar-adv");var b=a.attr("tid"),b=V(b).more,c=a.find(".tlb-more-items");"undefined"==typeof b.possition&&(b.possition="bottom");a={opacity:0};switch(b.possition){case "top":a.bottom="15";break;case "bottom":a.top="15";break;case "right":a.left=15;break;case "left":a.right=15}c.animate(a,200,function(){c.css("display","none")})}function ta(a,b){$(p.parent).find(".toolbar-adv").each(function(){"rtl"==b?$(this).hasClass("dir-rtl")||
$(this).addClass("dir-rtl"):$(this).removeClass("dir-rtl")})}function z(){$(p.parent).find(".toolbar-adv").each(function(){var a=$(this),b=a.attr("tid"),b=V(b);if(null!=b)switch(b.location){case "vertical":ua(a,b);break;case "horizontal":ja(a,b);break;default:ja(a,b)}})}function ja(a,b){var c=a.outerWidth();if("undefined"==typeof c||null==c)c=a.width();a.css("width");var d=0,h=0,k=b.more,l=!1,e=m.apiinit.fn.get("toolbar","iconMoreSizeWidth");a.find("> .tlb-item, > .tlb-caption, > .tlb-space").each(function(){h+=
$(this).outerWidth(!0)});h>c&&!1==k.captionview?a.find("> .tlb-caption").addClass("hide-tlb-item"):a.find("> .tlb-caption").removeClass("hide-tlb-item");h>c&&!1==k.spaceview?a.find("> .tlb-space").addClass("hide-tlb-item"):a.find("> .tlb-space").removeClass("hide-tlb-item");h>c&&(l=!0);a.find("> .tlb-item, > .tlb-caption, > .tlb-space").each(function(){$(this).hasClass("tlb-caption")&&(h>c&&!1==k.captionview?$(this).addClass("hide-tlb-item"):(d+=$(this).outerWidth(!0),l&&d>c-e?$(this).addClass("hide-tlb-item"):
$(this).removeClass("hide-tlb-item")));$(this).hasClass("tlb-space")&&(h>c&&!1==k.spaceview?$(this).addClass("hide-tlb-item"):(d+=$(this).outerWidth(!0),l&&d>c-e?$(this).addClass("hide-tlb-item"):$(this).removeClass("hide-tlb-item")));if($(this).hasClass("tlb-item"))if(d+=$(this).outerWidth(!0),l&&d>c-e){$(this).addClass("hide-tlb-item");var b=$(this).find("button").attr("tid");a.find(".tlb-more-item button[tid^='"+b+"']").parent().removeClass("hide-more-item")}else $(this).removeClass("hide-tlb-item"),
b=$(this).find("button").attr("tid"),a.find(".tlb-more-item button[tid^='"+b+"']").parent().addClass("hide-more-item")});l&&d>c-e?a.find(".tlb-more").css("display","block"):a.find(".tlb-more").css("display","none")}function ua(a,b){function c(b){$(b).addClass("hide-tlb-item");var c=$(b).find("button").attr("tid");a.find(".tlb-more-item button[tid^='"+c+"']").parent().removeClass("hide-more-item");$(b).hasClass("tlb-item-group")&&h(b)}function d(b){$(b).removeClass("hide-tlb-item");var c=$(b).find("button").attr("tid");
a.find(".tlb-more-item button[tid^='"+c+"']").parent().addClass("hide-more-item");$(b).hasClass("tlb-item-group")&&k(b)}function h(b){$(b).find(".tlb-item").each(function(){var b=$(this).find("button").attr("tid");a.find(".tlb-more-item button[tid^='"+b+"']").parent().removeClass("hide-more-item")})}function k(b){$(b).find(".tlb-item").each(function(){var b=$(this).find("button").attr("tid");a.find(".tlb-more-item button[tid^='"+b+"']").parent().addClass("hide-more-item")})}var l=a.parent().outerWidth(),
e=a.parent().outerHeight();if("undefined"==typeof l||null==l)l=a.width();if("undefined"==typeof e||null==e)e=a.height();var f=0,g=0,n=0,p=null,s=0,r=b.more,u=m.apiinit.fn.get("toolbar","iconMoreSizeWidth");a.find("> .tlb-item, > .tlb-caption, > .tlb-space").each(function(){f+=$(this).outerHeight(!0);g+=$(this).outerWidth(!0);g>l&&(g=0)});g=0;f>e&&!1==r.captionview?a.find("> .tlb-caption").addClass("hide-tlb-item"):a.find("> .tlb-caption").removeClass("hide-tlb-item");f>e&&!1==r.spaceview?a.find("> .tlb-space").addClass("hide-tlb-item"):
a.find("> .tlb-space").removeClass("hide-tlb-item");a.find("> .tlb-item, > .tlb-caption, > .tlb-space").each(function(){$(this).hasClass("tlb-caption")&&(f>e&&!1==r.captionview?$(this).addClass("hide-tlb-item"):(n+=$(this).outerHeight(!0),g=0,$(this).removeClass("hide-tlb-item").css("width",l)));$(this).hasClass("tlb-space")&&($(this).hasClass("loc-horizontal")?!1==r.spaceview?$(this).addClass("hide-tlb-item").css("width",l):(n+=$(this).outerHeight(!0),g=0,n>e?$(this).addClass("hide-tlb-item").css("width",
l):$(this).removeClass("hide-tlb-item").css("width",l)):f>e&&!1==r.spaceview?$(this).addClass("hide-tlb-item"):(g+=$(this).outerWidth(!0),g>e-u?$(this).addClass("hide-tlb-item"):$(this).removeClass("hide-tlb-item")));$(this).hasClass("tlb-item")&&(n+$(this).outerHeight(!0)>e&&(c(this),s=1),n+$(this).outerHeight(!0)<=e&&(g+=$(this).outerWidth(!0),g<l?(0==g&&(n+=$(this).outerHeight(!0)),p=this,n+=$(this).outerHeight(!0),d(this)):(g=$(this).outerWidth(!0),n>e?(c(this),s=1):(p=this,n+=$(this).outerHeight(!0),
d(this)))))});null!=p&&1==s?(c(p),a.find(".tlb-more").css("display","block").insertAfter(p)):a.find(".tlb-more").css("display","none")}function ia(a){if("undefined"==typeof a||null==a)return"";for(var b=0;b<m.init.timeclassmirror.length;b++)if(m.init.timeclassmirror[b].time==a.toLowerCase()||m.init.timeclassmirror[b].time==a.toUpperCase())return m.init.timeclassmirror[b].css;return""}function r(a,b){var c="",d=a.indexOf("<"+b+">"),g=("<"+b+">").length,k=a.indexOf("</"+b+">");-1!=d&&-1!=k&&k>d+g&&
(c=a.substring(d+g,k));return c}function V(a){for(var b=m.currenlayout.toolbars,c=0;c<b.length;c++){var d=b[c];if(d.id==a)return d}return null}function g(a){try{return"undefined"!=typeof p.mycache[a]&&null!=p.mycache[a]?p.mycache[a]:null}catch(b){return null}}function u(a,b){try{p.mycache[a]=b}catch(c){}}var p={},m=ka;m.toolbaradvobj=p;p.mycache={};var B=/=""/g,T=m.api.debug.getLogger("prochart.gui.toolbar");D=Q=S=P=R=x=O=N=M=J=L=K=I=H=G=null;var A=[];p.gui={initPattern:function(){var a=$.Deferred(),
b=!1==m.guiinit.cache?"?"+m.version.gui.name+(new Date).getTime():"?"+m.version.gui.name;$("<div>");b=m.guiinit.rootpath+"/ChartUI/gui/toolbar/toolbar.patterns.htm"+b;if(m.navigator.XMLHttpRequest()){var c=new XMLHttpRequest;c.open("get",b);c.onload=function(){var b=c.responseText;W(b);T.debug("readToolbar Pattern");a.resolve(b)};c.send()}else $.ajax({type:"GET",async:!0,dataType:"html",url:b}).done(function(b){W(b);T.debug("readToolbar Pattern");a.resolve(b)});return a.promise()},viewToolbarTop:function(a){!1==
m.guiinit.cache&&(new Date).getTime();p.parent=a;la();"undefined"!=typeof m.localizationobj&&m.localizationobj.gui.updateFromDataLang(a)},viewTimeFrameButton:function(a,b){null==g("$parent .tlb-item button tid="+a)&&u("$parent .tlb-item button tid="+a,g("$parent").find(".tlb-item button[tid^='"+a+"']"));null==g("$parent .tlb-more-item button tid="+a)&&u("$parent .tlb-more-item button tid="+a,g("$parent").find(".tlb-more-item button[tid^='"+a+"']"));var c=g("$parent .tlb-item button tid="+a),d=g("$parent .tlb-more-item button tid="+
a);if(0<c.length||0<d.length){switch(b){case "1":case 1:c.removeClass("hideobj");d.removeClass("hideobj");break;case 0:case "0":c.addClass("hideobj"),d.addClass("hideobj")}z()}},viewTimeFrameButtons:function(a){if(0!=a.length){for(var b=0;b<a.length;b++){var c=a[b];null==g("$parent .tlb-item button tid="+c.id)&&u("$parent .tlb-item button tid="+c.id,g("$parent").find(".tlb-item button[tid^='"+c.id+"']"));null==g("$parent .tlb-more-item button tid="+c.id)&&u("$parent .tlb-more-item button tid="+c.id,
g("$parent").find(".tlb-more-item button[tid^='"+c.id+"']"));var d=g("$parent .tlb-item button tid="+c.id),h=g("$parent .tlb-more-item button tid="+c.id);if(0<d.length||0<h.length)switch(c.f){case "1":case 1:d.removeClass("hideobj");h.removeClass("hideobj");break;case 0:case "0":d.addClass("hideobj"),h.addClass("hideobj")}}z()}},selectedTimeFrameButton:function(a){if("undefined"!=typeof a&&"null"!=a){null==g("$parent .change-timeframe")&&u("$parent .change-timeframe",g("$parent").find(".change-timeframe"));
g("$parent .change-timeframe").removeClass("button-selected");null==g("$parent .change-timeframe itd="+a)&&u("$parent .change-timeframe itd="+a,g("$parent").find(".change-timeframe[tid|='"+a+"']"));var b=g("$parent .change-timeframe itd="+a);0<b.length&&b.addClass("button-selected");b.attr("data-localize");b.attr("title");b.find(">span").attr("class");g("$parent").find(".group-button-timescale").each(function(){$(this).html(b.html())})}},selectedChartTypeButton:function(a){if("undefined"!=typeof a&&
"null"!=a){null==g("$parent .change-typechart")&&u("$parent .change-typechart",g("$parent").find(".change-typechart"));g("$parent .change-typechart").removeClass("button-selected");null==g("$parent .change-typechart tid="+a)&&u("$parent .change-typechart tid="+a,g("$parent").find(".change-typechart[tid|='"+a+"']"));var b=g("$parent .change-typechart tid="+a);0<b.length&&b.addClass("button-selected");b.attr("data-localize");b.attr("title");b.find(">span").attr("class");g("$parent").find(".group-button-charttype").each(function(){$(this).html(b.html())})}},
viewTypeChartButton:function(a,b){null==g("$parent .tlb-item button tid="+a)&&u("$parent .tlb-item button tid="+a,g("$parent").find(".tlb-item button[tid|='"+a+"']"));null==g("$parent .tlb-more-item button tid="+a)&&u("$parent .tlb-more-item button tid="+a,g("$parent").find(".tlb-more-item button[tid|='"+a+"']"));var c=g("$parent .tlb-item button tid="+a),d=g("$parent .tlb-more-item button tid="+a);if(0<c.length||0<d.length){switch(b){case 1:c.removeClass("hideobj");d.removeClass("hideobj");break;
case 0:c.addClass("hideobj"),d.addClass("hideobj")}z()}},viewTypeChartButtons:function(a){if(0!=a.length){for(var b=0;b<a.length;b++){var c=a[b];null==g("$parent .tlb-item button tid="+c.id)&&u("$parent .tlb-item button tid="+c.id,g("$parent").find(".tlb-item button[tid|='"+c.id+"']"));null==g("$parent .tlb-more-item button tid="+c.id)&&u("$parent .tlb-more-item button tid="+c.id,g("$parent").find(".tlb-more-item button[tid|='"+c.id+"']"));var d=g("$parent .tlb-item button tid="+c.id),h=g("$parent .tlb-more-item button tid="+
c.id);if(0<d.length||0<h.length)switch(c.f){case 1:case "1":d.removeClass("hideobj");h.removeClass("hideobj");break;case 0:case "0":d.addClass("hideobj"),h.addClass("hideobj")}}z()}},updateTimesScale:function(a){if("undefined"!=typeof a&&null!=a){null==g("$parent .change-timeframe")&&u("$parent .change-timeframe",$(p.parent).find(".change-timeframe"));var b=g("$parent .change-timeframe");"undefined"!=typeof a.timescales&&null!=a.timescales?(b.addClass("disabled"),a.timescales.forEach(function(a){$(p.parent).find('.change-timeframe[tid="'+
a+'"]').removeClass("disabled")})):b.removeClass("disabled")}},adjustSize:z,changeLocalization:function(a,b){z();ta(a,b);na();oa()},hideopengroup:function(){var a=$(p.parent);a.find(".tlb-button-groups").css("display","none");a.find(".tlb-more-items").css("display","none")},changeIcon:function(a,b){$(p.parent).find("button.icon-button > span."+a).removeClass(a).addClass(b)}};return p};
