function ProChart_InitProps(q){function w(b){$("#chart-dialog").html(b);x();y();t();z();$("#color-opacity-volume").slider({min:0,max:100});b=[];b.push("color-grid-vertical","color-grid-hotizontal","color-watermark");for(var d=0;d<b.length;d++)A($("#"+b[d]),"#225437");g("#control-grid-vertical","#color-grid-vertical",null,null,null);g("#control-grid-hotizontal","#color-grid-hotizontal",null,null,null);$("#color-opacity-watermark").slider({min:0,max:100});E();F();a.chart.IsVolumeEnabled()||$(".properties-tabs").find(".volume-property-tab").css("display",
"none");"undefined"!=typeof a.localizationobj&&a.localizationobj.gui.updateFromDataLang($("#chart-dialog"));$("#chart-dialog").dialog("open")}function B(b){$("#dlg-props").html(b);x();y();t();z();"undefined"!=typeof a.localizationobj&&a.localizationobj.gui.updateFromDataLang($("#chart-dialog"));$("#chart-dialog").dialog("open")}function x(){$("#borderwidth-area-line").slider({min:1,max:6});$("#borderwidth-line-line").slider({min:1,max:6});$("#borderwidth-histogram-line").slider({min:1,max:6});$("#color-opacity-area").slider({min:0,
max:100})}function y(){var b=[];b.push('<option value="%charttypeid%" data-localize="dialogs.indicator.%charttypeid%">%charttypename%</option>');var d=$("#tbody-charttype-select").find("select"),c=/%charttypeid%/g,f=/%charttypename%/g;if(null!=d)for(var k=0;k<a.init.charttype.length;k++){var h=a.init.charttype[k],h=b[0].replace(c,h.id).replace(f,a.localizationobj.gui.returnLocalizationString("dialogs.props."+h.id,h.n));d.append(h)}b=a.chart.GetPriceProperties().GetDrawType();$(d).val(b);$(".charttype-block").css("display",
"none");$("#charttype-block-"+b).css("display","block");b=a.chart.GetRTLineVisible();$("#control-priceline-visible").prop("checked",Boolean(b));$(d).on("change",function(){var b=$(this).val();$(".charttype-block").css("display","none");$("#charttype-block-"+b).css("display","block");a.chart.GetPriceProperties().SetDrawType(b);a.chart.Redraw();t();var c=a.chart.GetPriceProperties().GetStyle();try{"undefined"!=typeof a.api.localstorage&&a.api.localstorage.setPriceType(b)}catch(d){}if(typeof a.events.globprop.onPriceTypeChange==
typeof Function)a.events.globprop.onPriceTypeChange(b,c);m.debug(b,c)});$("#control-priceline-visible").on("click",function(b){b=!0;$(this).is(":checked")?(a.chart.SetRTLineVisible(!0),b=!0):(a.chart.SetRTLineVisible(!1),b=!1);a.chart.Redraw();try{"undefined"!=typeof a.api.localstorage&&a.api.localstorage.setPriceLine(b)}catch(c){}if(typeof a.events.globprop.onPriceLineChange==typeof Function)a.events.globprop.onPriceLineChange(b);m.debug("SetRTLineVisible",b)})}function z(){g("#control-candlesticks-border",
"#color-candlesticks-up-border","#color-candlesticks-down-border","#color-candlesticks-flat-border",null,null);g("#control-candlesticks-wick","#color-candlesticks-wick",null,null,null,null);g("#control-columns-border","#color-columns-up-border","#color-columns-down-border","#color-columns-flat-border",null,null);g("#control-hollowcandlesticks-border","#color-hollowcandlesticks-up-border","#color-hollowcandlesticks-down-border","#color-hollowcandlesticks-flat-border",null,null);g("#control-hollowcandlesticks-wick",
"#color-hollowcandlesticks-wick",null,null,null,null);g("#control-ohlc-border","#color-ohlc-up-border","#color-ohlc-down-border","#color-ohlc-flat-border",null,null);g("#control-ohlc-wick","#color-ohlc-wick",null,null,null,null);g("#control-hlc-border","#color-hlc-up-border","#color-hlc-down-border","#color-hlc-flat-border",null,null);g("#control-hlc-wick","#color-hlc-wick","#color-hlc-border-flat",null,null,null);g("#control-dots-border","#color-dots-up-border","#color-dots-down-border","#color-dots-flat-border",
null,null);g("#control-heikinashi-border","#color-heikinashi-up-border","#color-heikinashi-down-border","#color-heikinashi-flat-border",null,null);g("#control-heikinashi-wick","#color-heikinashi-wick",null,null,null,null);$(".class-price-color").on("change",function(){for(var b=$(this).spectrum("get").toRgbString(),d=$(this).attr("id"),c=0;c<e.length;c++)if(e[c].ctr==d){var f=a.chart.GetPriceProperties(),k=f.GetStyle();r(k,e[c].json,b);f=f.GetDrawType();"undefined"!=typeof a.api.localstorage&&a.api.localstorage.setPriceStyle(f,
k);if(typeof a.events.globprop.onPriceStyleChange==typeof Function)a.events.globprop.onPriceStyleChange(f,k);m.debug(f,k);a.chart.Redraw();switch(d){case "color-area-up":var k=$("#color-area-up").spectrum("get").alpha,f=$("#color-area-up").spectrum("get").toHexString(),h=100;isNaN(parseFloat(k))||(h=100*k);$("#color-opacity-area").slider("option","value")!=h&&$("#color-opacity-area").slider("option","value",h);$("#"+e[c].opacityctr+" div.gradient").css("background-image","linear-gradient(to left, "+
f+" 0%, transparent 100% )")}}});$("#borderwidth-line-line").on("slidechange",function(){var b=$(this).slider("option","value"),d=a.chart.GetPriceProperties(),c=d.GetStyle();c.strokeWidth=b;a.chart.Redraw();b=d.GetDrawType();"undefined"!=typeof a.api.localstorage&&a.api.localstorage.setPriceStyle(b,c);if(typeof a.events.globprop.onPriceStyleChange==typeof Function)a.events.globprop.onPriceStyleChange(b,c);m.debug(b,c)});$("#borderwidth-histogram-line").on("slidechange",function(){var b=$(this).slider("option",
"value"),d=a.chart.GetPriceProperties(),c=d.GetStyle();c.strokeWidth=b;b=d.GetDrawType();"undefined"!=typeof a.api.localstorage&&a.api.localstorage.setPriceStyle(b,c);if(typeof a.events.globprop.onPriceStyleChange==typeof Function)a.events.globprop.onPriceStyleChange(b,c);m.debug(b,c);a.chart.Redraw()});$("#borderwidth-area-line").on("slidechange",function(){var b=$(this).slider("option","value"),d=a.chart.GetPriceProperties(),c=d.GetStyle();c.strokeWidth=b;b=d.GetDrawType();"undefined"!=typeof a.api.localstorage&&
a.api.localstorage.setPriceStyle(b,c);if(typeof a.events.globprop.onPriceStyleChange==typeof Function)a.events.globprop.onPriceStyleChange(b,c);m.debug(b,c);a.chart.Redraw()});$("#color-opacity-area").on("slidechange",function(){var a=$(this).slider("option","value"),d=$("#color-area-up").spectrum("get").toRgb(),a="rgba(%r%, %g%, %b%, %a%)".replace("%r%",d.r).replace("%g%",d.g).replace("%b%",d.b).replace("%a%",a/100);$("#color-area-up").spectrum("set",a)})}function t(){var b=a.chart.GetPriceProperties(),
d=b.GetDrawType();e=[];l=[];switch(d){case "candlesticks":e.push({ctr:"color-candlesticks-up-candles",json:"up.fill"},{ctr:"color-candlesticks-down-candles",json:"down.fill"},{ctr:"color-candlesticks-up-border",json:"up.stroke"},{ctr:"color-candlesticks-down-border",json:"down.stroke"},{ctr:"color-candlesticks-flat-candles",json:"flat.fill"},{ctr:"color-candlesticks-flat-border",json:"flat.stroke"},{ctr:"color-candlesticks-wick",json:"wick.stroke"});l.push({ctr:"control-candlesticks-border",json:"borderVisible"},
{ctr:"control-candlesticks-wick",json:"wick.visible"});break;case "columns":e.push({ctr:"color-columns-up-column",json:"up.fill"},{ctr:"color-columns-down-column",json:"down.fill"},{ctr:"color-columns-up-border",json:"up.stroke"},{ctr:"color-columns-down-border",json:"down.stroke"},{ctr:"color-columns-flat-column",json:"flat.fill"},{ctr:"color-columns-flat-border",json:"flat.stroke"},{ctr:"color-columns-wick",json:"wick.stroke"});l.push({ctr:"control-columns-border",json:"borderVisible"});break;case "hollowcandlesticks":e.push({ctr:"color-hollowcandlesticks-up-candles",
json:"up.fill"},{ctr:"color-hollowcandlesticks-down-candles",json:"down.fill"},{ctr:"color-hollowcandlesticks-up-border",json:"up.stroke"},{ctr:"color-hollowcandlesticks-down-border",json:"down.stroke"},{ctr:"color-hollowcandlesticks-flat-candles",json:"flat.fill"},{ctr:"color-hollowcandlesticks-flat-border",json:"flat.stroke"},{ctr:"color-hollowcandlesticks-wick",json:"wick.stroke"});l.push({ctr:"control-hollowcandlesticks-border",json:"borderVisible"},{ctr:"control-hollowcandlesticks-wick",json:"wick.visible"});
break;case "ohlc":e.push({ctr:"color-ohlc-up-border",json:"up.stroke"},{ctr:"color-ohlc-down-border",json:"down.stroke"},{ctr:"color-ohlc-flat-border",json:"flat.stroke"});break;case "hlc":e.push({ctr:"color-hlc-up-border",json:"up.stroke"},{ctr:"color-hlc-down-border",json:"down.stroke"},{ctr:"color-hlc-flat-border",json:"flat.stroke"});break;case "histogram":e.push({ctr:"color-histogram-up-border",json:"up.stroke"},{ctr:"color-histogram-down-border",json:"down.stroke"},{ctr:"color-histogram-flat-border",
json:"flat.stroke"});break;case "dots":e.push({ctr:"color-dots-up-candles",json:"up.fill"},{ctr:"color-dots-down-candles",json:"down.fill"},{ctr:"color-dots-up-border",json:"up.stroke"},{ctr:"color-dots-down-border",json:"down.stroke"},{ctr:"color-dots-flat-candles",json:"flat.fill"},{ctr:"color-dots-flat-border",json:"flat.stroke"});break;case "heikinashi":e.push({ctr:"color-heikinashi-up-candles",json:"up.fill"},{ctr:"color-heikinashi-down-candles",json:"down.fill"},{ctr:"color-heikinashi-up-border",
json:"up.stroke"},{ctr:"color-heikinashi-down-border",json:"down.stroke"},{ctr:"color-heikinashi-flat-candles",json:"flat.stroke"},{ctr:"color-heikinashi-wick",json:"wick.stroke"},{ctr:"color-heikinashi-flat-border",json:"flat.fill"});l.push({ctr:"control-heikinashi-border",json:"borderVisible"},{ctr:"control-heikinashi-wick",json:"wick.visible"});break;case "line":e.push({ctr:"color-line-line",json:"stroke"});break;case "area":e.push({ctr:"color-area-line",json:"stroke"},{ctr:"color-area-up",json:"fill",
opacityctr:"color-opacity-area"})}for(var b=b.GetStyle(),c=0;c<e.length;c++)A($("#"+e[c].ctr),u(b,e[c].json),!0);for(c=0;c<l.length;c++){var f=u(b,l[c].json);if(null==f)break;"true"==f.toLowerCase()?$("#"+l[c].ctr).attr("checked",!0):$("#"+l[c].ctr).removeAttr("checked")}switch(d){case "line":d=b.strokeWidth;$("#borderwidth-line-line").slider("option","value",d);break;case "histogram":d=b.strokeWidth;$("#borderwidth-histogram-line").slider("option","value",d);break;case "area":d=b.strokeWidth,$("#borderwidth-area-line").slider("option",
"value",d),d=$("#color-area-up").spectrum("get").alpha,b=100,isNaN(parseFloat(d))||(b=100*d),$("#color-opacity-area").slider("option","value")!=b&&$("#color-opacity-area").slider("option","value",b)}}function g(b,d,c,f,k,h){$(b).on("click",function(b){var e=$(this);b=$(this).attr("id");e.is(":checked")?(null!=h&&$(h).slider("enable"),null!=k&&$(k).slider("enable"),null!=d&&$(d).spectrum("enable"),null!=c&&$(c).spectrum("enable"),null!=f&&$(f).spectrum("enable")):(null!=h&&$(h).slider("disable"),null!=
k&&$(k).slider("disable"),null!=d&&$(d).spectrum("disable"),null!=c&&$(c).spectrum("disable"),null!=f&&$(f).spectrum("disable"));for(var e=e.is(":checked"),n=0;n<l.length;n++)if(l[n].ctr==b){var g=a.chart.GetPriceProperties(),p=g.GetStyle();r(p,l[n].json,e?"true":"false");g=g.GetDrawType();"undefined"!=typeof a.api.localstorage&&a.api.localstorage.setPriceStyle(g,p);if(typeof a.events.globprop.onPriceStyleChange==typeof Function)a.events.globprop.onPriceStyleChange(g,p);m.debug(g,p);a.chart.Redraw()}for(n=
0;n<v.length;n++)if(v[n].ctr==b){p=a.chart.GetVolumeInfo().GetStyle();r(p,v[n].json,e?"true":"false");if(typeof a.events.globprop.onVolumeStyleChange==typeof Function)a.events.globprop.onVolumeStyleChange(p);m.debug(p);a.chart.Redraw()}})}function E(){var b=(new Date).getTimezoneOffset(),d=a.chart.GetTimeZone(),c=" UTC "+(0<b?"-":"+")+Math.abs(d/60);$("#current-time-zone-span").html(c);$("#button-update-timezone").button();$("#button-update-timezone").on("click",function(){var b=$("#select-timezone").val(),
d=$("#control-daylight-time").is(":checked")?1:0,h=-60*(parseFloat(b)+d);a.chart.SetTimeZone(h);if(typeof a.events.globprop.onVolumeStyleChange==typeof Function)a.events.globprop.onTimeZoneChange(h);m.debug(h);a.chart.Redraw();c=" UTC "+(0<h?"-":"+")+Math.abs(parseFloat(b)+d);$("#current-time-zone-span").html(c)})}function C(b,d){function c(a){$(a).find(".spectrum-color").each(function(){$(this).spectrum("destroy")})}function f(a){$(a).find(".ui-dialog-buttonset").prepend('<button class="chart-button adv-buttons eye-orange " type="button" title="" ></button>').on("click",
function(){var a=$(".chart-ui-dialog.props-dialog").css("opacity"),a=1==a?.5:1,b=1==a?"":2;$(".chart-ui-dialog.props-dialog").css("opacity",a);$(this).css("opacity",b)})}var e="Close",h=d,g="";"undefined"!=typeof a.localizationobj&&(e=a.localizationobj.gui.returnLocalizationString("dialogs.common.button-close","Close"),h=a.localizationobj.gui.returnLocalizationString("dialogs.props.generalproperties-title",d));"undefined"!=typeof a.init.TemplateName&&(g=a.init.TemplateName);var l="";"rtl"==a.localizationobj.gui.returnCurrentLanguage().direction&&
(l="dir-rtl");$('<div id="chart-dialog" title="'+h+'"></div>').insertAfter("body");$("#chart-dialog").dialog({dialogClass:"chart-ui-dialog props-dialog "+g+" "+l,draggable:!0,autoOpen:!1,resizable:!1,closeOnEscape:!0,width:"auto",modal:!0,open:function(b,c){f($(this).parent());$(".ui-widget-overlay").bind("click",function(){$("#chart-dialog").dialog("close")});if(typeof a.events.globprop.onOpenDialog==typeof Function)a.events.globprop.onOpenDialog();m.debug("Open dialog global properies");"undefined"!=
typeof a.preloadobj&&a.preloadobj.endPreload()},close:function(b,d){c($(this).parent());$("#chart-dialog").remove();$("div.chart-ui-dialog.systems-dialog  adv-buttons.eye-orange").off().remove();$("div.chart-ui-dialog.systems-dialog").off().remove();$(this).off().empty().remove();if(typeof a.events.globprop.onCloseDialog==typeof Function)a.events.globprop.onCloseDialog();m.debug("Close dialog global properies")},buttons:[{id:"btn-dialogs-close",text:e,click:function(){$(this).dialog("close")}}]})}
function F(){$(".properties-tabs").delegate("a","click",function(){var a=$(this).index();$(".main-properties").each(function(){$(this).css("display","none")});$(".properties-tabs-label").each(function(){$(this).removeClass("active")});$(".main-properties").eq(a).css("display","block");$(this).addClass("active")})}function D(){"undefined"!=typeof a.preloadobj&&a.preloadobj.startPreload()}function u(a,d){var c=d.split(".");return 1==c.length?a[c[0]]:"undefined"!=typeof a[c[0]]?u(a[c[0]],c.slice(1).join(".")):
null}function r(a,d,c){d=d.split(".");1==d.length&&(a[d[0]]=c);"undefined"!=typeof a[d[0]]&&r(a[d[0]],d.slice(1).join("."),c)}function A(a,d,c,f){"undefined"==typeof f&&(f=!1);c=[];f&&c.push("rgba(0, 0, 0, 0);{rgba(0, 0, 0, 0.1);{rgba(0, 0, 0, 0.2);{rgba(0, 0, 0, 0.3);{rgba(0, 0, 0, 0.4);{rgba(0, 0, 0, 0.5);{rgba(0, 0, 0, 0.6);{rgba(0, 0, 0, 0.7);{rgba(0, 0, 0, 0.8);{rgba(0, 0, 0, 0.9);".split("{"));c.push("rgb(0, 0, 0);{rgb(66, 66, 66);{rgb(101, 101, 101);{rgb(152, 152, 152);{rgb(182, 182, 182);{rgb(203, 203, 203);{rgb(216, 216, 216);{rgb(238, 238, 238);{rgb(242, 242, 242);{rgb(255, 255, 255);".split("{"));
c.push("rgb(151, 0, 0);{rgb(255, 0, 0);{rgb(255, 152, 0);{rgb(255, 255, 0);{rgb(0, 255, 0);{rgb(0, 255, 255);{rgb(73, 133, 231);{rgb(0, 0, 255);{rgb(152, 0, 255);{rgb(255, 0, 255);".split("{"));c.push("rgb(230, 184, 175);{rgb(244, 204, 204);{rgb(252, 229, 205);{rgb(255, 242, 204);{rgb(217, 234, 211);{rgb(208, 224, 227);{rgb(201, 218, 248);{rgb(207, 226, 243);{rgb(217, 210, 233);{rgb(234, 209, 220);".split("{"));c.push("rgb(221, 126, 107);{rgb(234, 153, 153);{rgb(249, 203, 156);{rgb(255, 229, 153);{rgb(182, 215, 168);{rgb(162, 196, 201);{rgb(164, 194, 244);{rgb(159, 197, 232);{rgb(180, 167, 214);{rgb(213, 166, 189);".split("{"));
c.push("rgb(204, 65, 37);{rgb(224, 102, 102);{rgb(246, 178, 107);{rgb(255, 217, 102);{rgb(147, 196, 125);{rgb(118, 165, 175);{rgb(109, 158, 235);{rgb(111, 168, 220);{rgb(142, 124, 195);{rgb(194, 123, 160);".split("{"));c.push("rgb(166, 28, 0);{rgb(204, 0, 0);{rgb(230, 145, 56);{rgb(241, 194, 50);{rgb(106, 168, 79);{rgb(69, 129, 142);{rgb(60, 120, 216);{rgb(61, 133, 198);{rgb(103, 78, 167);{rgb(166, 77, 121);".split("{"));c.push("rgb(133, 32, 12);{rgb(153, 0, 0);{rgb(180, 95, 6);{rgb(191, 144, 0);{rgb(56, 118, 29);{rgb(19, 79, 92);{rgb(17, 85, 204);{rgb(11, 83, 148);{rgb(53, 28, 117);{rgb(116, 27, 71);".split("{"));
c.push("rgb(91, 15, 0);{rgb(102, 0, 0);{rgb(120, 63, 4);{rgb(127, 96, 0);{rgb(39, 78, 19);{rgb(12, 52, 61);{rgb(28, 69, 135);{rgb(7, 55, 99);{rgb(32, 18, 77);{rgb(76, 17, 48);".split("{"));$(a).spectrum({color:d,showAlpha:f,showPalette:!0,showPaletteOnly:!1,clickoutFiresChange:!1,showButtons:!1,palette:c})}var a=q;q={};a.props=q;var m=a.api.debug.getLogger("prochart.gui.props"),s="",e=[],l=[],v=[];q.gui={viewProps:function(){var b=$.Deferred();D();s="General Properties";C("test",s);var d=!1==a.guiinit.cache?
"?"+a.version.gui.name+(new Date).getTime():"?"+a.version.gui.name,d=a.guiinit.rootpath+"/ChartUI/gui/props/props.htm"+d;if(a.navigator.XMLHttpRequest()){var c=new XMLHttpRequest;c.open("get",d);c.onload=function(){var a=c.responseText;w($(a).find("#dlg-props"));b.resolve(a)};c.send()}else $.ajax({type:"GET",async:!0,url:d}).done(function(a){w($(a).find("#dlg-props"));b.resolve(a)});return b.promise()},viewPriceOnly:function(b,d){var c=$.Deferred();D();s=d.GetSymbol();C("test",s);var f=!1==a.guiinit.cache?
"?"+a.version.gui.name+(new Date).getTime():"?"+a.version.gui.name;$("#chart-dialog").append('<div id="dlg-props" class="adv-dialog-content"></div>');f=a.guiinit.rootpath+"/ChartUI/gui/props/props.htm"+f;if(a.navigator.XMLHttpRequest()){var e=new XMLHttpRequest;e.open("get",f);e.onload=function(){var a=e.responseText;B($(a).find("#price-props"));c.resolve(a)};e.send()}else $.ajax({type:"GET",async:!0,dataType:"html",url:f}).done(function(a){B($(a).find("#price-props"));c.resolve(a)});return c.promise()},
viewVolumeOnly:function(){}};q.init={};return q};
