function ProChart_InitZoom(F){var y,z,A;function C(a){var f=$(e.init.chartcontainer).find(".chart-price-zoom");a=$("<div><div>").html(a);f.append(a);G(f);$(f).find("#zoom-buttons").innerWidth();$(f).width();"undefined"!=typeof e.localizationobj&&e.localizationobj.gui.updateFromDataLang(f)}function D(a){y=v(a,"zoom-container");z=v(a,"zoom-chart-container");v(a,"zoom-slider");A=v(a,"zoom-date-range")}function H(a){var f=e.commonutils.func.getKeybyPath(e.gui.guiblock,"zoom.zoomtoolbar.visible");null==
f||0!=f&&!1!=f||$(a).addClass("hideobj")}function I(){$("#zoom-buttons").prochart_hoverIntent(function(){$(this).addClass("zoom-buttons-intent").css("opacity","1")},function(){$(this).removeClass("zoom-buttons-intent").css("opacity","0.1")})}function s(a,f){var b=e.chart.getDateByIndex(a),c=e.chart.getDateByIndex(f);if(null!=b){if(null==w(".adv-svgchart-zoom .zoom-date-range #date-start")){var h=$(k.parent).find(".adv-svgchart-zoom .zoom-date-range #date-start");try{k.mycache[".adv-svgchart-zoom .zoom-date-range #date-start"]=
h}catch(d){}}w(".adv-svgchart-zoom .zoom-date-range #date-start").html(b)}if(null!=c){if(null==w(".adv-svgchart-zoom .zoom-date-range #date-end")){b=$(k.parent).find(".adv-svgchart-zoom .zoom-date-range #date-end");try{k.mycache[".adv-svgchart-zoom .zoom-date-range #date-end"]=b}catch(g){}}w(".adv-svgchart-zoom .zoom-date-range #date-end").html(c)}}function G(a){I();$(a).find("button").on("click",function(){var a=$(this).attr("tid");"undefined"!=e.actions&&e.actions.action(a);return!1})}function v(a,
f){var b="",c=a.indexOf("<"+f+">"),h=("<"+f+">").length,e=a.indexOf("</"+f+">");-1!=c&&-1!=e&&e>c+h&&(b=a.substring(c+h,e));return b}function x(a,f,e){var c="",b={width:null,height:null},d=null,g=null;"undefined"!=typeof f&&("undefined"!=typeof f.width&&(d=f.width),"undefined"!=typeof f.height&&(g=f.height));c="undefined"==typeof a.position?c+"position :absolute;":c+"position :"+a.position+"; ";f="px";"undefined"!=typeof e&&null!=e&&(f=e);"undefined"!=typeof a.display&&(c=c+"display :"+a.display+
";");"undefined"!=typeof a.left&&(b.left=a.left,c=c+"left :"+t(a.left,f)+"; ");"undefined"!=typeof a.right&&(b.right=a.right,c=c+"right :"+t(a.right,f)+"; ");"undefined"!=typeof a.top&&(b.top=a.top,c=c+"top :"+t(a.top,f)+"; ");"undefined"!=typeof a.bottom&&(b.bottom=a.bottom,c=c+"bottom :"+t(a.bottom,f)+"; ");"undefined"!=typeof a.width?null==d||"auto"!=a.width.toString().toLowerCase()&&"inherit"!=a.width.toString().toLowerCase()?(b.width=a.width,c=c+"width :"+t(a.width,f)+";"):(b.width=d-r(a.left)-
r(a.right),c=c+"width :"+b.width+f+";"):null!=d&&(b.width=d-r(a.left)-r(a.right),c=c+"width :"+b.width+f+";");"undefined"!=typeof a.height?null==g||"auto"!=a.height.toString().toLowerCase()&&"inherit"!=a.height.toString().toLowerCase()?(b.height=a.height,c=c+"height :"+t(a.height,f)+"; "):(b.height=g-r(a.top)-r(a.bottom),c=c+"height :"+b.height+f+";"):null!=g&&(b.height=g-r(a.top)-r(a.bottom),c=c+"height :"+b.height+f+";");"undefined"!=typeof a.view&&!0!=a.view&&(c+="display : none; ");0<c.length&&
(c='style="'+c+'"');return{style:c,size:b}}function t(a,b){return"auto"==a.toString().toLowerCase()||"inherit"==a.toString().toLowerCase()?a:a+b}function r(a){if("undefined"!=typeof a)return"auto"==a.toString().toLowerCase()||"inherit"==a.toString().toLowerCase()?0:parseInt(a)}function w(a){try{return"undefined"!=typeof k.mycache[a]&&null!=k.mycache[a]?k.mycache[a]:null}catch(b){return null}}var k={},e=F,d,b,q,E=e.api.debug.getLogger("prochart.gui.zoom");e.zoomobj=k;k.size={width:0,pwidth:0,rectRight:null,
rectLeft:null,parent_width:0,parent_height:0};k.mycache={};var B=/=""/g;A=z=y=null;e.chart.UI.funcOnZoomChange=function(a,f,u,c,h,p){d=f;b=u;q=c;a=e.chart.getDateByIndex(f);u=e.chart.getDateByIndex(u);null!=a&&$(k.parent).find(".date-start").html(a);null!=u&&$(k.parent).find(".date-end").html(u)};k.gui={viewZoom:function(a){k.parent=a;a=[];for(var b=e.currenlayout.zooms,d=0;d<b.length;d++){var c=b[d],h=e.commonutils.func.returnShortUniqID(),p="",g="",l={width:null,height:null},m=$(k.parent).find("#"+
c.parent);m&&(l.width=m.innerWidth(),l.height=m.innerHeight());c.guiid=h;"undefined"!=typeof c.location&&(p=p+" loc-"+c.location);g=h;"undefined"!=typeof c.id&&(g=c.id);h=y.replace(B,"").replace(/%css%/g,p).replace(/%tid%/g,g).replace(/%id%/g,h);g="";for(p=0;p<c.items.length;p++)switch(g=c.items[p],g.type){case "chart_container":var n=e.commonutils.func.returnShortUniqID();a.push(n);g=x(g.possition,l);g={zoom:z.replace(B,"").replace(/%style%/g,g.style).replace(/%id%/g,n)};h=h.replace(/%html%/g,g.zoom+
"%html%");break;case "daterange":n=e.commonutils.func.returnShortUniqID(),g=x(g.possition,l),g={zoom:A.replace(B,"").replace(/%style%/g,g.style).replace(/%id%/g,n)},h=h.replace(/%html%/g,g.zoom+"%html%")}h=h.replace(/%html%/g,"");m.append(h);for(c=0;c<a.length;c++)if(l=m.find("#"+a[c]+" > div"),0<l.length){e.chart.ZoomSvgChart=l[0];try{e.chart.SetZoomContainer(l)}catch(q){}}}},viewZoomToolbox:function(){var a=$(e.init.chartcontainer).find(".chart-price-zoom");if(0<a.length){var b=$.Deferred(),d=!1==
e.guiinit.cache?"?"+e.version.gui.name+(new Date).getTime():"?"+e.version.gui.name,d=e.guiinit.rootpath+"/ChartUI/gui/zoom/zoom.toolbox.htm"+d;H(a);if(e.navigator.XMLHttpRequest()){var c=new XMLHttpRequest;c.open("get",d);c.onload=function(){var a=c.responseText;C($(a).find("#zoom-buttons"));b.resolve(a)};c.send()}else return $.ajax({type:"GET",async:!0,crossDomain:!0,dataType:"html",url:d}).done(function(a){C($(a).find("#zoom-buttons"));b.resolve(a)}),b.promise()}},adjustSize:function(){for(var a=
e.currenlayout.zooms,b=0;b<a.length;b++){var d=a[b],c={width:null,height:null},h=$(k.parent).find("#"+d.parent);if(h){c.width=h.innerWidth();c.height=h.innerHeight();for(var p=0;p<d.items.length;p++){var g=d.items[p];switch(g.type){case "chart_container":var l=h,g=x(g.possition,c).size,l=l.find(".zoom-chart-container");if(0!=l.length){for(var m="height width top right bottom left".split(" "),n=0;n<m.length;n++)"undefined"!=typeof g[m[n]]&&l.css(m[n],g[m[n]]);e.chart.AdjustZoomSize(g[m[1]],g[m[0]])}break;
case "daterange":if(l=h,g=x(g.possition,c).size,l=l.find(".zoom-date-range"),0!=l.length)for(m="height width top right bottom left".split(" "),n=0;n<m.length;n++)"undefined"!=typeof g[m[n]]&&l.css(m[n],g[m[n]])}}}}},initPattern:function(){var a=$.Deferred(),b=!1==e.guiinit.cache?"?"+e.version.gui.name+(new Date).getTime():"?"+e.version.gui.name,b=e.guiinit.rootpath+"/ChartUI/gui/zoom/zoom.patterns.htm"+b;if(e.navigator.XMLHttpRequest()){var d=new XMLHttpRequest;d.open("get",b);d.onload=function(){var b=
d.responseText;D(b);E.debug("readZoom Pattern");a.resolve(b)};d.send()}else $.ajax({type:"GET",async:!0,crossDomain:!0,dataType:"html",url:b}).done(function(b){D(b);E.debug("readZoom Pattern");a.resolve(b)});return a.promise()},onZoomOut:function(){b+=5;d-=5;b-d+1>q?(b=q-1,d=0):0>d?(b+=0-d,d=0):b>q-1&&(d-=b-(q-1),b=q-1);e.chart.SetZoom(d,b,!0);s(d,b)},onZoomIn:function(){10<b-d+1&&(b-=5,d+=5,e.chart.SetZoom(d,b,!0),s(d,b))},onZoomLeft:function(){10<d?(d-=10,b-=10):(b-=d,d=0);e.chart.SetZoom(d,b,!0);
s(d,b)},onZoomRight:function(){var a=b-d+1;b<q-11?(d+=10,b+=10):(b=q-1,d=b-a+1);e.chart.SetZoom(d,b,!0);s(d,b)},onZoomAll:function(){b=q-1;d=0;e.chart.SetZoom(d,b,!0);s(d,b)},onZoomRestore:function(){b=q-1-e.chart.NumOfFutureBars+e.chart.NumOfDefaultVisibleFutureBars;d=b-e.chart.NumVisibleBars+1;e.chart.SetZoom(d,b,!0);s(d,b)},onZoomBottomFixed:function(a){var b=$(k.parent).find(".adv-svgchart-zoom");"undefined"!=typeof b&&(a?($(b).addClass("zoom-on-bottom-page"),$(k.parent).addClass("zoom-height-space")):
($(b).removeClass("zoom-on-bottom-page"),$(k.parent).removeClass("zoom-height-space")))},onTimeZoneChange:function(){},changeLocalization:function(){}};return k};
