function ProChart_InitSystems(x){function q(a){$("#chart-dialog").html(a);r();"undefined"!=typeof b.localizationobj&&b.localizationobj.gui.updateFromDataLang($("#chart-dialog"));$("#chart-dialog").dialog("open");s()}function t(a){$("#chart-dialog").html(a);r();"undefined"!=typeof b.localizationobj&&b.localizationobj.gui.updateFromDataLang($("#chart-dialog"));$("#chart-dialog").dialog("open");s()}function s(){e();b.chart.Login("test@advinion.com","password123")}function u(){c.init.endLisLoaded=0;b.chart.ListTemplates(c.init.mstrUserToken,
"template");b.chart.ListTemplates(c.init.mstrUserToken,"analysis")}function y(){$(".systems-dialog .systems-list .opensystem").off().on("click",function(){var a=$(this).attr("tid"),d=$(this).attr("ttype");e();b.chart.OpenTemplate(c.init.mstrUserToken,a,d)});$(".systems-dialog .systems-list .open-system").off().on("click",function(){var a=$(this).attr("tid"),d=$(this).attr("ttype");e();b.chart.OpenTemplate(c.init.mstrUserToken,a,d)});$(".systems-dialog .systems-list .delete-system").off().on("click",
function(){var a=$(this).attr("tid"),d=$(this).attr("ttype");e();b.chart.DeleteTemplate(c.init.mstrUserToken,a,d)})}function z(){$(".systems-dialog .systems-list .save-system-template").off().on("click",function(){var a=$(this).attr("tid"),d=$(this).parent().find("span").html();e();b.chart.SaveTemplate(c.init.mstrUserToken,a,d,"","template")});$(".systems-dialog .systems-list .save-system-analysis").off().on("click",function(){var a=$(this).attr("tid"),d=$(this).parent().find("span").html();e();b.chart.SaveTemplate(c.init.mstrUserToken,
a,d,"","analysis")});$(".systems-dialog .systems-list .delete-system").off().on("click",function(){var a=$(this).attr("tid"),d=$(this).attr("ttype");e();b.chart.DeleteTemplate(c.init.mstrUserToken,a,d)});$(".systems-dialog .save-system-new-template").off().on("click",function(){var a=$(".systems-dialog #in-newname-template").val();e();b.chart.SaveTemplate(c.init.mstrUserToken,"",a,"","template")});$(".systems-dialog .save-system-new-analysis").off().on("click",function(){var a=$(".systems-dialog #in-newname-analysis").val();
e();b.chart.SaveTemplate(c.init.mstrUserToken,"",a,"","analysis")})}function v(a,d){function c(a){$(a).find(".spectrum-color").each(function(){$(this).spectrum("destroy")})}function A(a){$(a).find(".ui-dialog-buttonset").prepend('<button class="chart-button adv-buttons eye-orange " type="button" title="" ></button>').on("click",function(){var a=$(".chart-ui-dialog.systems-dialog").css("opacity"),a=1==a?.5:1,b=1==a?"":2;$(".chart-ui-dialog.systems-dialog").css("opacity",a);$(this).css("opacity",b)})}
var e="Close",m=d,n="";"undefined"!=typeof b.localizationobj&&(e=b.localizationobj.gui.returnLocalizationString("dialogs.common.button-close","Close"),m=b.localizationobj.gui.returnLocalizationString("dialogs.systems.title",d));"undefined"!=typeof b.init.TemplateName&&(n=b.init.TemplateName);var g="";"rtl"==b.localizationobj.gui.returnCurrentLanguage().direction&&(g="dir-rtl");$('<div id="chart-dialog" title="'+m+'"></div>').insertAfter("body");$("#chart-dialog").dialog({dialogClass:"chart-ui-dialog systems-dialog "+
n+" "+g,draggable:!0,autoOpen:!1,resizable:!1,closeOnEscape:!0,width:"auto",modal:!0,open:function(a,d){A($(this).parent());$(".ui-widget-overlay").bind("click",function(){$("#chart-dialog").dialog("close")});"undefined"!=typeof b.preloadobj&&b.preloadobj.endPreload()},close:function(a,b){c($(this).parent());$("#chart-dialog").remove();$("div.chart-ui-dialog.systems-dialog  adv-buttons.eye-orange").off().remove();$("div.chart-ui-dialog.systems-dialog").off().remove();$(this).off().empty().remove()},
buttons:[{id:"btn-dialogs-close",text:e,click:function(){$(this).dialog("close")}}]})}function r(){$(".properties-tabs").delegate("a","click",function(){var a=$(this).parents(".dialog_level"),b=$(a).find(".properties-tabs a").index(this);$(a).find(".main-properties").each(function(){$(this).css("display","none")});$(a).find(".properties-tabs-label").each(function(){$(this).removeClass("active")});$(a).find(".main-properties").eq(b).css("display","block");$(this).addClass("active")})}function w(){"undefined"!=
typeof b.preloadobj&&b.preloadobj.startPreload()}function e(){if("undefined"!=typeof b.preloadobj){var a=$(".chart-ui-dialog.systems-dialog");b.preloadobj.startPreloadinobject(a)}}function p(){if("undefined"!=typeof b.preloadobj){var a=$(".chart-ui-dialog.systems-dialog");b.preloadobj.endPreloadinobject(a)}}var b=x,c={};b.systems=c;b.api.debug.getLogger("prochart.gui.systems");var k="";c.gui={viewSystems:function(){c.init.typeOpenSave=0;c.init.endLisLoaded=0;w();k="Systems form";v("test",k);var a=
!1==b.guiinit.cache?"?"+b.version.gui.name+(new Date).getTime():"?"+b.version.gui.name,a=b.guiinit.rootpath+"/ChartUI/gui/systems/systems.htm"+a;if(b.navigator.XMLHttpRequest()){var d=new XMLHttpRequest,f=$.Deferred();d.open("get",a);d.onload=function(){var a=d.responseText;q($(a).find("#dlg-systems"));f.resolve(a)};d.send();return f}return $.ajax({type:"GET",async:!0,dataType:"html",url:a,success:function(a){q($(a).find("#dlg-systems"))}})},saveSystems:function(){c.init.typeOpenSave=1;c.init.endLisLoaded=
0;w();k="Save system form";v("test",k);var a=!1==b.guiinit.cache?"?"+(new Date).getTime():"?",a=b.guiinit.rootpath+"/ChartUI/gui/systems/systemssave.htm"+a+" #dlg-systems";if(b.navigator.XMLHttpRequest()){var d=new XMLHttpRequest,f=$.Deferred();d.open("get",a);d.onload=function(){var a=d.responseText;t($(a).find("#dlg-systems"));f.resolve(a)};d.send();return f}return $.ajax({type:"GET",async:!0,dataType:"html",url:a,success:function(a){t($(a).find("#dlg-systems"))}})},loginInSystems:function(a,d){c.init.mstrUserToken=
d;b.chart.ListTemplates(d,"template");b.chart.ListTemplates(d,"analysis")},systemsList:function(a,b,f){switch(c.init.typeOpenSave){case 0:a=[];a.push('<li  class="li-system"><a href="javascript:void(0)"  class="opensystem" tid="%systemid%"  ttype="%typesystem%"  title="%description%" ><span>%caption%</span></a><button class="favorite system-get-small open-system" tid="%systemid%"  ttype="%typesystem%"  type="button"></button><button class="favorite delete-icon-small delete-system" tid="%systemid%"  ttype="%typesystem%"  type="button"></button></li>');
var e=/%systemid%/g,k=/%caption%/g,m=/%description%/g,n=/%typesystem%/g,g=null,l="";switch(f){case "template":g=$("#systemgroup-group1 .systems-list");$(g).empty();l="template";break;case "analysis":g=$("#systemgroup-group2 .systems-list"),$(g).empty(),l="analysis"}if(null!=g)for(f=0;f<b.length;f++){var h=b[f],h=a[0].replace(e,h.TemplateIID).replace(k,h.Name).replace(m,h.Description).replace(n,l);$(g).append(h)}c.init.endLisLoaded+=1;2==c.init.endLisLoaded&&y();break;case 1:a=[];a.push('<li  class="li-system" ><span>%caption%</span><button class="favorite system-set-small save-system-%typesystem%" ttype="%typesystem%"  tid="%systemid%" type="button"></button><button class="favorite delete-icon-small delete-system" ttype="%typesystem%"   tid="%systemid%" type="button"></button></li>');
e=/%systemid%/g;k=/%caption%/g;m=/%description%/g;n=/%typesystem%/g;g=null;l="";switch(f){case "template":g=$("#systemgroup-group1 .systems-list");$(g).empty();l="template";break;case "analysis":g=$("#systemgroup-group2 .systems-list"),$(g).empty(),l="analysis"}if(null!=g)for(f=0;f<b.length;f++)h=b[f],h=a[0].replace(e,h.TemplateIID).replace(k,h.Name).replace(m,h.Description).replace(n,l),$(g).append(h);c.init.endLisLoaded+=1;2==c.init.endLisLoaded&&z()}p()},loadedSystem:function(a,b){p()},savedSystem:function(a,
b){p();e();u()},deletedSystem:function(a,b,c){p();e();u()},errorSystem:function(a,b,c){}};c.init={mstrUserToken:"",typeOpenSave:0,endLisLoaded:0};return c};
