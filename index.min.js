async function getPostSiteMaps(){let e=[];for(let t=1;t<10;t++)await axios.get(`https://cms.evest.com/wp-json/wp/v2/posts?page=${t}&per_page=100`).then(t=>{for(let a in t.data)t.data[a].link.includes("commodities")||e.push(t.data[a].link.substring(22))}).catch(e=>{});for(let t=1;t<10;t++)await axios.get(`https://cms.evest.com/ar/wp-json/wp/v2/posts?page=${t}&per_page=100`).then(t=>{for(let a in t.data)e.push(t.data[a].link.substring(22))}).catch(e=>{});let t=e.map(e=>`\n<url><loc>https://www.evest.com/${e}</loc></url>`),a=`<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9" \nxmlns:image="http://www.sitemaps.org/schemas/sitemap-image/1.1" \nxmlns:video="http://www.sitemaps.org/schemas/sitemap-video/1.1">${t.join("")}\n</urlset>`;fs.writeFile("./public/post-sitemap.xml",a,function(e){var t=new Date,a=t.getFullYear(),s=t.getMonth()+1,r=t.getDate(),i=t.getHours(),o=t.getMinutes(),n=t.getSeconds(),p=a+"-"+s+"-"+r+" "+i+":"+o+":"+n;if(e)throw e;fs.writeFile("./public/logForPost.txt",`${p} - Post Sitemap -File is created successfully`,function(e){if(e)throw e;console.log(`${p} - Log File is created successfully`)})})}async function getPagesSiteMaps(){let e=[];for(let t=1;t<10;t++)await axios.get(`https://cms.evest.com/wp-json/wp/v2/pages?page=${t}&per_page=100`).then(t=>{for(let a in t.data)e.push(t.data[a].link.substring(22))}).catch(e=>{});for(let t=1;t<10;t++)await axios.get(`https://cms.evest.com/ar/wp-json/wp/v2/pages?page=${t}&per_page=100`).then(t=>{for(let a in t.data)e.push(t.data[a].link.substring(22))}).catch(e=>{});let t=e.map(e=>`\n<url><loc>https://www.evest.com/${e}</loc></url>`),a=`<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9" \nxmlns:image="http://www.sitemaps.org/schemas/sitemap-image/1.1" \nxmlns:video="http://www.sitemaps.org/schemas/sitemap-video/1.1">${t.join("")}\n</urlset>`;fs.writeFile("./public/page-sitemap.xml",a,function(e){if(e)throw e;console.log("File is created successfully.")})}async function getCategoriesSiteMaps(){let e=[];for(let t=1;t<10;t++)await axios.get(`https://cms.evest.com/wp-json/wp/v2/categories?page=${t}&per_page=100`).then(t=>{for(let a in t.data)e.push(t.data[a].link.substring(22))}).catch(e=>{});for(let t=1;t<10;t++)await axios.get(`https://cms.evest.com/ar/wp-json/wp/v2/categories?page=${t}&per_page=100`).then(t=>{for(let a in t.data)e.push(t.data[a].link.substring(22))}).catch(e=>{});let t=e.map(e=>`\n<url><loc>https://www.evest.com/${e}</loc></url>`),a=`<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9" \nxmlns:image="http://www.sitemaps.org/schemas/sitemap-image/1.1" \nxmlns:video="http://www.sitemaps.org/schemas/sitemap-video/1.1">${t.join("")}\n</urlset>`;fs.writeFile("./public/category-sitemap.xml",a,function(e){if(e)throw e;console.log("File is created successfully.")})}async function getTagsSiteMaps(){let e=[];for(let t=1;t<10;t++)await axios.get(`https://cms.evest.com/wp-json/wp/v2/tags?page=${t}&per_page=100`).then(t=>{for(let a in t.data)e.push(t.data[a].link.substring(22))}).catch(e=>{});for(let t=1;t<10;t++)await axios.get(`https://cms.evest.com/ar/wp-json/wp/v2/tags?page=${t}&per_page=100`).then(t=>{for(let a in t.data)e.push(t.data[a].link.substring(22))}).catch(e=>{});let t=e.map(e=>`\n<url><loc>https://www.evest.com/${e}</loc></url>`),a=`<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9" \nxmlns:image="http://www.sitemaps.org/schemas/sitemap-image/1.1" \nxmlns:video="http://www.sitemaps.org/schemas/sitemap-video/1.1">${t.join("")}\n</urlset>`;fs.writeFile("./public/post_tag-sitemap.xml",a,function(e){if(e)throw e;console.log("File is created successfully.")})}async function getCommoditiesSiteMaps(){let e=[];for(let t=1;t<10;t++)await axios.get(`https://cms.evest.com/wp-json/wp/v2/commodities?page=${t}&per_page=100`).then(t=>{for(let a in t.data)e.push(t.data[a].link.substring(22))}).catch(e=>{});for(let t=1;t<10;t++)await axios.get(`https://cms.evest.com/ar/wp-json/wp/v2/commodities?page=${t}&per_page=100`).then(t=>{for(let a in t.data)e.push(t.data[a].link.substring(22))}).catch(e=>{});let t=e.map(e=>`\n<url><loc>https://www.evest.com/${e}</loc></url>`),a=`<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9" \nxmlns:image="http://www.sitemaps.org/schemas/sitemap-image/1.1" \nxmlns:video="http://www.sitemaps.org/schemas/sitemap-video/1.1">${t.join("")}\n</urlset>`;fs.writeFile("./public/commodities-sitemap.xml",a,function(e){if(e)throw e;console.log("File is created successfully.")})}const express=require("express"),expressLayout=require("express-ejs-layouts");require("dotenv").config();const bodyParser=require("body-parser"),nodemailer=require("nodemailer"),upload=require("express-fileupload"),sgMail=require("@sendgrid/mail");sgMail.setApiKey(process.env.SENDGRID_API_KEY);var butter=require("buttercms")(process.env.BUTTER_KEY);const fetch=require("node-fetch"),cors=require("cors"),{ToadScheduler:ToadScheduler,SimpleIntervalJob:SimpleIntervalJob,Task:Task}=require("toad-scheduler"),app=express();app.use(require("express-status-monitor")());const fs=require("fs"),PORT=process.env.PORT||8080;var xFrameOptions=require("x-frame-options");app.use(xFrameOptions()),app.use(cors());const evestRoutes=require("./routes/evest"),tradingplatform=require("./routes/tradingPlatforms"),startTrading=require("./routes/startTrading"),arabicRouting=require("./routes/arabicRouting"),spainshRouting=require("./routes/spainshRouting"),marketsRouting=require("./routes/marketsRouting"),productsRouting=require("./routes/productsRouting"),mysql=require("mysql");app.use(bodyParser.urlencoded({extended:!1})),app.use(bodyParser.json()),app.set("views","./views"),app.set("view engine","ejs"),app.use(expressLayout),app.use(upload()),app.use(express.static("public")),app.use("/css",express.static(__dirname+"/public/css")),app.use("/images",express.static(__dirname+"/public/images")),app.use("/fonts",express.static(__dirname+"/public/fonts")),app.use("/js",express.static(__dirname+"/public/js")),app.use("/node_modules",express.static(__dirname+"/node_modules")),app.use("/trade-room",express.static(__dirname+"/public/trade-room")),app.use("/legal",express.static(__dirname+"/public/legal")),app.use("/publicFiles",express.static(__dirname+"/public/publicFiles"));var connection=mysql.createConnection({host:process.env.DB_HOST,user:"mena-evest_data",password:process.env.DB_PASSWORD,database:"panda_db"});app.get("/coins/:id",(e,t)=>{const a=Date.parse("2022-04-01T21:00:00")/1e3,s=Date.parse("2022-04-30T21:00:00")/1e3,r=["BTCUSD","ETHUSD","LTCUSD","ETCUSD","DSHUSD","XRPUSD","YCCUSD","SHBUSD","ADAUSD","SOLUSD","XLMUSD","DOTUSD","DOGUST","3M","ACTBLIZARD","ANGLO","B.PETROL","BARCLAYS","BATS","DOMINOS","MARKS","VODAFONE","BTGROUP","INVESTEC","HSBC","Lloyds","NatWest","AS-ROMA","ADS","ALLI","BASF","ANZ-ASX","BAYER","BMW","Beiersdorf","CONTINENTAL","CTX-ASX","DBFRA","MERCEDES","DPW","EOAN","DTELE","FRESENIUS","HEN","HM","HONDA","LAZIO","LUKOIL","MITSUBISHI","METRO","MTNGroup","NISSAN","REPSOL","SAP","ORG-ASX","Rosneft","RIO-ASX","SAND","SIE","Sberbank","TELFON","TELIA","TOSHIBA","TOTAL","VINCI","VOLV","VOWGEN","Alibaba-HK","FDJ","WOW-ASX","XIAOMI","GAZPROM","Lufthansa","SiemensH","HERO","LPKFLASER","Aramco","BERKSHIRE","AMAZON","HASBRO","AIG","ALCOA","APPLE","AMEX","ARCELOR","BAIDU","ArmourInc","AURORA","ATT","BOEING","Alibaba","B.A.Tobaco","BOA","CAT","CHEVRON","CITI","CISCO","DISNEY","COMCAST","COKE","CRONOS","Dropbox","EBAY","ESTEE","EXXM","ElectArts","FACEBOOK","FEDEX","FERRARI","FIREEYE","FOX","Ford","GAP","GE","GM","GOLDSACHS","GOOGLE","GOPRO","HPACK","HARLEY","INTEL","IBM","HILTON","JD","JNJ","JPM","KraftHeinz","LOCKHEED","LYFT","LibertyGlob","MA","MACYS","MANU","MCDON","MORGAN_STA","MSFT","NIKE","NOKIA","NSDQ_COMP","NTDOY","NVIDIA","Netflix","Oracle","PFIZER","PG","PepsiCo","QUALCOMM","RALPH","SONY","SBUX","SNAP","TEVA","Spotify","TESLA","TLRY-NSDQ","TOYOTA","TRIPADVISOR","UBER","RAYTHEON","UBS","VERIZON","TWITTER","Visa","VMWARE","WMART","WellFargo","WEED","Yandex","YELP","Delta","Vipshop","BIOGEN","BIONTECH","GILD","MODERNA","VIRBIOTECH","Vertex","ARCUS","CLOROX","COST","INOVIO","NANOVIR","ZOOM","AMGEN","SOUTHWEST","SPIRIT","CopaHold","AirTransp","SkyWest","HawaiianHL","Ryanair","Allegiant","WMusic","TakeTwo","Lululemon","DriveShack","ShakeShack","AMCentr","FreshPet","SRNETherap","Chewy","Carnival","GNUS","CarMax","HomeDepot","BlackBerry","DraftKings","CRIPSR","Splunk","DISCA","Zscaler","VirginG","Zuora","StitchFix","BeyondMeat","Pinterest","Twilio","Roku","Salesforce","SQUARE","ZYNGA","DicksSp","FootLocker","ETSY","DataDog","Workday","Fastly","Wayfair","AutoDesk","Redfin","Okta","Nutanix","ULTA","DollarTree","DocuSign","Teladoc","IntuitiveS","WIX","LEMONADE","NIKOLA","GOHEALTH","NCINO","UNG","UnileverNY","BlackRock","Shopify","HARMONY","HONEYWELL","NIO","RIOTINTO","BHPGROUP","Peloton","SNOWFLAKE","PROSUS","BOOHOO","EVOTEC","ADOBE","PAYPAL","PM","AIRBNB","INTESA","UNICREDIT","MEDIASET","SAIPEM","JUVENTUS","Stellantis","AMD","WASTE","JAGUARH","MICRONT","ENPHASE","FORTINET","NOVAVAX","ELECTRAMV","GAMESTOP","A.AIRLINES","COINBASE","VERANO","ROLLS-ROYCE","BAKER","TAIWANSMC","SPDR500","OCUGEN","ZIVOBIO","TORCHLIGHT","FIRSTSOLAR","SolarEdge","FISKER","EHANG","NEXTERA","BROOKFIELD","PlugPower","Opendoor","LucidGroup","AvePoint","ROBINHOOD","AGNCInvest","CANOO","BOOTBARN","ELEMENTS","INNOVATIVE","KORNIT","VERITIV","DOXIMITY","ALTRIA","UNICORP","LVMH","COUPANG","COHENCOMP","CHINAREC","THENINE","LithiumAmericas","Livent","RiotBlock","Marathon","Lightning","DidiGlobal","Bilibili","Canann","NewChinaIns","Fortress","MRK","CHEMOCEN","EQONEX","RIVIAN","YALLAGROUP","JUNIPER","MOODYS","DAVITA","VERISIGN","SIRIUS","CHARTER","STONECO","Dior","Hermes","Kering","Airbus","Unity ","NUHOLDS","OXYPETRO","KROGER","CHIPOTILE","ANGHAMI","HPACKEnt"];connection.query(`select * from panda_db.trading_trades where login=${e.params.id} and volume>0 and open_time>=${a} and open_time<=${s}`,function(e,a,s){if(e)throw e;var i=0;a.forEach(e=>{r.includes(e.symbol)||(i+=e.volume)});var o={coins:5*i};t.send(o)})});var count=0;const axios=require("axios");getPostSiteMaps(),getPagesSiteMaps(),getCategoriesSiteMaps(),getTagsSiteMaps(),getCommoditiesSiteMaps();const scheduler=new ToadScheduler,task=new Task("simple task",getPostSiteMaps),job=new SimpleIntervalJob({hours:2},task);scheduler.addSimpleIntervalJob(job);const SitemapGenerator=require("sitemap-generator"),generator=SitemapGenerator("http://www.evest.com",{maxDepth:0,filepath:"./public/sitemap.xml",maxEntriesPerFile:5e4,stripQuerystring:!0});generator.on("done",()=>{}),generator.start(),app.get("/post-sitemap.xml",async(e,t)=>{let a=[];for(let e=1;e<10;e++)await axios.get(`https://cms.evest.com/wp-json/wp/v2/posts?page=${e}&per_page=100`).then(e=>{for(let t in e.data)e.data[t].link.includes("commodities")||a.push(e.data[t].link.substring(22))}).catch(e=>{});for(let e=1;e<10;e++)await axios.get(`https://cms.evest.com/ar/wp-json/wp/v2/posts?page=${e}&per_page=100`).then(e=>{for(let t in e.data)a.push(e.data[t].link.substring(22))}).catch(e=>{});let s=a.map(e=>`\n<url><loc>https://www.evest.com/${e}</loc></url>`),r=`<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9" \nxmlns:image="http://www.sitemaps.org/schemas/sitemap-image/1.1" \nxmlns:video="http://www.sitemaps.org/schemas/sitemap-video/1.1">${s.join("")}\n</urlset>`;fs.writeFile("./public/post-sitemap.xml",r,function(e){var a=0;if(e)throw e;console.log("File is created successfully. "+a++),t.sendFile(__dirname+"/public/post-sitemap.xml")})});const myapi=require("./pricesAPI"),{start:start}=require("repl");app.get("/stocks",(e,t)=>{t.send(myapi.getStocks)}),app.get("/currency",(e,t)=>{t.send(myapi.getCurrency)}),app.get("/commodities",(e,t)=>{t.send(myapi.getCommodities)}),app.get("/indices",(e,t)=>{t.send(myapi.getIndices)}),app.get("/crypto",(e,t)=>{t.send(myapi.getCrypto)}),app.get("/",(e,t)=>{t.get("X-Frame-Options"),butter.page.retrieve("*","homepage-en").then(function(e){var a=e.data.data;t.render("index",{page:a})})}),app.get("/ceo",(e,t)=>{butter.page.retrieve("*","meet-ceo").then(function(e){var a=e.data.data;t.render("ceo",{page:a})}).catch(function(e){console.log(e)})}),app.get("/trade-room",(e,t)=>{t.sendFile(__dirname+"/public/trade-room/static.html")}),app.get("/mobile",(e,t)=>{t.sendFile(__dirname+"/public/mobile/index.html")}),app.get("/trading-academy/:loginStatus",(e,t)=>{butter.page.retrieve("*","trading-academy").then(function(a){var s=a.data.data;"true"==e.params.loginStatus?t.render("tradingAcademyLoggedin",{page:s}):t.render("tradingAcademy",{page:s})}).catch(function(e){console.log(e)})}),app.get("/trading-academy",(e,t)=>{butter.page.retrieve("*","trading-academy").then(function(e){var a=e.data.data;t.render("tradingAcademy",{page:a})}).catch(function(e){console.log(e)})}),app.get("/faq",(e,t)=>{butter.page.retrieve("*","faq").then(function(e){var a=e.data.data;t.render("faq",{page:a})}).catch(function(e){console.log(e)})}),app.get("/oil-news",async(e,t)=>{const a="https://cms.evest.com/wp-json/wp/v2/posts?_embed&categories=42&per_page=6&page=1",s={method:"GET"};await fetch(a,s).then(e=>e.json()).then(e=>{var a={fields:{seo:{meta_description:"Oil news, stay up to date with the latest updates with Evest on the latest Oil news and updates including the economy, the stock",meta_keywords:"Oil News",page_title:"Oil News - Evest latest updates and news about oil trading"}}};const s=e.map(e=>{let t=e.date.split("T")[0];return`<div class="card">\n          <div> \n                <a href="${e.link}"> <img class="card-img-top" src="${e.featured_image_url}" alt="Card image cap"></a>\n<div class="card-body">\n<a href="${e.link}"><h5 class="card-title">${e.title.rendered}</h5></a>\n<div class="card-text description">${e.excerpt.rendered}</div>\n<a class="btn btn-filled readmore" href="${e.link}">Read more</a>\n</div></div>\n<div class="card-footer dateCreated">\n${t}\n</div>\n</div>`}).join("");t.render("Education/oil",{page:a,articles:s})})}),app.get("/oil-news/:slug",async(e,t)=>{const a=`https://cms.evest.com/wp-json/wp/v2/posts?_embed&slug=${e.params.slug}`,s={method:"GET"};await fetch(a,s).then(e=>e.json()).then(e=>{var a=e;const s=Object.keys(e[0].yoast_head_json.schema).map(function(t){return e[0].yoast_head_json.schema[t]}),r=s[1][5]?s[1][5].keywords.map(e=>`<a class="badge bg-secondary text-decoration-none link-light" href="/tag/${e}">${e}</a>`).join(" "):" ";var i={fields:{seo:{meta_description:`${a[0].yoast_head_json.og_description}`,meta_keyword:`${s[1][5].keywords}`,page_title:`${a[0].yoast_head_json.og_title}`}}};t.render("Education/article",{page:i,content:a[0].content.rendered,titleArticle:a[0].title.rendered,imgUrl:a[0].featured_image_url,date:a[0].date,url:a[0].link,tags:r,og_img:`${a[0].yoast_head_json.og_image.url}`})}).catch(e=>console.log(e))}),app.get("/gold-news",async(e,t)=>{const a="https://cms.evest.com/wp-json/wp/v2/posts?_embed&categories=41&per_page=6&page=1",s={method:"GET"};await fetch(a,s).then(e=>e.json()).then(e=>{var a={fields:{seo:{meta_description:"Gold trading news, stay up to date with the latest updates with Evest on the latest gold news and economy, stock, share market online",meta_keywords:"Gold News",page_title:"Gold Trading News - Evest latest news and updates on gold trading"}}};const s=e.map(e=>{let t=e.date.split("T")[0];return`<div class="card">\n          <div> \n                 <a href="${e.link}"><img class="card-img-top" src="${e.featured_image_url}" alt="Card image cap"></a>\n<div class="card-body">\n<a hef="${e.link}"><h5 class="card-title">${e.title.rendered}</h5></a>\n<div class="card-text description">${e.excerpt.rendered}</div>\n<a class="btn btn-filled readmore" href="${e.link}">Read more</a>\n</div></div>\n<div class="card-footer dateCreated">\n${t}\n</div>\n</div>`}).join("");t.render("Education/gold",{page:a,articles:s})})}),app.get("/gold-news/:slug",async(e,t)=>{const a=`https://cms.evest.com/wp-json/wp/v2/posts?_embed&slug=${e.params.slug}`,s={method:"GET"};await fetch(a,s).then(e=>e.json()).then(e=>{var a=e;const s=Object.keys(e[0].yoast_head_json.schema).map(function(t){return e[0].yoast_head_json.schema[t]}),r=s[1][5]?s[1][5].keywords.map(e=>`<a class="badge bg-secondary text-decoration-none link-light" href="/tag/${e}">${e}</a>`).join(" "):" ";var i={fields:{seo:{meta_description:`${a[0].yoast_head_json.og_description}`,meta_keyword:`${s[1][5].keywords}`,page_title:`${a[0].yoast_head_json.og_title}`}}};t.render("Education/article",{page:i,content:a[0].content.rendered,titleArticle:a[0].title.rendered,imgUrl:a[0].featured_image_url,date:a[0].date,url:a[0].link,tags:r,og_img:`${a[0].yoast_head_json.og_image.url}`})}).catch(e=>console.log(e))}),app.get("/market-news",async(e,t)=>{const a="https://cms.evest.com/wp-json/wp/v2/posts?_embed&categories=46&per_page=6&page=1",s={method:"GET"};await fetch(a,s).then(e=>e.json()).then(e=>{var a={fields:{seo:{meta_description:"Stock market news, stay up to date with the latest updates with Evest on the economy stock market and share market, Ùstock news",meta_keywords:"Stock Market News",page_title:"Stock Market News - Evest latest financial news and updates"}}};const s=e.map(e=>{let t=e.date.split("T")[0];return`<div class="card">\n          <div> \n              <a href="${e.link}"><img class="card-img-top" src="${e.featured_image_url}" alt="Card image cap"></a>\n<div class="card-body">\n<a href="${e.link}"><h5 class="card-title">${e.title.rendered}</h5></a>\n<div class="card-text description">${e.excerpt.rendered}</div>\n<a class="btn btn-filled readmore" href="${e.link}">Read more</a>\n</div></div>\n<div class="card-footer dateCreated">\n${t}\n</div>\n</div>`}).join("");t.render("Education/market",{page:a,articles:s})})}),app.get("/market-news/:slug",async(e,t)=>{const a=`https://cms.evest.com/wp-json/wp/v2/posts?_embed&slug=${e.params.slug}`,s={method:"GET"};await fetch(a,s).then(e=>e.json()).then(e=>{var a=e;const s=Object.keys(e[0].yoast_head_json.schema).map(function(t){return e[0].yoast_head_json.schema[t]}),r=s[1][5]?s[1][5].keywords.map(e=>`<a class="badge bg-secondary text-decoration-none link-light" href="/tag/${e}">${e}</a>`).join(" "):" ";var i={fields:{seo:{meta_description:`${a[0].yoast_head_json.og_description}`,meta_keyword:`${s[1][5].keywords}`,page_title:`${a[0].yoast_head_json.og_title}`}}};t.render("Education/article",{page:i,content:a[0].content.rendered,titleArticle:a[0].title.rendered,imgUrl:a[0].featured_image_url,date:a[0].date,url:a[0].link,tags:r,og_img:`${a[0].yoast_head_json.og_image.url}`})}).catch(e=>console.log(e))}),app.get("/trading-news",async(e,t)=>{const a="https://cms.evest.com/wp-json/wp/v2/posts?_embed&per_page=6&page=1",s={method:"GET"};await fetch(a,s).then(e=>e.json()).then(e=>{var a={fields:{seo:{meta_description:"Trading News, Get the latest Trading News of the market now from anywhere in the world directly to you! Top and latest news about stock market",meta_keywords:"Trading News",page_title:"Trading News - Evest Top and latest news about stock market"}}};const s=e.map(e=>{let t=e.date.split("T")[0];return`<div class="card">\n          <div> \n                 <a href="${e.link}"><img class="card-img-top" src="${e.featured_image_url}" alt="Card image cap"></a>\n<div class="card-body">\n<a href="${e.link}"><h5 class="card-title">${e.title.rendered}</h5></a>\n<div class="card-text description">${e.excerpt.rendered}</div>\n<a class="btn btn-filled readmore" href="${e.link}">Read more</a>\n</div></div>\n<div class="card-footer dateCreated">\n${t}\n</div>\n</div>`}).join("");t.render("Education/tradingNews",{page:a,articles:s})})}),app.get("/trading-news/:slug",async(e,t)=>{const a=`https://cms.evest.com/wp-json/wp/v2/posts?_embed&slug=${e.params.slug}`,s={method:"GET"};await fetch(a,s).then(e=>e.json()).then(e=>{var a=e;const s=Object.keys(e[0].yoast_head_json.schema).map(function(t){return e[0].yoast_head_json.schema[t]}),r=s[1][5]?s[1][5].keywords.map(e=>`<a class="badge bg-secondary text-decoration-none link-light" href="/tag/${e}">${e}</a>`).join(" "):" ";var i={fields:{seo:{meta_description:`${a[0].yoast_head_json.og_description}`,meta_keyword:`${s[1][5].keywords}`,page_title:`${a[0].yoast_head_json.og_title}`}}};t.render("Education/article",{page:i,content:a[0].content.rendered,titleArticle:a[0].title.rendered,imgUrl:a[0].featured_image_url,date:a[0].date,url:a[0].link,tags:r,og_img:`${a[0].yoast_head_json.og_image.url}`})}).catch(e=>console.log(e))}),app.post("/send",(e,t)=>{const a={to:"support@evest.com",from:"no-replay@customers-evest.com",subject:`${e.body.email} Send You New Message from the support website page`,html:`  <h1>You Got New Message</h1>\n    <p>EMAIL: ${e.body.email}.<br><br>\n    FULL NAME: ${e.body.fullName}.<br><br>\n    SUBJECT: ${e.body.subject}.<br><br>\n    MESSAGE: ${e.body.message}.<br></p>`,replyTo:`${e.body.email}`};sgMail.send(a).then(()=>{},e=>{console.error(e),e.response&&console.error(e.response.body)}),butter.page.retrieve("*","contact-us").then(function(e){var a=e.data.data;t.render("Evest/contactUs",{page:a,message:"Message Sent Thank You,We will contact you soon ."})}).catch(function(e){console.log(e)})}),app.post("/ceo",(e,t)=>{const a={to:"ceo@evest.com",from:'"CEO Page"<no-replay@customers-evest.com>',subject:` ${e.body.email} Send You New Message from the CEO website page`,html:`  <h1>You Got New Message</h1>\n    <p>EMAIL: ${e.body.email}.<br><br>\n    FULL NAME: ${e.body.fullName}.<br><br>\n    SUBJECT: ${e.body.subject}.<br><br>\n    MESSAGE: ${e.body.message}.<br></p>`,replyTo:`${e.body.email}`};sgMail.send(a).then(()=>{},e=>{console.error(e),e.response&&console.error(e.response.body)}),t.redirect("/ceo")});const getTag=require("./tagsApi");app.get("/tag/:tag",async(e,t)=>{const a=getTag.englishTags.find(t=>t.Name===e.params.tag).tag_id;console.log(+e.params.tag+" "+a),void 0===a&&t.redirect("/");const s=`https://cms.evest.com/wp-json/wp/v2/posts?_embed&tags=${a}&per_page=6&page=1`,r={method:"GET"};fetch(s,r).then(e=>e.json()).then(s=>{var r={fields:{seo:{meta_description:`Archive of ${e.params.tag}`,meta_keyword:`${e.params.tag}`,page_title:`Evest- ${e.params.tag} Archive`}}};const i=s.map(e=>{let t=e.date.split("T")[0];return`<div class="card">\n                    <div> \n                           <a href='${e.link}'>  <img class="card-img-top" src="${e.featured_image_url}" alt="Card image cap" title="${e.title.rendered}"> </a>\n        <div class="card-body">\n        <a href='${e.link}' ><h5 class="card-title">${e.title.rendered}</h5></a>\n        <div class="card-text description">${e.excerpt.rendered}</div>\n        <a class="btn btn-filled readmore" href='${e.link}'>read more</a>\n        </div></div>\n        <div class="card-footer dateCreated">\n        ${t}\n        </div>\n        </div>`}).join("");t.render("Education/tags",{page:r,articles:i,pageTitle:`Evest- ${e.params.tag} Archive`,tagId:a})}).catch(e=>{console.log("this is error from tag in index page"),t.redirect("/")})}),app.use("/evest",evestRoutes),app.use("/",tradingplatform),app.use("/start-trading",startTrading),app.use("/markets",marketsRouting),app.use("/trading-products",productsRouting),app.use("/ar",arabicRouting),app.use("/es",spainshRouting),app.get("/upload",(e,t)=>{const a=()=>{t.setHeader("www-authenticate","Basic"),t.sendStatus(401)},s=e.headers.authorization;if(!s)return a();const[r,i]=Buffer.from(s.replace("Basic ",""),"base64").toString().split(":");if("admin"!==r||"q53hh=-Y5Sat?vUj"!==i)return a();var o={fields:{seo:{meta_description:"",meta_keywords:"",page_title:"upload file to get public link"}}};t.render("upload",{page:o,link:""})}),app.post("/upload",(e,t)=>{if(e.files){var a=e.files.file,s=a.name;a.mv("./public/publicFiles/"+s,function(e){if(e)t.send(e);else{var a={fields:{seo:{meta_description:"",meta_keywords:"",page_title:"upload file to get public link"}}};t.render("upload",{page:a,link:`https://evest.com/publicFiles/${s}`})}})}}),app.get("/log",(e,t)=>{const a=()=>{t.setHeader("www-authenticate","Basic"),t.sendStatus(401)},s=e.headers.authorization;if(!s)return a();const[r,i]=Buffer.from(s.replace("Basic ",""),"base64").toString().split(":");if("admin"!==r||"q53hh=-Y5Sat?vUj"!==i)return a();t.sendFile(__dirname+"/public/logForPost.txt")}),app.get("*",(e,t)=>{t.redirect("/")}),app.listen(PORT,()=>{console.log(`server start on PORT:${PORT}`)});